Fri Mar 10 05:02:01 UTC 2023
##### Started Executor #####
##### Finished Executor #####
============================================
Fri Mar 10 05:03:01 UTC 2023
##### Started Executor #####
##### Finished Executor #####
============================================
Fri Mar 10 05:04:01 UTC 2023
##### Started Executor #####
##### Finished Executor #####
============================================
Fri Mar 10 05:05:01 UTC 2023
##### Started Executor #####
##### Finished Executor #####
============================================
Fri Mar 10 05:06:01 UTC 2023
##### Started Executor #####
##### Finished Executor #####
============================================
Fri Mar 10 05:07:01 UTC 2023
##### Started Executor #####
##### Finished Executor #####
============================================
Fri Mar 10 05:08:01 UTC 2023
##### Started Executor #####
##### Finished Executor #####
============================================
Fri Mar 10 05:09:01 UTC 2023
##### Started Executor #####
##### Finished Executor #####
============================================
Fri Mar 10 05:10:01 UTC 2023
##### Started Executor #####
##### Finished Executor #####
============================================
Fri Mar 10 05:11:01 UTC 2023
##### Started Executor #####
##### Finished Executor #####
============================================
Fri Mar 10 05:12:01 UTC 2023
##### Started Executor #####
##### Finished Executor #####
============================================
Fri Mar 10 05:13:01 UTC 2023
##### Started Executor #####
##### Finished Executor #####
============================================
Fri Mar 10 05:14:01 UTC 2023
##### Started Executor #####
##### Finished Executor #####
============================================
Fri Mar 10 05:15:01 UTC 2023
##### Started Executor #####
##### Finished Executor #####
============================================
Fri Mar 10 05:16:01 UTC 2023
##### Started Executor #####
##### Finished Executor #####
============================================
Fri Mar 10 05:17:01 UTC 2023
##### Started Executor #####
##### Finished Executor #####
============================================
Fri Mar 10 05:18:01 UTC 2023
##### Started Executor #####
##### Finished Executor #####
============================================
Fri Mar 10 05:19:01 UTC 2023
##### Started Executor #####
##### Finished Executor #####
============================================
Fri Mar 10 05:20:01 UTC 2023
##### Started Executor #####
/mnt/c/Users/Miles/Documents/GitHub/futurense-dataeng-bootcamp/Assignments/PySpark/PySpark-sql/bankmarket.sh: 4: spark-submit: not found
##### Finished Executor #####
============================================
Fri Mar 10 05:21:01 UTC 2023
##### Started Executor #####
/mnt/c/Users/Miles/Documents/GitHub/futurense-dataeng-bootcamp/Assignments/PySpark/PySpark-sql/bankmarket.sh: 6: spark-submit: not found
##### Finished Executor #####
============================================
Fri Mar 10 05:22:01 UTC 2023
##### Started Executor #####
/mnt/c/Users/Miles/Documents/GitHub/futurense-dataeng-bootcamp/Assignments/PySpark/PySpark-sql/bankmarket.sh: 6: spark-submit: not found
##### Finished Executor #####
============================================
Fri Mar 10 05:23:01 UTC 2023
##### Started Executor #####
23/03/10 10:53:03 WARN Utils: Your hostname, MILES-BL-4819-LAP resolves to a loopback address: 127.0.1.1; using 172.27.188.152 instead (on interface eth0)
23/03/10 10:53:03 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
:: loading settings :: url = jar:file:/opt/spark/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml
Ivy Default Cache set to: /home/shashi/.ivy2/cache
The jars for the packages stored in: /home/shashi/.ivy2/jars
org.apache.spark#spark-avro_2.12 added as a dependency
:: resolving dependencies :: org.apache.spark#spark-submit-parent-3053d1a7-e861-4449-8728-7e1a42ebadc4;1.0
	confs: [default]
	found org.apache.spark#spark-avro_2.12;3.3.2 in central
	found org.tukaani#xz;1.9 in central
	found org.spark-project.spark#unused;1.0.0 in central
:: resolution report :: resolve 265ms :: artifacts dl 10ms
	:: modules in use:
	org.apache.spark#spark-avro_2.12;3.3.2 from central in [default]
	org.spark-project.spark#unused;1.0.0 from central in [default]
	org.tukaani#xz;1.9 from central in [default]
	---------------------------------------------------------------------
	|                  |            modules            ||   artifacts   |
	|       conf       | number| search|dwnlded|evicted|| number|dwnlded|
	---------------------------------------------------------------------
	|      default     |   3   |   0   |   0   |   0   ||   3   |   0   |
	---------------------------------------------------------------------
:: retrieving :: org.apache.spark#spark-submit-parent-3053d1a7-e861-4449-8728-7e1a42ebadc4
	confs: [default]
	0 artifacts copied, 3 already retrieved (0kB/9ms)
23/03/10 10:53:06 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
23/03/10 10:53:07 INFO SparkContext: Running Spark version 3.3.2
23/03/10 10:53:07 INFO ResourceUtils: ==============================================================
23/03/10 10:53:07 INFO ResourceUtils: No custom resources configured for spark.driver.
23/03/10 10:53:07 INFO ResourceUtils: ==============================================================
23/03/10 10:53:07 INFO SparkContext: Submitted application: Bank Market
23/03/10 10:53:07 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
23/03/10 10:53:07 INFO ResourceProfile: Limiting resource is cpu
23/03/10 10:53:07 INFO ResourceProfileManager: Added ResourceProfile id: 0
23/03/10 10:53:07 INFO SecurityManager: Changing view acls to: shashi
23/03/10 10:53:07 INFO SecurityManager: Changing modify acls to: shashi
23/03/10 10:53:07 INFO SecurityManager: Changing view acls groups to: 
23/03/10 10:53:07 INFO SecurityManager: Changing modify acls groups to: 
23/03/10 10:53:07 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(shashi); groups with view permissions: Set(); users  with modify permissions: Set(shashi); groups with modify permissions: Set()
23/03/10 10:53:07 INFO Utils: Successfully started service 'sparkDriver' on port 38193.
23/03/10 10:53:07 INFO SparkEnv: Registering MapOutputTracker
23/03/10 10:53:07 INFO SparkEnv: Registering BlockManagerMaster
23/03/10 10:53:07 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
23/03/10 10:53:07 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
23/03/10 10:53:07 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
23/03/10 10:53:07 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-1bc12be4-29a9-46a6-9357-440148654d98
23/03/10 10:53:07 INFO MemoryStore: MemoryStore started with capacity 366.3 MiB
23/03/10 10:53:07 INFO SparkEnv: Registering OutputCommitCoordinator
23/03/10 10:53:08 INFO Utils: Successfully started service 'SparkUI' on port 4040.
23/03/10 10:53:08 INFO SparkContext: Added JAR file:///home/shashi/.ivy2/jars/org.apache.spark_spark-avro_2.12-3.3.2.jar at spark://172.27.188.152:38193/jars/org.apache.spark_spark-avro_2.12-3.3.2.jar with timestamp 1678425787065
23/03/10 10:53:08 INFO SparkContext: Added JAR file:///home/shashi/.ivy2/jars/org.tukaani_xz-1.9.jar at spark://172.27.188.152:38193/jars/org.tukaani_xz-1.9.jar with timestamp 1678425787065
23/03/10 10:53:08 INFO SparkContext: Added JAR file:///home/shashi/.ivy2/jars/org.spark-project.spark_unused-1.0.0.jar at spark://172.27.188.152:38193/jars/org.spark-project.spark_unused-1.0.0.jar with timestamp 1678425787065
23/03/10 10:53:08 INFO SparkContext: Added file file:///home/shashi/.ivy2/jars/org.apache.spark_spark-avro_2.12-3.3.2.jar at spark://172.27.188.152:38193/files/org.apache.spark_spark-avro_2.12-3.3.2.jar with timestamp 1678425787065
23/03/10 10:53:08 INFO Utils: Copying /home/shashi/.ivy2/jars/org.apache.spark_spark-avro_2.12-3.3.2.jar to /tmp/spark-ea1e133f-7a2b-4e77-abd1-b5b79b0c5ec3/userFiles-1519431e-7cc3-448b-8e6e-fba64ccd660f/org.apache.spark_spark-avro_2.12-3.3.2.jar
23/03/10 10:53:08 INFO SparkContext: Added file file:///home/shashi/.ivy2/jars/org.tukaani_xz-1.9.jar at spark://172.27.188.152:38193/files/org.tukaani_xz-1.9.jar with timestamp 1678425787065
23/03/10 10:53:08 INFO Utils: Copying /home/shashi/.ivy2/jars/org.tukaani_xz-1.9.jar to /tmp/spark-ea1e133f-7a2b-4e77-abd1-b5b79b0c5ec3/userFiles-1519431e-7cc3-448b-8e6e-fba64ccd660f/org.tukaani_xz-1.9.jar
23/03/10 10:53:08 INFO SparkContext: Added file file:///home/shashi/.ivy2/jars/org.spark-project.spark_unused-1.0.0.jar at spark://172.27.188.152:38193/files/org.spark-project.spark_unused-1.0.0.jar with timestamp 1678425787065
23/03/10 10:53:08 INFO Utils: Copying /home/shashi/.ivy2/jars/org.spark-project.spark_unused-1.0.0.jar to /tmp/spark-ea1e133f-7a2b-4e77-abd1-b5b79b0c5ec3/userFiles-1519431e-7cc3-448b-8e6e-fba64ccd660f/org.spark-project.spark_unused-1.0.0.jar
23/03/10 10:53:08 INFO StandaloneAppClient$ClientEndpoint: Connecting to master spark://MILES-BL-4819-LAP.:7077...
23/03/10 10:53:08 INFO TransportClientFactory: Successfully created connection to MILES-BL-4819-LAP./127.0.1.1:7077 after 76 ms (0 ms spent in bootstraps)
23/03/10 10:53:08 INFO StandaloneSchedulerBackend: Connected to Spark cluster with app ID app-20230310105308-0001
23/03/10 10:53:08 INFO StandaloneAppClient$ClientEndpoint: Executor added: app-20230310105308-0001/0 on worker-20230309123128-172.27.188.152-45151 (172.27.188.152:45151) with 8 core(s)
23/03/10 10:53:08 INFO StandaloneSchedulerBackend: Granted executor ID app-20230310105308-0001/0 on hostPort 172.27.188.152:45151 with 8 core(s), 1024.0 MiB RAM
23/03/10 10:53:08 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 33623.
23/03/10 10:53:08 INFO NettyBlockTransferService: Server created on 172.27.188.152:33623
23/03/10 10:53:08 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
23/03/10 10:53:08 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, 172.27.188.152, 33623, None)
23/03/10 10:53:08 INFO BlockManagerMasterEndpoint: Registering block manager 172.27.188.152:33623 with 366.3 MiB RAM, BlockManagerId(driver, 172.27.188.152, 33623, None)
23/03/10 10:53:08 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, 172.27.188.152, 33623, None)
23/03/10 10:53:08 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, 172.27.188.152, 33623, None)
23/03/10 10:53:09 INFO SingleEventLogFileWriter: Logging events to file:/tmp/spark-events/app-20230310105308-0001.inprogress
23/03/10 10:53:09 INFO StandaloneAppClient$ClientEndpoint: Executor updated: app-20230310105308-0001/0 is now RUNNING
23/03/10 10:53:09 INFO StandaloneSchedulerBackend: SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio: 0.0
23/03/10 10:53:09 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
23/03/10 10:53:09 INFO SharedState: Warehouse path is 'file:/home/shashi/spark-warehouse'.
23/03/10 10:53:11 INFO InMemoryFileIndex: It took 128 ms to list leaf files for 1 paths.
23/03/10 10:53:11 INFO InMemoryFileIndex: It took 70 ms to list leaf files for 1 paths.
23/03/10 10:53:13 INFO CoarseGrainedSchedulerBackend$DriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (172.27.188.152:37342) with ID 0,  ResourceProfileId 0
23/03/10 10:53:14 INFO BlockManagerMasterEndpoint: Registering block manager 172.27.188.152:46077 with 366.3 MiB RAM, BlockManagerId(0, 172.27.188.152, 46077, None)
23/03/10 10:53:15 INFO FileSourceStrategy: Pushed Filters: 
23/03/10 10:53:15 INFO FileSourceStrategy: Post-Scan Filters: (length(trim(value#0, None)) > 0)
23/03/10 10:53:15 INFO FileSourceStrategy: Output Data Schema: struct<value: string>
23/03/10 10:53:16 INFO CodeGenerator: Code generated in 265.022029 ms
23/03/10 10:53:16 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 353.3 KiB, free 366.0 MiB)
23/03/10 10:53:16 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 34.8 KiB, free 365.9 MiB)
23/03/10 10:53:16 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 172.27.188.152:33623 (size: 34.8 KiB, free: 366.3 MiB)
23/03/10 10:53:16 INFO SparkContext: Created broadcast 0 from load at NativeMethodAccessorImpl.java:0
23/03/10 10:53:16 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 10:53:16 INFO SparkContext: Starting job: load at NativeMethodAccessorImpl.java:0
23/03/10 10:53:16 INFO DAGScheduler: Got job 0 (load at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 10:53:16 INFO DAGScheduler: Final stage: ResultStage 0 (load at NativeMethodAccessorImpl.java:0)
23/03/10 10:53:16 INFO DAGScheduler: Parents of final stage: List()
23/03/10 10:53:16 INFO DAGScheduler: Missing parents: List()
23/03/10 10:53:16 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at load at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 10:53:16 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 11.9 KiB, free 365.9 MiB)
23/03/10 10:53:16 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 5.9 KiB, free 365.9 MiB)
23/03/10 10:53:16 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on 172.27.188.152:33623 (size: 5.9 KiB, free: 366.3 MiB)
23/03/10 10:53:16 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1513
23/03/10 10:53:16 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at load at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 10:53:16 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
23/03/10 10:53:16 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 4985 bytes) taskResourceAssignments Map()
23/03/10 10:53:17 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on 172.27.188.152:46077 (size: 5.9 KiB, free: 366.3 MiB)
23/03/10 10:53:17 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 172.27.188.152:46077 (size: 34.8 KiB, free: 366.3 MiB)
23/03/10 10:53:18 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 1603 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 10:53:18 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool 
23/03/10 10:53:18 INFO DAGScheduler: ResultStage 0 (load at NativeMethodAccessorImpl.java:0) finished in 1.743 s
23/03/10 10:53:18 INFO DAGScheduler: Job 0 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 10:53:18 INFO TaskSchedulerImpl: Killing all running tasks in stage 0: Stage finished
23/03/10 10:53:18 INFO DAGScheduler: Job 0 finished: load at NativeMethodAccessorImpl.java:0, took 1.846218 s
23/03/10 10:53:18 INFO CodeGenerator: Code generated in 13.657946 ms
23/03/10 10:53:18 INFO FileSourceStrategy: Pushed Filters: 
23/03/10 10:53:18 INFO FileSourceStrategy: Post-Scan Filters: 
23/03/10 10:53:18 INFO FileSourceStrategy: Output Data Schema: struct<value: string>
23/03/10 10:53:18 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 353.3 KiB, free 365.6 MiB)
23/03/10 10:53:18 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 34.8 KiB, free 365.5 MiB)
23/03/10 10:53:18 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on 172.27.188.152:33623 (size: 34.8 KiB, free: 366.2 MiB)
23/03/10 10:53:18 INFO SparkContext: Created broadcast 2 from load at NativeMethodAccessorImpl.java:0
23/03/10 10:53:18 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 10:53:18 INFO FileSourceStrategy: Pushed Filters: IsNotNull(y),EqualTo(y,yes)
23/03/10 10:53:18 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(y#33),(y#33 = yes)
23/03/10 10:53:18 INFO FileSourceStrategy: Output Data Schema: struct<age: string, y: string>
23/03/10 10:53:18 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
23/03/10 10:53:19 INFO CodeGenerator: Code generated in 87.687741 ms
23/03/10 10:53:19 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 353.2 KiB, free 365.2 MiB)
23/03/10 10:53:19 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 34.7 KiB, free 365.1 MiB)
23/03/10 10:53:19 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on 172.27.188.152:33623 (size: 34.7 KiB, free: 366.2 MiB)
23/03/10 10:53:19 INFO SparkContext: Created broadcast 3 from parquet at NativeMethodAccessorImpl.java:0
23/03/10 10:53:19 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 10:53:19 INFO DAGScheduler: Registering RDD 13 (parquet at NativeMethodAccessorImpl.java:0) as input to shuffle 0
23/03/10 10:53:19 INFO DAGScheduler: Got map stage job 1 (parquet at NativeMethodAccessorImpl.java:0) with 2 output partitions
23/03/10 10:53:19 INFO DAGScheduler: Final stage: ShuffleMapStage 1 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 10:53:19 INFO DAGScheduler: Parents of final stage: List()
23/03/10 10:53:19 INFO DAGScheduler: Missing parents: List()
23/03/10 10:53:19 INFO DAGScheduler: Submitting ShuffleMapStage 1 (MapPartitionsRDD[13] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 10:53:19 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 38.5 KiB, free 365.1 MiB)
23/03/10 10:53:19 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 18.2 KiB, free 365.1 MiB)
23/03/10 10:53:19 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on 172.27.188.152:33623 (size: 18.2 KiB, free: 366.2 MiB)
23/03/10 10:53:19 INFO SparkContext: Created broadcast 4 from broadcast at DAGScheduler.scala:1513
23/03/10 10:53:19 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 1 (MapPartitionsRDD[13] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
23/03/10 10:53:19 INFO TaskSchedulerImpl: Adding task set 1.0 with 2 tasks resource profile 0
23/03/10 10:53:19 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 1) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 4974 bytes) taskResourceAssignments Map()
23/03/10 10:53:19 INFO TaskSetManager: Starting task 1.0 in stage 1.0 (TID 2) (172.27.188.152, executor 0, partition 1, PROCESS_LOCAL, 4974 bytes) taskResourceAssignments Map()
23/03/10 10:53:19 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on 172.27.188.152:46077 (size: 18.2 KiB, free: 366.2 MiB)
23/03/10 10:53:20 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on 172.27.188.152:46077 (size: 34.7 KiB, free: 366.2 MiB)
23/03/10 10:53:20 INFO TaskSetManager: Finished task 1.0 in stage 1.0 (TID 2) in 1274 ms on 172.27.188.152 (executor 0) (1/2)
23/03/10 10:53:20 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 1) in 1336 ms on 172.27.188.152 (executor 0) (2/2)
23/03/10 10:53:20 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool 
23/03/10 10:53:20 INFO DAGScheduler: ShuffleMapStage 1 (parquet at NativeMethodAccessorImpl.java:0) finished in 1.362 s
23/03/10 10:53:20 INFO DAGScheduler: looking for newly runnable stages
23/03/10 10:53:20 INFO DAGScheduler: running: Set()
23/03/10 10:53:20 INFO DAGScheduler: waiting: Set()
23/03/10 10:53:20 INFO DAGScheduler: failed: Set()
23/03/10 10:53:20 INFO ShufflePartitionsUtil: For shuffle(0), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
23/03/10 10:53:20 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
23/03/10 10:53:20 INFO CodeGenerator: Code generated in 21.804446 ms
23/03/10 10:53:20 INFO CodeGenerator: Code generated in 15.625988 ms
23/03/10 10:53:20 INFO SparkContext: Starting job: parquet at NativeMethodAccessorImpl.java:0
23/03/10 10:53:20 INFO DAGScheduler: Got job 2 (parquet at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 10:53:20 INFO DAGScheduler: Final stage: ResultStage 3 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 10:53:20 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 2)
23/03/10 10:53:20 INFO DAGScheduler: Missing parents: List()
23/03/10 10:53:20 INFO BlockManagerInfo: Removed broadcast_1_piece0 on 172.27.188.152:33623 in memory (size: 5.9 KiB, free: 366.2 MiB)
23/03/10 10:53:20 INFO DAGScheduler: Submitting ResultStage 3 (MapPartitionsRDD[18] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 10:53:20 INFO BlockManagerInfo: Removed broadcast_1_piece0 on 172.27.188.152:46077 in memory (size: 5.9 KiB, free: 366.2 MiB)
23/03/10 10:53:20 INFO BlockManagerInfo: Removed broadcast_4_piece0 on 172.27.188.152:33623 in memory (size: 18.2 KiB, free: 366.2 MiB)
23/03/10 10:53:20 INFO BlockManagerInfo: Removed broadcast_4_piece0 on 172.27.188.152:46077 in memory (size: 18.2 KiB, free: 366.2 MiB)
23/03/10 10:53:20 INFO MemoryStore: Block broadcast_5 stored as values in memory (estimated size 40.0 KiB, free 365.1 MiB)
23/03/10 10:53:20 INFO MemoryStore: Block broadcast_5_piece0 stored as bytes in memory (estimated size 19.2 KiB, free 365.1 MiB)
23/03/10 10:53:20 INFO BlockManagerInfo: Removed broadcast_0_piece0 on 172.27.188.152:46077 in memory (size: 34.8 KiB, free: 366.3 MiB)
23/03/10 10:53:20 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on 172.27.188.152:33623 (size: 19.2 KiB, free: 366.2 MiB)
23/03/10 10:53:20 INFO BlockManagerInfo: Removed broadcast_0_piece0 on 172.27.188.152:33623 in memory (size: 34.8 KiB, free: 366.2 MiB)
23/03/10 10:53:20 INFO SparkContext: Created broadcast 5 from broadcast at DAGScheduler.scala:1513
23/03/10 10:53:20 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 3 (MapPartitionsRDD[18] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 10:53:20 INFO TaskSchedulerImpl: Adding task set 3.0 with 1 tasks resource profile 0
23/03/10 10:53:20 INFO TaskSetManager: Starting task 0.0 in stage 3.0 (TID 3) (172.27.188.152, executor 0, partition 0, NODE_LOCAL, 4457 bytes) taskResourceAssignments Map()
23/03/10 10:53:21 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on 172.27.188.152:46077 (size: 19.2 KiB, free: 366.2 MiB)
23/03/10 10:53:21 INFO MapOutputTrackerMasterEndpoint: Asked to send map output locations for shuffle 0 to 172.27.188.152:37342
23/03/10 10:53:21 INFO TaskSetManager: Finished task 0.0 in stage 3.0 (TID 3) in 361 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 10:53:21 INFO TaskSchedulerImpl: Removed TaskSet 3.0, whose tasks have all completed, from pool 
23/03/10 10:53:21 INFO DAGScheduler: ResultStage 3 (parquet at NativeMethodAccessorImpl.java:0) finished in 0.415 s
23/03/10 10:53:21 INFO DAGScheduler: Job 2 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 10:53:21 INFO TaskSchedulerImpl: Killing all running tasks in stage 3: Stage finished
23/03/10 10:53:21 INFO DAGScheduler: Job 2 finished: parquet at NativeMethodAccessorImpl.java:0, took 0.449901 s
23/03/10 10:53:21 INFO DAGScheduler: Registering RDD 19 (parquet at NativeMethodAccessorImpl.java:0) as input to shuffle 1
23/03/10 10:53:21 INFO DAGScheduler: Got map stage job 3 (parquet at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 10:53:21 INFO DAGScheduler: Final stage: ShuffleMapStage 5 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 10:53:21 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 4)
23/03/10 10:53:21 INFO DAGScheduler: Missing parents: List()
23/03/10 10:53:21 INFO DAGScheduler: Submitting ShuffleMapStage 5 (MapPartitionsRDD[19] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 10:53:21 INFO MemoryStore: Block broadcast_6 stored as values in memory (estimated size 42.0 KiB, free 365.4 MiB)
23/03/10 10:53:21 INFO MemoryStore: Block broadcast_6_piece0 stored as bytes in memory (estimated size 19.9 KiB, free 365.4 MiB)
23/03/10 10:53:21 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on 172.27.188.152:33623 (size: 19.9 KiB, free: 366.2 MiB)
23/03/10 10:53:21 INFO SparkContext: Created broadcast 6 from broadcast at DAGScheduler.scala:1513
23/03/10 10:53:21 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 5 (MapPartitionsRDD[19] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 10:53:21 INFO TaskSchedulerImpl: Adding task set 5.0 with 1 tasks resource profile 0
23/03/10 10:53:21 INFO TaskSetManager: Starting task 0.0 in stage 5.0 (TID 4) (172.27.188.152, executor 0, partition 0, NODE_LOCAL, 4446 bytes) taskResourceAssignments Map()
23/03/10 10:53:21 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on 172.27.188.152:46077 (size: 19.9 KiB, free: 366.2 MiB)
23/03/10 10:53:21 INFO TaskSetManager: Finished task 0.0 in stage 5.0 (TID 4) in 148 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 10:53:21 INFO TaskSchedulerImpl: Removed TaskSet 5.0, whose tasks have all completed, from pool 
23/03/10 10:53:21 INFO DAGScheduler: ShuffleMapStage 5 (parquet at NativeMethodAccessorImpl.java:0) finished in 0.221 s
23/03/10 10:53:21 INFO DAGScheduler: looking for newly runnable stages
23/03/10 10:53:21 INFO DAGScheduler: running: Set()
23/03/10 10:53:21 INFO DAGScheduler: waiting: Set()
23/03/10 10:53:21 INFO DAGScheduler: failed: Set()
23/03/10 10:53:21 INFO ShufflePartitionsUtil: For shuffle(1), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
23/03/10 10:53:21 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
23/03/10 10:53:21 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
23/03/10 10:53:21 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
23/03/10 10:53:21 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
23/03/10 10:53:21 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
23/03/10 10:53:21 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
23/03/10 10:53:21 INFO CodeGenerator: Code generated in 14.178787 ms
23/03/10 10:53:21 INFO SparkContext: Starting job: parquet at NativeMethodAccessorImpl.java:0
23/03/10 10:53:21 INFO DAGScheduler: Got job 4 (parquet at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 10:53:21 INFO DAGScheduler: Final stage: ResultStage 8 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 10:53:21 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 7)
23/03/10 10:53:21 INFO DAGScheduler: Missing parents: List()
23/03/10 10:53:21 INFO DAGScheduler: Submitting ResultStage 8 (MapPartitionsRDD[21] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 10:53:21 INFO MemoryStore: Block broadcast_7 stored as values in memory (estimated size 240.2 KiB, free 365.2 MiB)
23/03/10 10:53:21 INFO MemoryStore: Block broadcast_7_piece0 stored as bytes in memory (estimated size 89.1 KiB, free 365.1 MiB)
23/03/10 10:53:21 INFO BlockManagerInfo: Added broadcast_7_piece0 in memory on 172.27.188.152:33623 (size: 89.1 KiB, free: 366.1 MiB)
23/03/10 10:53:21 INFO SparkContext: Created broadcast 7 from broadcast at DAGScheduler.scala:1513
23/03/10 10:53:21 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 8 (MapPartitionsRDD[21] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 10:53:21 INFO TaskSchedulerImpl: Adding task set 8.0 with 1 tasks resource profile 0
23/03/10 10:53:21 INFO TaskSetManager: Starting task 0.0 in stage 8.0 (TID 5) (172.27.188.152, executor 0, partition 0, NODE_LOCAL, 4457 bytes) taskResourceAssignments Map()
23/03/10 10:53:21 INFO BlockManagerInfo: Added broadcast_7_piece0 in memory on 172.27.188.152:46077 (size: 89.1 KiB, free: 366.1 MiB)
23/03/10 10:53:21 INFO MapOutputTrackerMasterEndpoint: Asked to send map output locations for shuffle 1 to 172.27.188.152:37342
23/03/10 10:53:23 INFO TaskSetManager: Finished task 0.0 in stage 8.0 (TID 5) in 2029 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 10:53:23 INFO TaskSchedulerImpl: Removed TaskSet 8.0, whose tasks have all completed, from pool 
23/03/10 10:53:23 INFO DAGScheduler: ResultStage 8 (parquet at NativeMethodAccessorImpl.java:0) finished in 2.064 s
23/03/10 10:53:23 INFO DAGScheduler: Job 4 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 10:53:23 INFO TaskSchedulerImpl: Killing all running tasks in stage 8: Stage finished
23/03/10 10:53:23 INFO DAGScheduler: Job 4 finished: parquet at NativeMethodAccessorImpl.java:0, took 2.080177 s
23/03/10 10:53:23 INFO FileFormatWriter: Start to commit write Job ba4fd9ee-fa4d-4cd5-a255-b231dcec14ae.
23/03/10 10:53:23 INFO FileFormatWriter: Write Job ba4fd9ee-fa4d-4cd5-a255-b231dcec14ae committed. Elapsed time: 37 ms.
23/03/10 10:53:23 INFO FileFormatWriter: Finished processing stats for write job ba4fd9ee-fa4d-4cd5-a255-b231dcec14ae.
#######  Created Parquet File  #########
23/03/10 10:53:23 INFO InMemoryFileIndex: It took 1 ms to list leaf files for 1 paths.
23/03/10 10:53:23 INFO SparkContext: Starting job: parquet at NativeMethodAccessorImpl.java:0
23/03/10 10:53:23 INFO DAGScheduler: Got job 5 (parquet at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 10:53:23 INFO DAGScheduler: Final stage: ResultStage 9 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 10:53:23 INFO DAGScheduler: Parents of final stage: List()
23/03/10 10:53:23 INFO DAGScheduler: Missing parents: List()
23/03/10 10:53:23 INFO DAGScheduler: Submitting ResultStage 9 (MapPartitionsRDD[23] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 10:53:23 INFO MemoryStore: Block broadcast_8 stored as values in memory (estimated size 104.4 KiB, free 365.0 MiB)
23/03/10 10:53:23 INFO MemoryStore: Block broadcast_8_piece0 stored as bytes in memory (estimated size 37.6 KiB, free 365.0 MiB)
23/03/10 10:53:23 INFO BlockManagerInfo: Added broadcast_8_piece0 in memory on 172.27.188.152:33623 (size: 37.6 KiB, free: 366.1 MiB)
23/03/10 10:53:23 INFO SparkContext: Created broadcast 8 from broadcast at DAGScheduler.scala:1513
23/03/10 10:53:24 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 9 (MapPartitionsRDD[23] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 10:53:24 INFO TaskSchedulerImpl: Adding task set 9.0 with 1 tasks resource profile 0
23/03/10 10:53:24 INFO TaskSetManager: Starting task 0.0 in stage 9.0 (TID 6) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 4649 bytes) taskResourceAssignments Map()
23/03/10 10:53:24 INFO BlockManagerInfo: Added broadcast_8_piece0 in memory on 172.27.188.152:46077 (size: 37.6 KiB, free: 366.1 MiB)
23/03/10 10:53:24 INFO TaskSetManager: Finished task 0.0 in stage 9.0 (TID 6) in 108 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 10:53:24 INFO TaskSchedulerImpl: Removed TaskSet 9.0, whose tasks have all completed, from pool 
23/03/10 10:53:24 INFO DAGScheduler: ResultStage 9 (parquet at NativeMethodAccessorImpl.java:0) finished in 0.134 s
23/03/10 10:53:24 INFO DAGScheduler: Job 5 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 10:53:24 INFO TaskSchedulerImpl: Killing all running tasks in stage 9: Stage finished
23/03/10 10:53:24 INFO DAGScheduler: Job 5 finished: parquet at NativeMethodAccessorImpl.java:0, took 0.145165 s
##########   Parquet File Output    ########################
23/03/10 10:53:24 INFO FileSourceStrategy: Pushed Filters: 
23/03/10 10:53:24 INFO FileSourceStrategy: Post-Scan Filters: 
23/03/10 10:53:24 INFO FileSourceStrategy: Output Data Schema: struct<age: string, count: bigint>
23/03/10 10:53:24 INFO CodeGenerator: Code generated in 19.235004 ms
23/03/10 10:53:24 INFO MemoryStore: Block broadcast_9 stored as values in memory (estimated size 357.5 KiB, free 364.6 MiB)
23/03/10 10:53:24 INFO MemoryStore: Block broadcast_9_piece0 stored as bytes in memory (estimated size 35.4 KiB, free 364.6 MiB)
23/03/10 10:53:24 INFO BlockManagerInfo: Added broadcast_9_piece0 in memory on 172.27.188.152:33623 (size: 35.4 KiB, free: 366.0 MiB)
23/03/10 10:53:24 INFO SparkContext: Created broadcast 9 from showString at NativeMethodAccessorImpl.java:0
23/03/10 10:53:24 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 10:53:24 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
23/03/10 10:53:24 INFO DAGScheduler: Got job 6 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 10:53:24 INFO DAGScheduler: Final stage: ResultStage 10 (showString at NativeMethodAccessorImpl.java:0)
23/03/10 10:53:24 INFO DAGScheduler: Parents of final stage: List()
23/03/10 10:53:24 INFO DAGScheduler: Missing parents: List()
23/03/10 10:53:24 INFO DAGScheduler: Submitting ResultStage 10 (MapPartitionsRDD[27] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 10:53:24 INFO MemoryStore: Block broadcast_10 stored as values in memory (estimated size 13.6 KiB, free 364.6 MiB)
23/03/10 10:53:24 INFO MemoryStore: Block broadcast_10_piece0 stored as bytes in memory (estimated size 6.1 KiB, free 364.6 MiB)
23/03/10 10:53:24 INFO BlockManagerInfo: Added broadcast_10_piece0 in memory on 172.27.188.152:33623 (size: 6.1 KiB, free: 366.0 MiB)
23/03/10 10:53:24 INFO SparkContext: Created broadcast 10 from broadcast at DAGScheduler.scala:1513
23/03/10 10:53:24 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 10 (MapPartitionsRDD[27] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 10:53:24 INFO TaskSchedulerImpl: Adding task set 10.0 with 1 tasks resource profile 0
23/03/10 10:53:24 INFO TaskSetManager: Starting task 0.0 in stage 10.0 (TID 7) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 4974 bytes) taskResourceAssignments Map()
23/03/10 10:53:24 INFO BlockManagerInfo: Added broadcast_10_piece0 in memory on 172.27.188.152:46077 (size: 6.1 KiB, free: 366.1 MiB)
23/03/10 10:53:24 INFO BlockManagerInfo: Added broadcast_9_piece0 in memory on 172.27.188.152:46077 (size: 35.4 KiB, free: 366.1 MiB)
23/03/10 10:53:24 INFO TaskSetManager: Finished task 0.0 in stage 10.0 (TID 7) in 233 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 10:53:24 INFO TaskSchedulerImpl: Removed TaskSet 10.0, whose tasks have all completed, from pool 
23/03/10 10:53:24 INFO DAGScheduler: ResultStage 10 (showString at NativeMethodAccessorImpl.java:0) finished in 0.256 s
23/03/10 10:53:24 INFO DAGScheduler: Job 6 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 10:53:24 INFO TaskSchedulerImpl: Killing all running tasks in stage 10: Stage finished
23/03/10 10:53:24 INFO DAGScheduler: Job 6 finished: showString at NativeMethodAccessorImpl.java:0, took 0.269310 s
23/03/10 10:53:24 INFO CodeGenerator: Code generated in 10.996312 ms
+---+-----+
|age|count|
+---+-----+
| 32|  221|
| 30|  217|
| 33|  210|
| 35|  209|
| 31|  206|
| 34|  198|
| 36|  195|
| 29|  171|
| 37|  170|
| 28|  162|
| 38|  144|
| 39|  143|
| 27|  141|
| 26|  134|
| 41|  120|
| 46|  118|
| 40|  116|
| 47|  113|
| 25|  113|
| 42|  111|
+---+-----+
only showing top 20 rows

None
23/03/10 10:53:24 INFO FileSourceStrategy: Pushed Filters: IsNotNull(y),EqualTo(y,yes)
23/03/10 10:53:24 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(y#33),(y#33 = yes)
23/03/10 10:53:24 INFO FileSourceStrategy: Output Data Schema: struct<age: string, y: string>
23/03/10 10:53:24 INFO deprecation: mapred.output.compress is deprecated. Instead, use mapreduce.output.fileoutputformat.compress
23/03/10 10:53:24 INFO AvroUtils: Compressing Avro output using the snappy codec
23/03/10 10:53:24 INFO CodeGenerator: Code generated in 42.356863 ms
23/03/10 10:53:24 INFO CodeGenerator: Code generated in 19.869349 ms
23/03/10 10:53:24 INFO MemoryStore: Block broadcast_11 stored as values in memory (estimated size 353.2 KiB, free 364.2 MiB)
23/03/10 10:53:24 INFO MemoryStore: Block broadcast_11_piece0 stored as bytes in memory (estimated size 34.7 KiB, free 364.2 MiB)
23/03/10 10:53:24 INFO BlockManagerInfo: Added broadcast_11_piece0 in memory on 172.27.188.152:33623 (size: 34.7 KiB, free: 366.0 MiB)
23/03/10 10:53:24 INFO SparkContext: Created broadcast 11 from save at NativeMethodAccessorImpl.java:0
23/03/10 10:53:24 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 10:53:25 INFO DAGScheduler: Registering RDD 34 (save at NativeMethodAccessorImpl.java:0) as input to shuffle 2
23/03/10 10:53:25 INFO DAGScheduler: Got map stage job 7 (save at NativeMethodAccessorImpl.java:0) with 2 output partitions
23/03/10 10:53:25 INFO DAGScheduler: Final stage: ShuffleMapStage 11 (save at NativeMethodAccessorImpl.java:0)
23/03/10 10:53:25 INFO DAGScheduler: Parents of final stage: List()
23/03/10 10:53:25 INFO DAGScheduler: Missing parents: List()
23/03/10 10:53:25 INFO DAGScheduler: Submitting ShuffleMapStage 11 (MapPartitionsRDD[34] at save at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 10:53:25 INFO MemoryStore: Block broadcast_12 stored as values in memory (estimated size 46.0 KiB, free 364.1 MiB)
23/03/10 10:53:25 INFO MemoryStore: Block broadcast_12_piece0 stored as bytes in memory (estimated size 21.8 KiB, free 364.1 MiB)
23/03/10 10:53:25 INFO BlockManagerInfo: Added broadcast_12_piece0 in memory on 172.27.188.152:33623 (size: 21.8 KiB, free: 366.0 MiB)
23/03/10 10:53:25 INFO SparkContext: Created broadcast 12 from broadcast at DAGScheduler.scala:1513
23/03/10 10:53:25 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 11 (MapPartitionsRDD[34] at save at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
23/03/10 10:53:25 INFO TaskSchedulerImpl: Adding task set 11.0 with 2 tasks resource profile 0
23/03/10 10:53:25 INFO TaskSetManager: Starting task 0.0 in stage 11.0 (TID 8) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 4974 bytes) taskResourceAssignments Map()
23/03/10 10:53:25 INFO TaskSetManager: Starting task 1.0 in stage 11.0 (TID 9) (172.27.188.152, executor 0, partition 1, PROCESS_LOCAL, 4974 bytes) taskResourceAssignments Map()
23/03/10 10:53:25 INFO BlockManagerInfo: Added broadcast_12_piece0 in memory on 172.27.188.152:46077 (size: 21.8 KiB, free: 366.0 MiB)
23/03/10 10:53:26 INFO BlockManagerInfo: Added broadcast_11_piece0 in memory on 172.27.188.152:46077 (size: 34.7 KiB, free: 366.0 MiB)
23/03/10 10:53:26 INFO TaskSetManager: Finished task 1.0 in stage 11.0 (TID 9) in 1505 ms on 172.27.188.152 (executor 0) (1/2)
23/03/10 10:53:26 INFO PythonAccumulatorV2: Connected to AccumulatorServer at host: 127.0.0.1 port: 51873
23/03/10 10:53:26 INFO TaskSetManager: Finished task 0.0 in stage 11.0 (TID 8) in 1567 ms on 172.27.188.152 (executor 0) (2/2)
23/03/10 10:53:26 INFO TaskSchedulerImpl: Removed TaskSet 11.0, whose tasks have all completed, from pool 
23/03/10 10:53:26 INFO DAGScheduler: ShuffleMapStage 11 (save at NativeMethodAccessorImpl.java:0) finished in 1.602 s
23/03/10 10:53:26 INFO DAGScheduler: looking for newly runnable stages
23/03/10 10:53:26 INFO DAGScheduler: running: Set()
23/03/10 10:53:26 INFO DAGScheduler: waiting: Set()
23/03/10 10:53:26 INFO DAGScheduler: failed: Set()
23/03/10 10:53:26 INFO ShufflePartitionsUtil: For shuffle(2), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
23/03/10 10:53:26 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
23/03/10 10:53:26 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
23/03/10 10:53:26 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter
23/03/10 10:53:26 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
23/03/10 10:53:26 INFO CodeGenerator: Code generated in 16.723494 ms
23/03/10 10:53:26 INFO SparkContext: Starting job: save at NativeMethodAccessorImpl.java:0
23/03/10 10:53:26 INFO DAGScheduler: Got job 8 (save at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 10:53:26 INFO DAGScheduler: Final stage: ResultStage 13 (save at NativeMethodAccessorImpl.java:0)
23/03/10 10:53:26 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 12)
23/03/10 10:53:26 INFO DAGScheduler: Missing parents: List()
23/03/10 10:53:26 INFO DAGScheduler: Submitting ResultStage 13 (MapPartitionsRDD[36] at save at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 10:53:26 INFO MemoryStore: Block broadcast_13 stored as values in memory (estimated size 245.3 KiB, free 363.9 MiB)
23/03/10 10:53:26 INFO MemoryStore: Block broadcast_13_piece0 stored as bytes in memory (estimated size 91.7 KiB, free 363.8 MiB)
23/03/10 10:53:26 INFO BlockManagerInfo: Added broadcast_13_piece0 in memory on 172.27.188.152:33623 (size: 91.7 KiB, free: 365.9 MiB)
23/03/10 10:53:26 INFO SparkContext: Created broadcast 13 from broadcast at DAGScheduler.scala:1513
23/03/10 10:53:26 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 13 (MapPartitionsRDD[36] at save at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 10:53:26 INFO TaskSchedulerImpl: Adding task set 13.0 with 1 tasks resource profile 0
23/03/10 10:53:26 INFO TaskSetManager: Starting task 0.0 in stage 13.0 (TID 10) (172.27.188.152, executor 0, partition 0, NODE_LOCAL, 4457 bytes) taskResourceAssignments Map()
23/03/10 10:53:26 INFO BlockManagerInfo: Added broadcast_13_piece0 in memory on 172.27.188.152:46077 (size: 91.7 KiB, free: 365.9 MiB)
23/03/10 10:53:26 INFO MapOutputTrackerMasterEndpoint: Asked to send map output locations for shuffle 2 to 172.27.188.152:37342
23/03/10 10:53:27 INFO TaskSetManager: Finished task 0.0 in stage 13.0 (TID 10) in 268 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 10:53:27 INFO TaskSchedulerImpl: Removed TaskSet 13.0, whose tasks have all completed, from pool 
23/03/10 10:53:27 INFO DAGScheduler: ResultStage 13 (save at NativeMethodAccessorImpl.java:0) finished in 0.302 s
23/03/10 10:53:27 INFO DAGScheduler: Job 8 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 10:53:27 INFO TaskSchedulerImpl: Killing all running tasks in stage 13: Stage finished
23/03/10 10:53:27 INFO DAGScheduler: Job 8 finished: save at NativeMethodAccessorImpl.java:0, took 0.315746 s
23/03/10 10:53:27 INFO FileFormatWriter: Start to commit write Job 7f9e5290-cf2c-4770-bbd7-fea48853f425.
23/03/10 10:53:27 INFO FileFormatWriter: Write Job 7f9e5290-cf2c-4770-bbd7-fea48853f425 committed. Elapsed time: 14 ms.
23/03/10 10:53:27 INFO FileFormatWriter: Finished processing stats for write job 7f9e5290-cf2c-4770-bbd7-fea48853f425.
#######  Created Avro File  #########
23/03/10 10:53:27 INFO InMemoryFileIndex: It took 1 ms to list leaf files for 1 paths.
##########   Avro File Output    ########################
23/03/10 10:53:27 INFO FileSourceStrategy: Pushed Filters: 
23/03/10 10:53:27 INFO FileSourceStrategy: Post-Scan Filters: 
23/03/10 10:53:27 INFO FileSourceStrategy: Output Data Schema: struct<age_cat: string, count: bigint>
23/03/10 10:53:27 INFO CodeGenerator: Code generated in 10.034352 ms
23/03/10 10:53:27 INFO MemoryStore: Block broadcast_14 stored as values in memory (estimated size 352.9 KiB, free 363.4 MiB)
23/03/10 10:53:27 INFO MemoryStore: Block broadcast_14_piece0 stored as bytes in memory (estimated size 34.8 KiB, free 363.4 MiB)
23/03/10 10:53:27 INFO BlockManagerInfo: Added broadcast_14_piece0 in memory on 172.27.188.152:33623 (size: 34.8 KiB, free: 365.9 MiB)
23/03/10 10:53:27 INFO SparkContext: Created broadcast 14 from showString at NativeMethodAccessorImpl.java:0
23/03/10 10:53:27 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 10:53:27 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
23/03/10 10:53:27 INFO DAGScheduler: Got job 9 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 10:53:27 INFO DAGScheduler: Final stage: ResultStage 14 (showString at NativeMethodAccessorImpl.java:0)
23/03/10 10:53:27 INFO DAGScheduler: Parents of final stage: List()
23/03/10 10:53:27 INFO DAGScheduler: Missing parents: List()
23/03/10 10:53:27 INFO DAGScheduler: Submitting ResultStage 14 (MapPartitionsRDD[40] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 10:53:27 INFO MemoryStore: Block broadcast_15 stored as values in memory (estimated size 12.0 KiB, free 363.4 MiB)
23/03/10 10:53:27 INFO MemoryStore: Block broadcast_15_piece0 stored as bytes in memory (estimated size 6.0 KiB, free 363.4 MiB)
23/03/10 10:53:27 INFO BlockManagerInfo: Added broadcast_15_piece0 in memory on 172.27.188.152:33623 (size: 6.0 KiB, free: 365.8 MiB)
23/03/10 10:53:27 INFO SparkContext: Created broadcast 15 from broadcast at DAGScheduler.scala:1513
23/03/10 10:53:27 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 14 (MapPartitionsRDD[40] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 10:53:27 INFO TaskSchedulerImpl: Adding task set 14.0 with 1 tasks resource profile 0
23/03/10 10:53:27 INFO TaskSetManager: Starting task 0.0 in stage 14.0 (TID 11) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 4961 bytes) taskResourceAssignments Map()
23/03/10 10:53:27 INFO BlockManagerInfo: Added broadcast_15_piece0 in memory on 172.27.188.152:46077 (size: 6.0 KiB, free: 365.9 MiB)
23/03/10 10:53:27 INFO BlockManagerInfo: Added broadcast_14_piece0 in memory on 172.27.188.152:46077 (size: 34.8 KiB, free: 365.9 MiB)
23/03/10 10:53:27 INFO TaskSetManager: Finished task 0.0 in stage 14.0 (TID 11) in 171 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 10:53:27 INFO TaskSchedulerImpl: Removed TaskSet 14.0, whose tasks have all completed, from pool 
23/03/10 10:53:27 INFO DAGScheduler: ResultStage 14 (showString at NativeMethodAccessorImpl.java:0) finished in 0.200 s
23/03/10 10:53:27 INFO DAGScheduler: Job 9 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 10:53:27 INFO TaskSchedulerImpl: Killing all running tasks in stage 14: Stage finished
23/03/10 10:53:27 INFO DAGScheduler: Job 9 finished: showString at NativeMethodAccessorImpl.java:0, took 0.211317 s
+-------+-----+
|age_cat|count|
+-------+-----+
|  Young| 2924|
+-------+-----+

None
23/03/10 10:53:27 INFO SparkContext: Invoking stop() from shutdown hook
23/03/10 10:53:27 INFO SparkUI: Stopped Spark web UI at http://172.27.188.152:4040
23/03/10 10:53:27 INFO StandaloneSchedulerBackend: Shutting down all executors
23/03/10 10:53:27 INFO CoarseGrainedSchedulerBackend$DriverEndpoint: Asking each executor to shut down
23/03/10 10:53:27 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
23/03/10 10:53:27 INFO MemoryStore: MemoryStore cleared
23/03/10 10:53:27 INFO BlockManager: BlockManager stopped
23/03/10 10:53:27 INFO BlockManagerMaster: BlockManagerMaster stopped
23/03/10 10:53:27 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
23/03/10 10:53:27 INFO SparkContext: Successfully stopped SparkContext
23/03/10 10:53:27 INFO ShutdownHookManager: Shutdown hook called
23/03/10 10:53:27 INFO ShutdownHookManager: Deleting directory /tmp/spark-ea1e133f-7a2b-4e77-abd1-b5b79b0c5ec3/pyspark-06005ca9-cbad-4615-a05a-14e7362212a4
23/03/10 10:53:27 INFO ShutdownHookManager: Deleting directory /tmp/spark-ea1e133f-7a2b-4e77-abd1-b5b79b0c5ec3
23/03/10 10:53:27 INFO ShutdownHookManager: Deleting directory /tmp/spark-b12a662f-4f61-4e86-994b-06ca68c86d76
##### Finished Executor #####
============================================
Fri Mar 10 05:24:01 UTC 2023
##### Started Executor #####
23/03/10 10:54:09 WARN Utils: Your hostname, MILES-BL-4819-LAP resolves to a loopback address: 127.0.1.1; using 172.27.188.152 instead (on interface eth0)
23/03/10 10:54:09 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
:: loading settings :: url = jar:file:/opt/spark/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml
Ivy Default Cache set to: /home/shashi/.ivy2/cache
The jars for the packages stored in: /home/shashi/.ivy2/jars
org.apache.spark#spark-avro_2.12 added as a dependency
:: resolving dependencies :: org.apache.spark#spark-submit-parent-7aac1132-abd3-4b19-bae9-c27a07e7e18b;1.0
	confs: [default]
	found org.apache.spark#spark-avro_2.12;3.3.2 in central
	found org.tukaani#xz;1.9 in central
	found org.spark-project.spark#unused;1.0.0 in central
:: resolution report :: resolve 790ms :: artifacts dl 15ms
	:: modules in use:
	org.apache.spark#spark-avro_2.12;3.3.2 from central in [default]
	org.spark-project.spark#unused;1.0.0 from central in [default]
	org.tukaani#xz;1.9 from central in [default]
	---------------------------------------------------------------------
	|                  |            modules            ||   artifacts   |
	|       conf       | number| search|dwnlded|evicted|| number|dwnlded|
	---------------------------------------------------------------------
	|      default     |   3   |   0   |   0   |   0   ||   3   |   0   |
	---------------------------------------------------------------------
:: retrieving :: org.apache.spark#spark-submit-parent-7aac1132-abd3-4b19-bae9-c27a07e7e18b
	confs: [default]
	0 artifacts copied, 3 already retrieved (0kB/15ms)
23/03/10 10:54:13 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
23/03/10 10:54:15 INFO SparkContext: Running Spark version 3.3.2
23/03/10 10:54:15 INFO ResourceUtils: ==============================================================
23/03/10 10:54:15 INFO ResourceUtils: No custom resources configured for spark.driver.
23/03/10 10:54:15 INFO ResourceUtils: ==============================================================
23/03/10 10:54:15 INFO SparkContext: Submitted application: Bank Market
23/03/10 10:54:16 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
23/03/10 10:54:16 INFO ResourceProfile: Limiting resource is cpu
23/03/10 10:54:16 INFO ResourceProfileManager: Added ResourceProfile id: 0
23/03/10 10:54:16 INFO SecurityManager: Changing view acls to: shashi
23/03/10 10:54:16 INFO SecurityManager: Changing modify acls to: shashi
23/03/10 10:54:16 INFO SecurityManager: Changing view acls groups to: 
23/03/10 10:54:16 INFO SecurityManager: Changing modify acls groups to: 
23/03/10 10:54:16 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(shashi); groups with view permissions: Set(); users  with modify permissions: Set(shashi); groups with modify permissions: Set()
23/03/10 10:54:22 INFO Utils: Successfully started service 'sparkDriver' on port 44881.
23/03/10 10:54:23 INFO SparkEnv: Registering MapOutputTracker
23/03/10 10:54:23 INFO SparkEnv: Registering BlockManagerMaster
23/03/10 10:54:23 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
23/03/10 10:54:23 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
23/03/10 10:54:23 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
23/03/10 10:54:23 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-d0dd8946-92d1-4c02-b2fa-ed1ba01fadef
23/03/10 10:54:23 INFO MemoryStore: MemoryStore started with capacity 366.3 MiB
23/03/10 10:54:23 INFO SparkEnv: Registering OutputCommitCoordinator
23/03/10 10:54:23 INFO Utils: Successfully started service 'SparkUI' on port 4040.
23/03/10 10:54:24 INFO SparkContext: Added JAR file:///home/shashi/.ivy2/jars/org.apache.spark_spark-avro_2.12-3.3.2.jar at spark://172.27.188.152:44881/jars/org.apache.spark_spark-avro_2.12-3.3.2.jar with timestamp 1678425855539
23/03/10 10:54:24 INFO SparkContext: Added JAR file:///home/shashi/.ivy2/jars/org.tukaani_xz-1.9.jar at spark://172.27.188.152:44881/jars/org.tukaani_xz-1.9.jar with timestamp 1678425855539
23/03/10 10:54:24 INFO SparkContext: Added JAR file:///home/shashi/.ivy2/jars/org.spark-project.spark_unused-1.0.0.jar at spark://172.27.188.152:44881/jars/org.spark-project.spark_unused-1.0.0.jar with timestamp 1678425855539
23/03/10 10:54:24 INFO SparkContext: Added file file:///home/shashi/.ivy2/jars/org.apache.spark_spark-avro_2.12-3.3.2.jar at spark://172.27.188.152:44881/files/org.apache.spark_spark-avro_2.12-3.3.2.jar with timestamp 1678425855539
23/03/10 10:54:24 INFO Utils: Copying /home/shashi/.ivy2/jars/org.apache.spark_spark-avro_2.12-3.3.2.jar to /tmp/spark-1508eab9-5132-4792-8840-d57a37662f7f/userFiles-1b863df6-f5ca-49d5-a3d2-d64a99c89f5a/org.apache.spark_spark-avro_2.12-3.3.2.jar
23/03/10 10:54:24 INFO SparkContext: Added file file:///home/shashi/.ivy2/jars/org.tukaani_xz-1.9.jar at spark://172.27.188.152:44881/files/org.tukaani_xz-1.9.jar with timestamp 1678425855539
23/03/10 10:54:24 INFO Utils: Copying /home/shashi/.ivy2/jars/org.tukaani_xz-1.9.jar to /tmp/spark-1508eab9-5132-4792-8840-d57a37662f7f/userFiles-1b863df6-f5ca-49d5-a3d2-d64a99c89f5a/org.tukaani_xz-1.9.jar
23/03/10 10:54:24 INFO SparkContext: Added file file:///home/shashi/.ivy2/jars/org.spark-project.spark_unused-1.0.0.jar at spark://172.27.188.152:44881/files/org.spark-project.spark_unused-1.0.0.jar with timestamp 1678425855539
23/03/10 10:54:24 INFO Utils: Copying /home/shashi/.ivy2/jars/org.spark-project.spark_unused-1.0.0.jar to /tmp/spark-1508eab9-5132-4792-8840-d57a37662f7f/userFiles-1b863df6-f5ca-49d5-a3d2-d64a99c89f5a/org.spark-project.spark_unused-1.0.0.jar
23/03/10 10:54:24 INFO StandaloneAppClient$ClientEndpoint: Connecting to master spark://MILES-BL-4819-LAP.:7077...
23/03/10 10:54:24 INFO TransportClientFactory: Successfully created connection to MILES-BL-4819-LAP./127.0.1.1:7077 after 96 ms (0 ms spent in bootstraps)
23/03/10 10:54:24 INFO StandaloneSchedulerBackend: Connected to Spark cluster with app ID app-20230310105424-0002
23/03/10 10:54:24 INFO StandaloneAppClient$ClientEndpoint: Executor added: app-20230310105424-0002/0 on worker-20230309123128-172.27.188.152-45151 (172.27.188.152:45151) with 8 core(s)
23/03/10 10:54:24 INFO StandaloneSchedulerBackend: Granted executor ID app-20230310105424-0002/0 on hostPort 172.27.188.152:45151 with 8 core(s), 1024.0 MiB RAM
23/03/10 10:54:24 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 40097.
23/03/10 10:54:24 INFO NettyBlockTransferService: Server created on 172.27.188.152:40097
23/03/10 10:54:24 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
23/03/10 10:54:24 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, 172.27.188.152, 40097, None)
23/03/10 10:54:24 INFO BlockManagerMasterEndpoint: Registering block manager 172.27.188.152:40097 with 366.3 MiB RAM, BlockManagerId(driver, 172.27.188.152, 40097, None)
23/03/10 10:54:24 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, 172.27.188.152, 40097, None)
23/03/10 10:54:24 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, 172.27.188.152, 40097, None)
23/03/10 10:54:24 INFO StandaloneAppClient$ClientEndpoint: Executor updated: app-20230310105424-0002/0 is now RUNNING
23/03/10 10:54:25 INFO SingleEventLogFileWriter: Logging events to file:/tmp/spark-events/app-20230310105424-0002.inprogress
23/03/10 10:54:25 INFO StandaloneSchedulerBackend: SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio: 0.0
23/03/10 10:54:26 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
23/03/10 10:54:26 INFO SharedState: Warehouse path is 'file:/home/shashi/spark-warehouse'.
23/03/10 10:54:27 INFO InMemoryFileIndex: It took 110 ms to list leaf files for 1 paths.
23/03/10 10:54:28 INFO InMemoryFileIndex: It took 75 ms to list leaf files for 1 paths.
23/03/10 10:54:30 INFO CoarseGrainedSchedulerBackend$DriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (172.27.188.152:58688) with ID 0,  ResourceProfileId 0
23/03/10 10:54:30 INFO BlockManagerMasterEndpoint: Registering block manager 172.27.188.152:41411 with 366.3 MiB RAM, BlockManagerId(0, 172.27.188.152, 41411, None)
23/03/10 10:54:31 INFO FileSourceStrategy: Pushed Filters: 
23/03/10 10:54:31 INFO FileSourceStrategy: Post-Scan Filters: (length(trim(value#0, None)) > 0)
23/03/10 10:54:31 INFO FileSourceStrategy: Output Data Schema: struct<value: string>
23/03/10 10:54:32 INFO CodeGenerator: Code generated in 223.344247 ms
23/03/10 10:54:32 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 353.3 KiB, free 366.0 MiB)
23/03/10 10:54:32 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 34.8 KiB, free 365.9 MiB)
23/03/10 10:54:32 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 172.27.188.152:40097 (size: 34.8 KiB, free: 366.3 MiB)
23/03/10 10:54:32 INFO SparkContext: Created broadcast 0 from load at NativeMethodAccessorImpl.java:0
23/03/10 10:54:32 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 10:54:32 INFO SparkContext: Starting job: load at NativeMethodAccessorImpl.java:0
23/03/10 10:54:32 INFO DAGScheduler: Got job 0 (load at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 10:54:32 INFO DAGScheduler: Final stage: ResultStage 0 (load at NativeMethodAccessorImpl.java:0)
23/03/10 10:54:32 INFO DAGScheduler: Parents of final stage: List()
23/03/10 10:54:32 INFO DAGScheduler: Missing parents: List()
23/03/10 10:54:32 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at load at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 10:54:32 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 11.9 KiB, free 365.9 MiB)
23/03/10 10:54:32 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 5.9 KiB, free 365.9 MiB)
23/03/10 10:54:32 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on 172.27.188.152:40097 (size: 5.9 KiB, free: 366.3 MiB)
23/03/10 10:54:32 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1513
23/03/10 10:54:32 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at load at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 10:54:32 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
23/03/10 10:54:32 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 4985 bytes) taskResourceAssignments Map()
23/03/10 10:54:33 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on 172.27.188.152:41411 (size: 5.9 KiB, free: 366.3 MiB)
23/03/10 10:54:34 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 172.27.188.152:41411 (size: 34.8 KiB, free: 366.3 MiB)
23/03/10 10:54:35 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 2111 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 10:54:35 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool 
23/03/10 10:54:35 INFO DAGScheduler: ResultStage 0 (load at NativeMethodAccessorImpl.java:0) finished in 2.308 s
23/03/10 10:54:35 INFO DAGScheduler: Job 0 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 10:54:35 INFO TaskSchedulerImpl: Killing all running tasks in stage 0: Stage finished
23/03/10 10:54:35 INFO DAGScheduler: Job 0 finished: load at NativeMethodAccessorImpl.java:0, took 2.429848 s
23/03/10 10:54:35 INFO CodeGenerator: Code generated in 21.808897 ms
23/03/10 10:54:35 INFO FileSourceStrategy: Pushed Filters: 
23/03/10 10:54:35 INFO FileSourceStrategy: Post-Scan Filters: 
23/03/10 10:54:35 INFO FileSourceStrategy: Output Data Schema: struct<value: string>
23/03/10 10:54:35 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 353.3 KiB, free 365.6 MiB)
23/03/10 10:54:35 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 34.8 KiB, free 365.5 MiB)
23/03/10 10:54:35 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on 172.27.188.152:40097 (size: 34.8 KiB, free: 366.2 MiB)
23/03/10 10:54:35 INFO SparkContext: Created broadcast 2 from load at NativeMethodAccessorImpl.java:0
23/03/10 10:54:35 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 10:54:35 INFO FileSourceStrategy: Pushed Filters: IsNotNull(y),EqualTo(y,yes)
23/03/10 10:54:35 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(y#33),(y#33 = yes)
23/03/10 10:54:35 INFO FileSourceStrategy: Output Data Schema: struct<age: string, y: string>
23/03/10 10:54:35 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
23/03/10 10:54:36 INFO CodeGenerator: Code generated in 101.050154 ms
23/03/10 10:54:36 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 353.2 KiB, free 365.2 MiB)
23/03/10 10:54:36 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 34.8 KiB, free 365.1 MiB)
23/03/10 10:54:36 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on 172.27.188.152:40097 (size: 34.8 KiB, free: 366.2 MiB)
23/03/10 10:54:36 INFO SparkContext: Created broadcast 3 from parquet at NativeMethodAccessorImpl.java:0
23/03/10 10:54:36 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 10:54:36 INFO DAGScheduler: Registering RDD 13 (parquet at NativeMethodAccessorImpl.java:0) as input to shuffle 0
23/03/10 10:54:36 INFO DAGScheduler: Got map stage job 1 (parquet at NativeMethodAccessorImpl.java:0) with 2 output partitions
23/03/10 10:54:36 INFO DAGScheduler: Final stage: ShuffleMapStage 1 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 10:54:36 INFO DAGScheduler: Parents of final stage: List()
23/03/10 10:54:36 INFO DAGScheduler: Missing parents: List()
23/03/10 10:54:36 INFO DAGScheduler: Submitting ShuffleMapStage 1 (MapPartitionsRDD[13] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 10:54:36 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 38.5 KiB, free 365.1 MiB)
23/03/10 10:54:36 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 18.2 KiB, free 365.1 MiB)
23/03/10 10:54:36 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on 172.27.188.152:40097 (size: 18.2 KiB, free: 366.2 MiB)
23/03/10 10:54:36 INFO SparkContext: Created broadcast 4 from broadcast at DAGScheduler.scala:1513
23/03/10 10:54:36 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 1 (MapPartitionsRDD[13] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
23/03/10 10:54:36 INFO TaskSchedulerImpl: Adding task set 1.0 with 2 tasks resource profile 0
23/03/10 10:54:36 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 1) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 4974 bytes) taskResourceAssignments Map()
23/03/10 10:54:36 INFO TaskSetManager: Starting task 1.0 in stage 1.0 (TID 2) (172.27.188.152, executor 0, partition 1, PROCESS_LOCAL, 4974 bytes) taskResourceAssignments Map()
23/03/10 10:54:36 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on 172.27.188.152:41411 (size: 18.2 KiB, free: 366.2 MiB)
23/03/10 10:54:36 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on 172.27.188.152:41411 (size: 34.8 KiB, free: 366.2 MiB)
23/03/10 10:54:37 INFO TaskSetManager: Finished task 1.0 in stage 1.0 (TID 2) in 986 ms on 172.27.188.152 (executor 0) (1/2)
23/03/10 10:54:37 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 1) in 1076 ms on 172.27.188.152 (executor 0) (2/2)
23/03/10 10:54:37 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool 
23/03/10 10:54:37 INFO DAGScheduler: ShuffleMapStage 1 (parquet at NativeMethodAccessorImpl.java:0) finished in 1.108 s
23/03/10 10:54:37 INFO DAGScheduler: looking for newly runnable stages
23/03/10 10:54:37 INFO DAGScheduler: running: Set()
23/03/10 10:54:37 INFO DAGScheduler: waiting: Set()
23/03/10 10:54:37 INFO DAGScheduler: failed: Set()
23/03/10 10:54:37 INFO ShufflePartitionsUtil: For shuffle(0), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
23/03/10 10:54:37 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
23/03/10 10:54:37 INFO CodeGenerator: Code generated in 26.69501 ms
23/03/10 10:54:37 INFO CodeGenerator: Code generated in 22.03281 ms
23/03/10 10:54:37 INFO SparkContext: Starting job: parquet at NativeMethodAccessorImpl.java:0
23/03/10 10:54:37 INFO DAGScheduler: Got job 2 (parquet at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 10:54:37 INFO DAGScheduler: Final stage: ResultStage 3 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 10:54:37 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 2)
23/03/10 10:54:37 INFO DAGScheduler: Missing parents: List()
23/03/10 10:54:37 INFO DAGScheduler: Submitting ResultStage 3 (MapPartitionsRDD[18] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 10:54:37 INFO MemoryStore: Block broadcast_5 stored as values in memory (estimated size 40.0 KiB, free 365.1 MiB)
23/03/10 10:54:37 INFO MemoryStore: Block broadcast_5_piece0 stored as bytes in memory (estimated size 19.2 KiB, free 365.0 MiB)
23/03/10 10:54:37 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on 172.27.188.152:40097 (size: 19.2 KiB, free: 366.2 MiB)
23/03/10 10:54:37 INFO SparkContext: Created broadcast 5 from broadcast at DAGScheduler.scala:1513
23/03/10 10:54:37 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 3 (MapPartitionsRDD[18] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 10:54:37 INFO TaskSchedulerImpl: Adding task set 3.0 with 1 tasks resource profile 0
23/03/10 10:54:37 INFO TaskSetManager: Starting task 0.0 in stage 3.0 (TID 3) (172.27.188.152, executor 0, partition 0, NODE_LOCAL, 4457 bytes) taskResourceAssignments Map()
23/03/10 10:54:37 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on 172.27.188.152:41411 (size: 19.2 KiB, free: 366.2 MiB)
23/03/10 10:54:37 INFO MapOutputTrackerMasterEndpoint: Asked to send map output locations for shuffle 0 to 172.27.188.152:58688
23/03/10 10:54:38 INFO TaskSetManager: Finished task 0.0 in stage 3.0 (TID 3) in 340 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 10:54:38 INFO TaskSchedulerImpl: Removed TaskSet 3.0, whose tasks have all completed, from pool 
23/03/10 10:54:38 INFO DAGScheduler: ResultStage 3 (parquet at NativeMethodAccessorImpl.java:0) finished in 0.370 s
23/03/10 10:54:38 INFO DAGScheduler: Job 2 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 10:54:38 INFO TaskSchedulerImpl: Killing all running tasks in stage 3: Stage finished
23/03/10 10:54:38 INFO DAGScheduler: Job 2 finished: parquet at NativeMethodAccessorImpl.java:0, took 0.418316 s
23/03/10 10:54:38 INFO DAGScheduler: Registering RDD 19 (parquet at NativeMethodAccessorImpl.java:0) as input to shuffle 1
23/03/10 10:54:38 INFO DAGScheduler: Got map stage job 3 (parquet at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 10:54:38 INFO DAGScheduler: Final stage: ShuffleMapStage 5 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 10:54:38 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 4)
23/03/10 10:54:38 INFO DAGScheduler: Missing parents: List()
23/03/10 10:54:38 INFO DAGScheduler: Submitting ShuffleMapStage 5 (MapPartitionsRDD[19] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 10:54:38 INFO MemoryStore: Block broadcast_6 stored as values in memory (estimated size 42.0 KiB, free 365.0 MiB)
23/03/10 10:54:38 INFO MemoryStore: Block broadcast_6_piece0 stored as bytes in memory (estimated size 19.9 KiB, free 365.0 MiB)
23/03/10 10:54:38 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on 172.27.188.152:40097 (size: 19.9 KiB, free: 366.1 MiB)
23/03/10 10:54:38 INFO SparkContext: Created broadcast 6 from broadcast at DAGScheduler.scala:1513
23/03/10 10:54:38 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 5 (MapPartitionsRDD[19] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 10:54:38 INFO TaskSchedulerImpl: Adding task set 5.0 with 1 tasks resource profile 0
23/03/10 10:54:38 INFO TaskSetManager: Starting task 0.0 in stage 5.0 (TID 4) (172.27.188.152, executor 0, partition 0, NODE_LOCAL, 4446 bytes) taskResourceAssignments Map()
23/03/10 10:54:38 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on 172.27.188.152:41411 (size: 19.9 KiB, free: 366.2 MiB)
23/03/10 10:54:38 INFO TaskSetManager: Finished task 0.0 in stage 5.0 (TID 4) in 135 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 10:54:38 INFO TaskSchedulerImpl: Removed TaskSet 5.0, whose tasks have all completed, from pool 
23/03/10 10:54:38 INFO DAGScheduler: ShuffleMapStage 5 (parquet at NativeMethodAccessorImpl.java:0) finished in 0.186 s
23/03/10 10:54:38 INFO DAGScheduler: looking for newly runnable stages
23/03/10 10:54:38 INFO DAGScheduler: running: Set()
23/03/10 10:54:38 INFO DAGScheduler: waiting: Set()
23/03/10 10:54:38 INFO DAGScheduler: failed: Set()
23/03/10 10:54:38 INFO ShufflePartitionsUtil: For shuffle(1), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
23/03/10 10:54:38 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
23/03/10 10:54:38 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
23/03/10 10:54:38 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
23/03/10 10:54:38 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
23/03/10 10:54:38 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
23/03/10 10:54:38 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
23/03/10 10:54:38 INFO CodeGenerator: Code generated in 13.752435 ms
23/03/10 10:54:38 INFO SparkContext: Starting job: parquet at NativeMethodAccessorImpl.java:0
23/03/10 10:54:38 INFO DAGScheduler: Got job 4 (parquet at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 10:54:38 INFO DAGScheduler: Final stage: ResultStage 8 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 10:54:38 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 7)
23/03/10 10:54:38 INFO DAGScheduler: Missing parents: List()
23/03/10 10:54:38 INFO DAGScheduler: Submitting ResultStage 8 (MapPartitionsRDD[21] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 10:54:38 INFO MemoryStore: Block broadcast_7 stored as values in memory (estimated size 240.2 KiB, free 364.7 MiB)
23/03/10 10:54:38 INFO MemoryStore: Block broadcast_7_piece0 stored as bytes in memory (estimated size 89.2 KiB, free 364.7 MiB)
23/03/10 10:54:38 INFO BlockManagerInfo: Added broadcast_7_piece0 in memory on 172.27.188.152:40097 (size: 89.2 KiB, free: 366.0 MiB)
23/03/10 10:54:38 INFO SparkContext: Created broadcast 7 from broadcast at DAGScheduler.scala:1513
23/03/10 10:54:38 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 8 (MapPartitionsRDD[21] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 10:54:38 INFO TaskSchedulerImpl: Adding task set 8.0 with 1 tasks resource profile 0
23/03/10 10:54:38 INFO TaskSetManager: Starting task 0.0 in stage 8.0 (TID 5) (172.27.188.152, executor 0, partition 0, NODE_LOCAL, 4457 bytes) taskResourceAssignments Map()
23/03/10 10:54:38 INFO BlockManagerInfo: Added broadcast_7_piece0 in memory on 172.27.188.152:41411 (size: 89.2 KiB, free: 366.1 MiB)
23/03/10 10:54:38 INFO MapOutputTrackerMasterEndpoint: Asked to send map output locations for shuffle 1 to 172.27.188.152:58688
23/03/10 10:54:39 INFO TaskSetManager: Finished task 0.0 in stage 8.0 (TID 5) in 1046 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 10:54:39 INFO TaskSchedulerImpl: Removed TaskSet 8.0, whose tasks have all completed, from pool 
23/03/10 10:54:39 INFO DAGScheduler: ResultStage 8 (parquet at NativeMethodAccessorImpl.java:0) finished in 1.083 s
23/03/10 10:54:39 INFO DAGScheduler: Job 4 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 10:54:39 INFO TaskSchedulerImpl: Killing all running tasks in stage 8: Stage finished
23/03/10 10:54:39 INFO DAGScheduler: Job 4 finished: parquet at NativeMethodAccessorImpl.java:0, took 1.105453 s
23/03/10 10:54:39 INFO FileFormatWriter: Start to commit write Job 604d0e33-df71-48d2-a660-229b7c6d487b.
23/03/10 10:54:39 INFO FileFormatWriter: Write Job 604d0e33-df71-48d2-a660-229b7c6d487b committed. Elapsed time: 76 ms.
23/03/10 10:54:39 INFO FileFormatWriter: Finished processing stats for write job 604d0e33-df71-48d2-a660-229b7c6d487b.
#######  Created Parquet File  #########
23/03/10 10:54:39 INFO InMemoryFileIndex: It took 3 ms to list leaf files for 1 paths.
23/03/10 10:54:39 INFO SparkContext: Starting job: parquet at NativeMethodAccessorImpl.java:0
23/03/10 10:54:39 INFO DAGScheduler: Got job 5 (parquet at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 10:54:39 INFO DAGScheduler: Final stage: ResultStage 9 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 10:54:39 INFO DAGScheduler: Parents of final stage: List()
23/03/10 10:54:39 INFO DAGScheduler: Missing parents: List()
23/03/10 10:54:39 INFO DAGScheduler: Submitting ResultStage 9 (MapPartitionsRDD[23] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 10:54:39 INFO MemoryStore: Block broadcast_8 stored as values in memory (estimated size 104.4 KiB, free 364.5 MiB)
23/03/10 10:54:39 INFO MemoryStore: Block broadcast_8_piece0 stored as bytes in memory (estimated size 37.6 KiB, free 364.5 MiB)
23/03/10 10:54:39 INFO BlockManagerInfo: Added broadcast_8_piece0 in memory on 172.27.188.152:40097 (size: 37.6 KiB, free: 366.0 MiB)
23/03/10 10:54:39 INFO SparkContext: Created broadcast 8 from broadcast at DAGScheduler.scala:1513
23/03/10 10:54:39 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 9 (MapPartitionsRDD[23] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 10:54:39 INFO TaskSchedulerImpl: Adding task set 9.0 with 1 tasks resource profile 0
23/03/10 10:54:39 INFO TaskSetManager: Starting task 0.0 in stage 9.0 (TID 6) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 4649 bytes) taskResourceAssignments Map()
23/03/10 10:54:39 INFO BlockManagerInfo: Removed broadcast_7_piece0 on 172.27.188.152:40097 in memory (size: 89.2 KiB, free: 366.1 MiB)
23/03/10 10:54:39 INFO BlockManagerInfo: Added broadcast_8_piece0 in memory on 172.27.188.152:41411 (size: 37.6 KiB, free: 366.0 MiB)
23/03/10 10:54:39 INFO BlockManagerInfo: Removed broadcast_7_piece0 on 172.27.188.152:41411 in memory (size: 89.2 KiB, free: 366.1 MiB)
23/03/10 10:54:39 INFO BlockManagerInfo: Removed broadcast_4_piece0 on 172.27.188.152:41411 in memory (size: 18.2 KiB, free: 366.2 MiB)
23/03/10 10:54:39 INFO BlockManagerInfo: Removed broadcast_4_piece0 on 172.27.188.152:40097 in memory (size: 18.2 KiB, free: 366.1 MiB)
23/03/10 10:54:39 INFO BlockManagerInfo: Removed broadcast_3_piece0 on 172.27.188.152:40097 in memory (size: 34.8 KiB, free: 366.2 MiB)
23/03/10 10:54:40 INFO BlockManagerInfo: Removed broadcast_3_piece0 on 172.27.188.152:41411 in memory (size: 34.8 KiB, free: 366.2 MiB)
23/03/10 10:54:40 INFO BlockManagerInfo: Removed broadcast_6_piece0 on 172.27.188.152:41411 in memory (size: 19.9 KiB, free: 366.2 MiB)
23/03/10 10:54:40 INFO BlockManagerInfo: Removed broadcast_6_piece0 on 172.27.188.152:40097 in memory (size: 19.9 KiB, free: 366.2 MiB)
23/03/10 10:54:40 INFO BlockManagerInfo: Removed broadcast_5_piece0 on 172.27.188.152:40097 in memory (size: 19.2 KiB, free: 366.2 MiB)
23/03/10 10:54:40 INFO TaskSetManager: Finished task 0.0 in stage 9.0 (TID 6) in 394 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 10:54:40 INFO BlockManagerInfo: Removed broadcast_5_piece0 on 172.27.188.152:41411 in memory (size: 19.2 KiB, free: 366.2 MiB)
23/03/10 10:54:40 INFO DAGScheduler: ResultStage 9 (parquet at NativeMethodAccessorImpl.java:0) finished in 0.466 s
23/03/10 10:54:40 INFO DAGScheduler: Job 5 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 10:54:40 INFO TaskSchedulerImpl: Removed TaskSet 9.0, whose tasks have all completed, from pool 
23/03/10 10:54:40 INFO TaskSchedulerImpl: Killing all running tasks in stage 9: Stage finished
23/03/10 10:54:40 INFO DAGScheduler: Job 5 finished: parquet at NativeMethodAccessorImpl.java:0, took 0.505715 s
##########   Parquet File Output    ########################
23/03/10 10:54:40 INFO BlockManagerInfo: Removed broadcast_1_piece0 on 172.27.188.152:40097 in memory (size: 5.9 KiB, free: 366.2 MiB)
23/03/10 10:54:40 INFO BlockManagerInfo: Removed broadcast_1_piece0 on 172.27.188.152:41411 in memory (size: 5.9 KiB, free: 366.2 MiB)
23/03/10 10:54:40 INFO BlockManagerInfo: Removed broadcast_0_piece0 on 172.27.188.152:41411 in memory (size: 34.8 KiB, free: 366.3 MiB)
23/03/10 10:54:40 INFO BlockManagerInfo: Removed broadcast_0_piece0 on 172.27.188.152:40097 in memory (size: 34.8 KiB, free: 366.2 MiB)
23/03/10 10:54:40 INFO FileSourceStrategy: Pushed Filters: 
23/03/10 10:54:40 INFO FileSourceStrategy: Post-Scan Filters: 
23/03/10 10:54:40 INFO FileSourceStrategy: Output Data Schema: struct<age: string, count: bigint>
23/03/10 10:54:40 INFO CodeGenerator: Code generated in 27.541127 ms
23/03/10 10:54:40 INFO MemoryStore: Block broadcast_9 stored as values in memory (estimated size 357.5 KiB, free 365.4 MiB)
23/03/10 10:54:40 INFO MemoryStore: Block broadcast_9_piece0 stored as bytes in memory (estimated size 35.4 KiB, free 365.4 MiB)
23/03/10 10:54:40 INFO BlockManagerInfo: Added broadcast_9_piece0 in memory on 172.27.188.152:40097 (size: 35.4 KiB, free: 366.2 MiB)
23/03/10 10:54:40 INFO SparkContext: Created broadcast 9 from showString at NativeMethodAccessorImpl.java:0
23/03/10 10:54:40 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 10:54:40 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
23/03/10 10:54:40 INFO DAGScheduler: Got job 6 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 10:54:40 INFO DAGScheduler: Final stage: ResultStage 10 (showString at NativeMethodAccessorImpl.java:0)
23/03/10 10:54:40 INFO DAGScheduler: Parents of final stage: List()
23/03/10 10:54:40 INFO DAGScheduler: Missing parents: List()
23/03/10 10:54:40 INFO DAGScheduler: Submitting ResultStage 10 (MapPartitionsRDD[27] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 10:54:40 INFO MemoryStore: Block broadcast_10 stored as values in memory (estimated size 13.6 KiB, free 365.4 MiB)
23/03/10 10:54:40 INFO MemoryStore: Block broadcast_10_piece0 stored as bytes in memory (estimated size 6.1 KiB, free 365.4 MiB)
23/03/10 10:54:40 INFO BlockManagerInfo: Added broadcast_10_piece0 in memory on 172.27.188.152:40097 (size: 6.1 KiB, free: 366.2 MiB)
23/03/10 10:54:40 INFO SparkContext: Created broadcast 10 from broadcast at DAGScheduler.scala:1513
23/03/10 10:54:40 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 10 (MapPartitionsRDD[27] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 10:54:40 INFO TaskSchedulerImpl: Adding task set 10.0 with 1 tasks resource profile 0
23/03/10 10:54:40 INFO TaskSetManager: Starting task 0.0 in stage 10.0 (TID 7) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 4974 bytes) taskResourceAssignments Map()
23/03/10 10:54:40 INFO BlockManagerInfo: Added broadcast_10_piece0 in memory on 172.27.188.152:41411 (size: 6.1 KiB, free: 366.3 MiB)
23/03/10 10:54:40 INFO BlockManagerInfo: Added broadcast_9_piece0 in memory on 172.27.188.152:41411 (size: 35.4 KiB, free: 366.2 MiB)
23/03/10 10:54:40 INFO TaskSetManager: Finished task 0.0 in stage 10.0 (TID 7) in 264 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 10:54:40 INFO TaskSchedulerImpl: Removed TaskSet 10.0, whose tasks have all completed, from pool 
23/03/10 10:54:40 INFO DAGScheduler: ResultStage 10 (showString at NativeMethodAccessorImpl.java:0) finished in 0.299 s
23/03/10 10:54:40 INFO DAGScheduler: Job 6 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 10:54:40 INFO TaskSchedulerImpl: Killing all running tasks in stage 10: Stage finished
23/03/10 10:54:40 INFO DAGScheduler: Job 6 finished: showString at NativeMethodAccessorImpl.java:0, took 0.313003 s
23/03/10 10:54:40 INFO CodeGenerator: Code generated in 13.096436 ms
+---+-----+
|age|count|
+---+-----+
| 32|  221|
| 30|  217|
| 33|  210|
| 35|  209|
| 31|  206|
| 34|  198|
| 36|  195|
| 29|  171|
| 37|  170|
| 28|  162|
| 38|  144|
| 39|  143|
| 27|  141|
| 26|  134|
| 41|  120|
| 46|  118|
| 40|  116|
| 47|  113|
| 25|  113|
| 42|  111|
+---+-----+
only showing top 20 rows

None
23/03/10 10:54:41 INFO FileSourceStrategy: Pushed Filters: IsNotNull(y),EqualTo(y,yes)
23/03/10 10:54:41 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(y#33),(y#33 = yes)
23/03/10 10:54:41 INFO FileSourceStrategy: Output Data Schema: struct<age: string, y: string>
23/03/10 10:54:41 INFO deprecation: mapred.output.compress is deprecated. Instead, use mapreduce.output.fileoutputformat.compress
23/03/10 10:54:41 INFO AvroUtils: Compressing Avro output using the snappy codec
23/03/10 10:54:41 INFO CodeGenerator: Code generated in 47.735307 ms
23/03/10 10:54:41 INFO CodeGenerator: Code generated in 10.071148 ms
23/03/10 10:54:41 INFO MemoryStore: Block broadcast_11 stored as values in memory (estimated size 353.2 KiB, free 365.0 MiB)
23/03/10 10:54:41 INFO MemoryStore: Block broadcast_11_piece0 stored as bytes in memory (estimated size 34.8 KiB, free 365.0 MiB)
23/03/10 10:54:41 INFO BlockManagerInfo: Added broadcast_11_piece0 in memory on 172.27.188.152:40097 (size: 34.8 KiB, free: 366.2 MiB)
23/03/10 10:54:41 INFO SparkContext: Created broadcast 11 from save at NativeMethodAccessorImpl.java:0
23/03/10 10:54:41 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 10:54:41 INFO DAGScheduler: Registering RDD 34 (save at NativeMethodAccessorImpl.java:0) as input to shuffle 2
23/03/10 10:54:41 INFO DAGScheduler: Got map stage job 7 (save at NativeMethodAccessorImpl.java:0) with 2 output partitions
23/03/10 10:54:41 INFO DAGScheduler: Final stage: ShuffleMapStage 11 (save at NativeMethodAccessorImpl.java:0)
23/03/10 10:54:41 INFO DAGScheduler: Parents of final stage: List()
23/03/10 10:54:41 INFO DAGScheduler: Missing parents: List()
23/03/10 10:54:41 INFO DAGScheduler: Submitting ShuffleMapStage 11 (MapPartitionsRDD[34] at save at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 10:54:41 INFO MemoryStore: Block broadcast_12 stored as values in memory (estimated size 46.0 KiB, free 365.0 MiB)
23/03/10 10:54:41 INFO MemoryStore: Block broadcast_12_piece0 stored as bytes in memory (estimated size 21.8 KiB, free 364.9 MiB)
23/03/10 10:54:41 INFO BlockManagerInfo: Added broadcast_12_piece0 in memory on 172.27.188.152:40097 (size: 21.8 KiB, free: 366.1 MiB)
23/03/10 10:54:41 INFO SparkContext: Created broadcast 12 from broadcast at DAGScheduler.scala:1513
23/03/10 10:54:41 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 11 (MapPartitionsRDD[34] at save at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
23/03/10 10:54:41 INFO TaskSchedulerImpl: Adding task set 11.0 with 2 tasks resource profile 0
23/03/10 10:54:41 INFO TaskSetManager: Starting task 0.0 in stage 11.0 (TID 8) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 4974 bytes) taskResourceAssignments Map()
23/03/10 10:54:41 INFO TaskSetManager: Starting task 1.0 in stage 11.0 (TID 9) (172.27.188.152, executor 0, partition 1, PROCESS_LOCAL, 4974 bytes) taskResourceAssignments Map()
23/03/10 10:54:41 INFO BlockManagerInfo: Added broadcast_12_piece0 in memory on 172.27.188.152:41411 (size: 21.8 KiB, free: 366.2 MiB)
23/03/10 10:54:42 INFO BlockManagerInfo: Added broadcast_11_piece0 in memory on 172.27.188.152:41411 (size: 34.8 KiB, free: 366.2 MiB)
23/03/10 10:54:52 INFO TaskSetManager: Finished task 1.0 in stage 11.0 (TID 9) in 11099 ms on 172.27.188.152 (executor 0) (1/2)
23/03/10 10:54:52 INFO PythonAccumulatorV2: Connected to AccumulatorServer at host: 127.0.0.1 port: 49659
23/03/10 10:54:52 INFO TaskSetManager: Finished task 0.0 in stage 11.0 (TID 8) in 11133 ms on 172.27.188.152 (executor 0) (2/2)
23/03/10 10:54:52 INFO TaskSchedulerImpl: Removed TaskSet 11.0, whose tasks have all completed, from pool 
23/03/10 10:54:52 INFO DAGScheduler: ShuffleMapStage 11 (save at NativeMethodAccessorImpl.java:0) finished in 11.155 s
23/03/10 10:54:52 INFO DAGScheduler: looking for newly runnable stages
23/03/10 10:54:52 INFO DAGScheduler: running: Set()
23/03/10 10:54:52 INFO DAGScheduler: waiting: Set()
23/03/10 10:54:52 INFO DAGScheduler: failed: Set()
23/03/10 10:54:52 INFO ShufflePartitionsUtil: For shuffle(2), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
23/03/10 10:54:52 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
23/03/10 10:54:52 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
23/03/10 10:54:52 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter
23/03/10 10:54:52 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
23/03/10 10:54:52 INFO CodeGenerator: Code generated in 23.833295 ms
23/03/10 10:54:52 INFO SparkContext: Starting job: save at NativeMethodAccessorImpl.java:0
23/03/10 10:54:52 INFO DAGScheduler: Got job 8 (save at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 10:54:52 INFO DAGScheduler: Final stage: ResultStage 13 (save at NativeMethodAccessorImpl.java:0)
23/03/10 10:54:52 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 12)
23/03/10 10:54:52 INFO DAGScheduler: Missing parents: List()
23/03/10 10:54:52 INFO DAGScheduler: Submitting ResultStage 13 (MapPartitionsRDD[36] at save at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 10:54:52 INFO MemoryStore: Block broadcast_13 stored as values in memory (estimated size 245.3 KiB, free 364.7 MiB)
23/03/10 10:54:52 INFO MemoryStore: Block broadcast_13_piece0 stored as bytes in memory (estimated size 91.8 KiB, free 364.6 MiB)
23/03/10 10:54:52 INFO BlockManagerInfo: Added broadcast_13_piece0 in memory on 172.27.188.152:40097 (size: 91.8 KiB, free: 366.0 MiB)
23/03/10 10:54:52 INFO SparkContext: Created broadcast 13 from broadcast at DAGScheduler.scala:1513
23/03/10 10:54:52 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 13 (MapPartitionsRDD[36] at save at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 10:54:52 INFO TaskSchedulerImpl: Adding task set 13.0 with 1 tasks resource profile 0
23/03/10 10:54:52 INFO TaskSetManager: Starting task 0.0 in stage 13.0 (TID 10) (172.27.188.152, executor 0, partition 0, NODE_LOCAL, 4457 bytes) taskResourceAssignments Map()
23/03/10 10:54:52 INFO BlockManagerInfo: Added broadcast_13_piece0 in memory on 172.27.188.152:41411 (size: 91.8 KiB, free: 366.1 MiB)
23/03/10 10:54:52 INFO MapOutputTrackerMasterEndpoint: Asked to send map output locations for shuffle 2 to 172.27.188.152:58688
23/03/10 10:54:53 INFO TaskSetManager: Finished task 0.0 in stage 13.0 (TID 10) in 370 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 10:54:53 INFO TaskSchedulerImpl: Removed TaskSet 13.0, whose tasks have all completed, from pool 
23/03/10 10:54:53 INFO DAGScheduler: ResultStage 13 (save at NativeMethodAccessorImpl.java:0) finished in 0.404 s
23/03/10 10:54:53 INFO DAGScheduler: Job 8 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 10:54:53 INFO TaskSchedulerImpl: Killing all running tasks in stage 13: Stage finished
23/03/10 10:54:53 INFO DAGScheduler: Job 8 finished: save at NativeMethodAccessorImpl.java:0, took 0.419444 s
23/03/10 10:54:53 INFO FileFormatWriter: Start to commit write Job 6a0cf580-6dad-470b-a3a7-8d184e563d2c.
23/03/10 10:54:53 INFO FileFormatWriter: Write Job 6a0cf580-6dad-470b-a3a7-8d184e563d2c committed. Elapsed time: 19 ms.
23/03/10 10:54:53 INFO FileFormatWriter: Finished processing stats for write job 6a0cf580-6dad-470b-a3a7-8d184e563d2c.
#######  Created Avro File  #########
23/03/10 10:54:53 INFO InMemoryFileIndex: It took 1 ms to list leaf files for 1 paths.
##########   Avro File Output    ########################
23/03/10 10:54:53 INFO FileSourceStrategy: Pushed Filters: 
23/03/10 10:54:53 INFO FileSourceStrategy: Post-Scan Filters: 
23/03/10 10:54:53 INFO FileSourceStrategy: Output Data Schema: struct<age_cat: string, count: bigint>
23/03/10 10:54:53 INFO CodeGenerator: Code generated in 19.934851 ms
23/03/10 10:54:53 INFO MemoryStore: Block broadcast_14 stored as values in memory (estimated size 352.9 KiB, free 364.3 MiB)
23/03/10 10:54:53 INFO MemoryStore: Block broadcast_14_piece0 stored as bytes in memory (estimated size 34.8 KiB, free 364.2 MiB)
23/03/10 10:54:53 INFO BlockManagerInfo: Added broadcast_14_piece0 in memory on 172.27.188.152:40097 (size: 34.8 KiB, free: 366.0 MiB)
23/03/10 10:54:53 INFO SparkContext: Created broadcast 14 from showString at NativeMethodAccessorImpl.java:0
23/03/10 10:54:53 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 10:54:54 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
23/03/10 10:54:54 INFO DAGScheduler: Got job 9 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 10:54:54 INFO DAGScheduler: Final stage: ResultStage 14 (showString at NativeMethodAccessorImpl.java:0)
23/03/10 10:54:54 INFO DAGScheduler: Parents of final stage: List()
23/03/10 10:54:54 INFO DAGScheduler: Missing parents: List()
23/03/10 10:54:54 INFO DAGScheduler: Submitting ResultStage 14 (MapPartitionsRDD[40] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 10:54:56 INFO MemoryStore: Block broadcast_15 stored as values in memory (estimated size 12.0 KiB, free 364.2 MiB)
23/03/10 10:54:56 INFO MemoryStore: Block broadcast_15_piece0 stored as bytes in memory (estimated size 6.0 KiB, free 364.2 MiB)
23/03/10 10:54:56 INFO BlockManagerInfo: Added broadcast_15_piece0 in memory on 172.27.188.152:40097 (size: 6.0 KiB, free: 366.0 MiB)
23/03/10 10:54:56 INFO SparkContext: Created broadcast 15 from broadcast at DAGScheduler.scala:1513
23/03/10 10:54:56 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 14 (MapPartitionsRDD[40] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 10:54:56 INFO TaskSchedulerImpl: Adding task set 14.0 with 1 tasks resource profile 0
23/03/10 10:54:56 INFO TaskSetManager: Starting task 0.0 in stage 14.0 (TID 11) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 4961 bytes) taskResourceAssignments Map()
23/03/10 10:54:56 INFO BlockManagerInfo: Added broadcast_15_piece0 in memory on 172.27.188.152:41411 (size: 6.0 KiB, free: 366.1 MiB)
23/03/10 10:54:57 INFO BlockManagerInfo: Added broadcast_14_piece0 in memory on 172.27.188.152:41411 (size: 34.8 KiB, free: 366.0 MiB)
23/03/10 10:54:58 INFO TaskSetManager: Finished task 0.0 in stage 14.0 (TID 11) in 2210 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 10:54:58 INFO TaskSchedulerImpl: Removed TaskSet 14.0, whose tasks have all completed, from pool 
23/03/10 10:54:58 INFO DAGScheduler: ResultStage 14 (showString at NativeMethodAccessorImpl.java:0) finished in 4.402 s
23/03/10 10:54:58 INFO DAGScheduler: Job 9 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 10:54:58 INFO TaskSchedulerImpl: Killing all running tasks in stage 14: Stage finished
23/03/10 10:54:58 INFO DAGScheduler: Job 9 finished: showString at NativeMethodAccessorImpl.java:0, took 4.603978 s
+-------+-----+
|age_cat|count|
+-------+-----+
|  Young| 2924|
+-------+-----+

None
23/03/10 10:54:58 INFO SparkContext: Invoking stop() from shutdown hook
23/03/10 10:54:59 INFO SparkUI: Stopped Spark web UI at http://172.27.188.152:4040
23/03/10 10:54:59 INFO StandaloneSchedulerBackend: Shutting down all executors
23/03/10 10:54:59 INFO CoarseGrainedSchedulerBackend$DriverEndpoint: Asking each executor to shut down
23/03/10 10:54:59 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
23/03/10 10:54:59 INFO MemoryStore: MemoryStore cleared
23/03/10 10:54:59 INFO BlockManager: BlockManager stopped
23/03/10 10:54:59 INFO BlockManagerMaster: BlockManagerMaster stopped
23/03/10 10:54:59 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
23/03/10 10:54:59 INFO SparkContext: Successfully stopped SparkContext
23/03/10 10:54:59 INFO ShutdownHookManager: Shutdown hook called
23/03/10 10:54:59 INFO ShutdownHookManager: Deleting directory /tmp/spark-bdb88ca9-0a98-4341-8d48-9e6c4c8a010a
23/03/10 10:54:59 INFO ShutdownHookManager: Deleting directory /tmp/spark-1508eab9-5132-4792-8840-d57a37662f7f/pyspark-16b073f2-39f8-4a48-b579-43d0b2db6e9c
23/03/10 10:54:59 INFO ShutdownHookManager: Deleting directory /tmp/spark-1508eab9-5132-4792-8840-d57a37662f7f
##### Finished Executor #####
============================================
Fri Mar 10 05:25:00 UTC 2023
##### Started Executor #####
23/03/10 10:55:05 WARN Utils: Your hostname, MILES-BL-4819-LAP resolves to a loopback address: 127.0.1.1; using 172.27.188.152 instead (on interface eth0)
23/03/10 10:55:05 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
:: loading settings :: url = jar:file:/opt/spark/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml
Ivy Default Cache set to: /home/shashi/.ivy2/cache
The jars for the packages stored in: /home/shashi/.ivy2/jars
org.apache.spark#spark-avro_2.12 added as a dependency
:: resolving dependencies :: org.apache.spark#spark-submit-parent-88b71c08-5f9e-4a66-bb13-f113959bdc04;1.0
	confs: [default]
	found org.apache.spark#spark-avro_2.12;3.3.2 in central
	found org.tukaani#xz;1.9 in central
	found org.spark-project.spark#unused;1.0.0 in central
:: resolution report :: resolve 447ms :: artifacts dl 11ms
	:: modules in use:
	org.apache.spark#spark-avro_2.12;3.3.2 from central in [default]
	org.spark-project.spark#unused;1.0.0 from central in [default]
	org.tukaani#xz;1.9 from central in [default]
	---------------------------------------------------------------------
	|                  |            modules            ||   artifacts   |
	|       conf       | number| search|dwnlded|evicted|| number|dwnlded|
	---------------------------------------------------------------------
	|      default     |   3   |   0   |   0   |   0   ||   3   |   0   |
	---------------------------------------------------------------------
:: retrieving :: org.apache.spark#spark-submit-parent-88b71c08-5f9e-4a66-bb13-f113959bdc04
	confs: [default]
	0 artifacts copied, 3 already retrieved (0kB/12ms)
23/03/10 10:55:08 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
23/03/10 10:55:09 INFO SparkContext: Running Spark version 3.3.2
23/03/10 10:55:09 INFO ResourceUtils: ==============================================================
23/03/10 10:55:09 INFO ResourceUtils: No custom resources configured for spark.driver.
23/03/10 10:55:09 INFO ResourceUtils: ==============================================================
23/03/10 10:55:09 INFO SparkContext: Submitted application: Bank Market
23/03/10 10:55:09 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
23/03/10 10:55:09 INFO ResourceProfile: Limiting resource is cpu
23/03/10 10:55:09 INFO ResourceProfileManager: Added ResourceProfile id: 0
23/03/10 10:55:09 INFO SecurityManager: Changing view acls to: shashi
23/03/10 10:55:09 INFO SecurityManager: Changing modify acls to: shashi
23/03/10 10:55:09 INFO SecurityManager: Changing view acls groups to: 
23/03/10 10:55:09 INFO SecurityManager: Changing modify acls groups to: 
23/03/10 10:55:09 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(shashi); groups with view permissions: Set(); users  with modify permissions: Set(shashi); groups with modify permissions: Set()
23/03/10 10:55:14 INFO Utils: Successfully started service 'sparkDriver' on port 43339.
23/03/10 10:55:14 INFO SparkEnv: Registering MapOutputTracker
23/03/10 10:55:14 INFO SparkEnv: Registering BlockManagerMaster
23/03/10 10:55:14 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
23/03/10 10:55:14 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
23/03/10 10:55:14 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
23/03/10 10:55:14 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-7606aba6-7776-4777-a646-5fbb17a850b7
23/03/10 10:55:14 INFO MemoryStore: MemoryStore started with capacity 366.3 MiB
23/03/10 10:55:14 INFO SparkEnv: Registering OutputCommitCoordinator
23/03/10 10:55:16 INFO Utils: Successfully started service 'SparkUI' on port 4040.
23/03/10 10:55:16 INFO SparkContext: Added JAR file:///home/shashi/.ivy2/jars/org.apache.spark_spark-avro_2.12-3.3.2.jar at spark://172.27.188.152:43339/jars/org.apache.spark_spark-avro_2.12-3.3.2.jar with timestamp 1678425909312
23/03/10 10:55:16 INFO SparkContext: Added JAR file:///home/shashi/.ivy2/jars/org.tukaani_xz-1.9.jar at spark://172.27.188.152:43339/jars/org.tukaani_xz-1.9.jar with timestamp 1678425909312
23/03/10 10:55:16 INFO SparkContext: Added JAR file:///home/shashi/.ivy2/jars/org.spark-project.spark_unused-1.0.0.jar at spark://172.27.188.152:43339/jars/org.spark-project.spark_unused-1.0.0.jar with timestamp 1678425909312
23/03/10 10:55:16 INFO SparkContext: Added file file:///home/shashi/.ivy2/jars/org.apache.spark_spark-avro_2.12-3.3.2.jar at spark://172.27.188.152:43339/files/org.apache.spark_spark-avro_2.12-3.3.2.jar with timestamp 1678425909312
23/03/10 10:55:16 INFO Utils: Copying /home/shashi/.ivy2/jars/org.apache.spark_spark-avro_2.12-3.3.2.jar to /tmp/spark-6ad655a0-4c77-4d2d-b3f5-90a2ffb9a8b4/userFiles-ecda822e-6a25-4fd6-ab2a-ccf38aa480ce/org.apache.spark_spark-avro_2.12-3.3.2.jar
23/03/10 10:55:16 INFO SparkContext: Added file file:///home/shashi/.ivy2/jars/org.tukaani_xz-1.9.jar at spark://172.27.188.152:43339/files/org.tukaani_xz-1.9.jar with timestamp 1678425909312
23/03/10 10:55:16 INFO Utils: Copying /home/shashi/.ivy2/jars/org.tukaani_xz-1.9.jar to /tmp/spark-6ad655a0-4c77-4d2d-b3f5-90a2ffb9a8b4/userFiles-ecda822e-6a25-4fd6-ab2a-ccf38aa480ce/org.tukaani_xz-1.9.jar
23/03/10 10:55:16 INFO SparkContext: Added file file:///home/shashi/.ivy2/jars/org.spark-project.spark_unused-1.0.0.jar at spark://172.27.188.152:43339/files/org.spark-project.spark_unused-1.0.0.jar with timestamp 1678425909312
23/03/10 10:55:16 INFO Utils: Copying /home/shashi/.ivy2/jars/org.spark-project.spark_unused-1.0.0.jar to /tmp/spark-6ad655a0-4c77-4d2d-b3f5-90a2ffb9a8b4/userFiles-ecda822e-6a25-4fd6-ab2a-ccf38aa480ce/org.spark-project.spark_unused-1.0.0.jar
23/03/10 10:55:16 INFO StandaloneAppClient$ClientEndpoint: Connecting to master spark://MILES-BL-4819-LAP.:7077...
23/03/10 10:55:16 INFO TransportClientFactory: Successfully created connection to MILES-BL-4819-LAP./127.0.1.1:7077 after 62 ms (0 ms spent in bootstraps)
23/03/10 10:55:16 INFO StandaloneSchedulerBackend: Connected to Spark cluster with app ID app-20230310105516-0003
23/03/10 10:55:16 INFO StandaloneAppClient$ClientEndpoint: Executor added: app-20230310105516-0003/0 on worker-20230309123128-172.27.188.152-45151 (172.27.188.152:45151) with 8 core(s)
23/03/10 10:55:16 INFO StandaloneSchedulerBackend: Granted executor ID app-20230310105516-0003/0 on hostPort 172.27.188.152:45151 with 8 core(s), 1024.0 MiB RAM
23/03/10 10:55:16 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 38061.
23/03/10 10:55:16 INFO NettyBlockTransferService: Server created on 172.27.188.152:38061
23/03/10 10:55:16 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
23/03/10 10:55:16 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, 172.27.188.152, 38061, None)
23/03/10 10:55:16 INFO BlockManagerMasterEndpoint: Registering block manager 172.27.188.152:38061 with 366.3 MiB RAM, BlockManagerId(driver, 172.27.188.152, 38061, None)
23/03/10 10:55:16 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, 172.27.188.152, 38061, None)
23/03/10 10:55:16 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, 172.27.188.152, 38061, None)
23/03/10 10:55:16 INFO StandaloneAppClient$ClientEndpoint: Executor updated: app-20230310105516-0003/0 is now RUNNING
23/03/10 10:55:17 INFO SingleEventLogFileWriter: Logging events to file:/tmp/spark-events/app-20230310105516-0003.inprogress
23/03/10 10:55:17 INFO StandaloneSchedulerBackend: SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio: 0.0
23/03/10 10:55:17 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
23/03/10 10:55:17 INFO SharedState: Warehouse path is 'file:/home/shashi/spark-warehouse'.
23/03/10 10:55:19 INFO InMemoryFileIndex: It took 114 ms to list leaf files for 1 paths.
23/03/10 10:55:19 INFO InMemoryFileIndex: It took 67 ms to list leaf files for 1 paths.
23/03/10 10:55:21 INFO CoarseGrainedSchedulerBackend$DriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (172.27.188.152:44664) with ID 0,  ResourceProfileId 0
23/03/10 10:55:21 INFO BlockManagerMasterEndpoint: Registering block manager 172.27.188.152:46737 with 366.3 MiB RAM, BlockManagerId(0, 172.27.188.152, 46737, None)
23/03/10 10:55:23 INFO FileSourceStrategy: Pushed Filters: 
23/03/10 10:55:23 INFO FileSourceStrategy: Post-Scan Filters: (length(trim(value#0, None)) > 0)
23/03/10 10:55:23 INFO FileSourceStrategy: Output Data Schema: struct<value: string>
23/03/10 10:55:24 INFO CodeGenerator: Code generated in 245.246289 ms
23/03/10 10:55:24 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 353.3 KiB, free 366.0 MiB)
23/03/10 10:55:24 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 34.8 KiB, free 365.9 MiB)
23/03/10 10:55:24 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 172.27.188.152:38061 (size: 34.8 KiB, free: 366.3 MiB)
23/03/10 10:55:24 INFO SparkContext: Created broadcast 0 from load at NativeMethodAccessorImpl.java:0
23/03/10 10:55:24 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 10:55:24 INFO SparkContext: Starting job: load at NativeMethodAccessorImpl.java:0
23/03/10 10:55:24 INFO DAGScheduler: Got job 0 (load at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 10:55:24 INFO DAGScheduler: Final stage: ResultStage 0 (load at NativeMethodAccessorImpl.java:0)
23/03/10 10:55:24 INFO DAGScheduler: Parents of final stage: List()
23/03/10 10:55:24 INFO DAGScheduler: Missing parents: List()
23/03/10 10:55:24 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at load at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 10:55:24 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 11.9 KiB, free 365.9 MiB)
23/03/10 10:55:24 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 5.9 KiB, free 365.9 MiB)
23/03/10 10:55:24 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on 172.27.188.152:38061 (size: 5.9 KiB, free: 366.3 MiB)
23/03/10 10:55:24 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1513
23/03/10 10:55:24 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at load at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 10:55:24 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
23/03/10 10:55:24 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 4985 bytes) taskResourceAssignments Map()
23/03/10 10:55:25 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on 172.27.188.152:46737 (size: 5.9 KiB, free: 366.3 MiB)
23/03/10 10:55:26 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 172.27.188.152:46737 (size: 34.8 KiB, free: 366.3 MiB)
23/03/10 10:55:26 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 2073 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 10:55:26 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool 
23/03/10 10:55:26 INFO DAGScheduler: ResultStage 0 (load at NativeMethodAccessorImpl.java:0) finished in 2.261 s
23/03/10 10:55:26 INFO DAGScheduler: Job 0 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 10:55:26 INFO TaskSchedulerImpl: Killing all running tasks in stage 0: Stage finished
23/03/10 10:55:26 INFO DAGScheduler: Job 0 finished: load at NativeMethodAccessorImpl.java:0, took 2.354311 s
23/03/10 10:55:26 INFO CodeGenerator: Code generated in 17.470757 ms
23/03/10 10:55:27 INFO FileSourceStrategy: Pushed Filters: 
23/03/10 10:55:27 INFO FileSourceStrategy: Post-Scan Filters: 
23/03/10 10:55:27 INFO FileSourceStrategy: Output Data Schema: struct<value: string>
23/03/10 10:55:27 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 353.3 KiB, free 365.6 MiB)
23/03/10 10:55:27 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 34.8 KiB, free 365.5 MiB)
23/03/10 10:55:27 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on 172.27.188.152:38061 (size: 34.8 KiB, free: 366.2 MiB)
23/03/10 10:55:27 INFO SparkContext: Created broadcast 2 from load at NativeMethodAccessorImpl.java:0
23/03/10 10:55:27 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 10:55:27 INFO FileSourceStrategy: Pushed Filters: IsNotNull(y),EqualTo(y,yes)
23/03/10 10:55:27 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(y#33),(y#33 = yes)
23/03/10 10:55:27 INFO FileSourceStrategy: Output Data Schema: struct<age: string, y: string>
23/03/10 10:55:27 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
23/03/10 10:55:28 INFO CodeGenerator: Code generated in 87.941195 ms
23/03/10 10:55:28 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 353.2 KiB, free 365.2 MiB)
23/03/10 10:55:28 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 34.7 KiB, free 365.1 MiB)
23/03/10 10:55:28 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on 172.27.188.152:38061 (size: 34.7 KiB, free: 366.2 MiB)
23/03/10 10:55:28 INFO SparkContext: Created broadcast 3 from parquet at NativeMethodAccessorImpl.java:0
23/03/10 10:55:28 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 10:55:28 INFO BlockManagerInfo: Removed broadcast_1_piece0 on 172.27.188.152:38061 in memory (size: 5.9 KiB, free: 366.2 MiB)
23/03/10 10:55:28 INFO BlockManagerInfo: Removed broadcast_1_piece0 on 172.27.188.152:46737 in memory (size: 5.9 KiB, free: 366.3 MiB)
23/03/10 10:55:28 INFO BlockManagerInfo: Removed broadcast_0_piece0 on 172.27.188.152:38061 in memory (size: 34.8 KiB, free: 366.2 MiB)
23/03/10 10:55:28 INFO BlockManagerInfo: Removed broadcast_0_piece0 on 172.27.188.152:46737 in memory (size: 34.8 KiB, free: 366.3 MiB)
23/03/10 10:55:28 INFO DAGScheduler: Registering RDD 13 (parquet at NativeMethodAccessorImpl.java:0) as input to shuffle 0
23/03/10 10:55:28 INFO DAGScheduler: Got map stage job 1 (parquet at NativeMethodAccessorImpl.java:0) with 2 output partitions
23/03/10 10:55:28 INFO DAGScheduler: Final stage: ShuffleMapStage 1 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 10:55:28 INFO DAGScheduler: Parents of final stage: List()
23/03/10 10:55:28 INFO DAGScheduler: Missing parents: List()
23/03/10 10:55:28 INFO DAGScheduler: Submitting ShuffleMapStage 1 (MapPartitionsRDD[13] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 10:55:28 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 38.5 KiB, free 365.5 MiB)
23/03/10 10:55:28 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 18.2 KiB, free 365.5 MiB)
23/03/10 10:55:28 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on 172.27.188.152:38061 (size: 18.2 KiB, free: 366.2 MiB)
23/03/10 10:55:28 INFO SparkContext: Created broadcast 4 from broadcast at DAGScheduler.scala:1513
23/03/10 10:55:28 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 1 (MapPartitionsRDD[13] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
23/03/10 10:55:28 INFO TaskSchedulerImpl: Adding task set 1.0 with 2 tasks resource profile 0
23/03/10 10:55:28 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 1) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 4974 bytes) taskResourceAssignments Map()
23/03/10 10:55:28 INFO TaskSetManager: Starting task 1.0 in stage 1.0 (TID 2) (172.27.188.152, executor 0, partition 1, PROCESS_LOCAL, 4974 bytes) taskResourceAssignments Map()
23/03/10 10:55:28 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on 172.27.188.152:46737 (size: 18.2 KiB, free: 366.3 MiB)
23/03/10 10:55:28 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on 172.27.188.152:46737 (size: 34.7 KiB, free: 366.2 MiB)
23/03/10 10:55:29 INFO TaskSetManager: Finished task 1.0 in stage 1.0 (TID 2) in 1223 ms on 172.27.188.152 (executor 0) (1/2)
23/03/10 10:55:29 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 1) in 1335 ms on 172.27.188.152 (executor 0) (2/2)
23/03/10 10:55:29 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool 
23/03/10 10:55:29 INFO DAGScheduler: ShuffleMapStage 1 (parquet at NativeMethodAccessorImpl.java:0) finished in 1.379 s
23/03/10 10:55:29 INFO DAGScheduler: looking for newly runnable stages
23/03/10 10:55:29 INFO DAGScheduler: running: Set()
23/03/10 10:55:29 INFO DAGScheduler: waiting: Set()
23/03/10 10:55:29 INFO DAGScheduler: failed: Set()
23/03/10 10:55:29 INFO ShufflePartitionsUtil: For shuffle(0), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
23/03/10 10:55:29 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
23/03/10 10:55:29 INFO CodeGenerator: Code generated in 58.782671 ms
23/03/10 10:55:30 INFO CodeGenerator: Code generated in 35.949423 ms
23/03/10 10:55:30 INFO SparkContext: Starting job: parquet at NativeMethodAccessorImpl.java:0
23/03/10 10:55:30 INFO DAGScheduler: Got job 2 (parquet at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 10:55:30 INFO DAGScheduler: Final stage: ResultStage 3 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 10:55:30 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 2)
23/03/10 10:55:30 INFO DAGScheduler: Missing parents: List()
23/03/10 10:55:30 INFO DAGScheduler: Submitting ResultStage 3 (MapPartitionsRDD[18] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 10:55:30 INFO MemoryStore: Block broadcast_5 stored as values in memory (estimated size 40.0 KiB, free 365.4 MiB)
23/03/10 10:55:30 INFO MemoryStore: Block broadcast_5_piece0 stored as bytes in memory (estimated size 19.2 KiB, free 365.4 MiB)
23/03/10 10:55:30 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on 172.27.188.152:38061 (size: 19.2 KiB, free: 366.2 MiB)
23/03/10 10:55:30 INFO SparkContext: Created broadcast 5 from broadcast at DAGScheduler.scala:1513
23/03/10 10:55:30 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 3 (MapPartitionsRDD[18] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 10:55:30 INFO TaskSchedulerImpl: Adding task set 3.0 with 1 tasks resource profile 0
23/03/10 10:55:30 INFO TaskSetManager: Starting task 0.0 in stage 3.0 (TID 3) (172.27.188.152, executor 0, partition 0, NODE_LOCAL, 4457 bytes) taskResourceAssignments Map()
23/03/10 10:55:30 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on 172.27.188.152:46737 (size: 19.2 KiB, free: 366.2 MiB)
23/03/10 10:55:30 INFO MapOutputTrackerMasterEndpoint: Asked to send map output locations for shuffle 0 to 172.27.188.152:44664
23/03/10 10:55:30 INFO TaskSetManager: Finished task 0.0 in stage 3.0 (TID 3) in 398 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 10:55:30 INFO TaskSchedulerImpl: Removed TaskSet 3.0, whose tasks have all completed, from pool 
23/03/10 10:55:30 INFO DAGScheduler: ResultStage 3 (parquet at NativeMethodAccessorImpl.java:0) finished in 0.432 s
23/03/10 10:55:30 INFO DAGScheduler: Job 2 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 10:55:30 INFO TaskSchedulerImpl: Killing all running tasks in stage 3: Stage finished
23/03/10 10:55:30 INFO DAGScheduler: Job 2 finished: parquet at NativeMethodAccessorImpl.java:0, took 0.482955 s
23/03/10 10:55:30 INFO DAGScheduler: Registering RDD 19 (parquet at NativeMethodAccessorImpl.java:0) as input to shuffle 1
23/03/10 10:55:30 INFO DAGScheduler: Got map stage job 3 (parquet at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 10:55:30 INFO DAGScheduler: Final stage: ShuffleMapStage 5 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 10:55:30 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 4)
23/03/10 10:55:30 INFO DAGScheduler: Missing parents: List()
23/03/10 10:55:30 INFO DAGScheduler: Submitting ShuffleMapStage 5 (MapPartitionsRDD[19] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 10:55:30 INFO MemoryStore: Block broadcast_6 stored as values in memory (estimated size 42.0 KiB, free 365.4 MiB)
23/03/10 10:55:30 INFO MemoryStore: Block broadcast_6_piece0 stored as bytes in memory (estimated size 19.9 KiB, free 365.4 MiB)
23/03/10 10:55:30 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on 172.27.188.152:38061 (size: 19.9 KiB, free: 366.2 MiB)
23/03/10 10:55:30 INFO SparkContext: Created broadcast 6 from broadcast at DAGScheduler.scala:1513
23/03/10 10:55:30 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 5 (MapPartitionsRDD[19] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 10:55:30 INFO TaskSchedulerImpl: Adding task set 5.0 with 1 tasks resource profile 0
23/03/10 10:55:30 INFO TaskSetManager: Starting task 0.0 in stage 5.0 (TID 4) (172.27.188.152, executor 0, partition 0, NODE_LOCAL, 4446 bytes) taskResourceAssignments Map()
23/03/10 10:55:30 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on 172.27.188.152:46737 (size: 19.9 KiB, free: 366.2 MiB)
23/03/10 10:55:30 INFO TaskSetManager: Finished task 0.0 in stage 5.0 (TID 4) in 157 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 10:55:30 INFO TaskSchedulerImpl: Removed TaskSet 5.0, whose tasks have all completed, from pool 
23/03/10 10:55:30 INFO DAGScheduler: ShuffleMapStage 5 (parquet at NativeMethodAccessorImpl.java:0) finished in 0.201 s
23/03/10 10:55:30 INFO DAGScheduler: looking for newly runnable stages
23/03/10 10:55:30 INFO DAGScheduler: running: Set()
23/03/10 10:55:30 INFO DAGScheduler: waiting: Set()
23/03/10 10:55:30 INFO DAGScheduler: failed: Set()
23/03/10 10:55:30 INFO ShufflePartitionsUtil: For shuffle(1), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
23/03/10 10:55:30 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
23/03/10 10:55:30 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
23/03/10 10:55:30 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
23/03/10 10:55:30 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
23/03/10 10:55:30 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
23/03/10 10:55:30 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
23/03/10 10:55:30 INFO CodeGenerator: Code generated in 15.561416 ms
23/03/10 10:55:30 INFO SparkContext: Starting job: parquet at NativeMethodAccessorImpl.java:0
23/03/10 10:55:30 INFO DAGScheduler: Got job 4 (parquet at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 10:55:30 INFO DAGScheduler: Final stage: ResultStage 8 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 10:55:30 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 7)
23/03/10 10:55:30 INFO DAGScheduler: Missing parents: List()
23/03/10 10:55:30 INFO DAGScheduler: Submitting ResultStage 8 (MapPartitionsRDD[21] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 10:55:30 INFO MemoryStore: Block broadcast_7 stored as values in memory (estimated size 240.2 KiB, free 365.1 MiB)
23/03/10 10:55:30 INFO MemoryStore: Block broadcast_7_piece0 stored as bytes in memory (estimated size 89.2 KiB, free 365.0 MiB)
23/03/10 10:55:30 INFO BlockManagerInfo: Added broadcast_7_piece0 in memory on 172.27.188.152:38061 (size: 89.2 KiB, free: 366.1 MiB)
23/03/10 10:55:30 INFO SparkContext: Created broadcast 7 from broadcast at DAGScheduler.scala:1513
23/03/10 10:55:30 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 8 (MapPartitionsRDD[21] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 10:55:30 INFO TaskSchedulerImpl: Adding task set 8.0 with 1 tasks resource profile 0
23/03/10 10:55:31 INFO TaskSetManager: Starting task 0.0 in stage 8.0 (TID 5) (172.27.188.152, executor 0, partition 0, NODE_LOCAL, 4457 bytes) taskResourceAssignments Map()
23/03/10 10:55:31 INFO BlockManagerInfo: Added broadcast_7_piece0 in memory on 172.27.188.152:46737 (size: 89.2 KiB, free: 366.1 MiB)
23/03/10 10:55:31 INFO MapOutputTrackerMasterEndpoint: Asked to send map output locations for shuffle 1 to 172.27.188.152:44664
23/03/10 10:55:31 INFO TaskSetManager: Finished task 0.0 in stage 8.0 (TID 5) in 979 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 10:55:31 INFO TaskSchedulerImpl: Removed TaskSet 8.0, whose tasks have all completed, from pool 
23/03/10 10:55:31 INFO DAGScheduler: ResultStage 8 (parquet at NativeMethodAccessorImpl.java:0) finished in 1.011 s
23/03/10 10:55:31 INFO DAGScheduler: Job 4 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 10:55:31 INFO TaskSchedulerImpl: Killing all running tasks in stage 8: Stage finished
23/03/10 10:55:31 INFO DAGScheduler: Job 4 finished: parquet at NativeMethodAccessorImpl.java:0, took 1.028995 s
23/03/10 10:55:31 INFO FileFormatWriter: Start to commit write Job 9733a30f-7d20-4b72-a94f-140c8c1e4269.
23/03/10 10:55:32 INFO FileFormatWriter: Write Job 9733a30f-7d20-4b72-a94f-140c8c1e4269 committed. Elapsed time: 39 ms.
23/03/10 10:55:32 INFO FileFormatWriter: Finished processing stats for write job 9733a30f-7d20-4b72-a94f-140c8c1e4269.
#######  Created Parquet File  #########
23/03/10 10:55:32 INFO InMemoryFileIndex: It took 1 ms to list leaf files for 1 paths.
23/03/10 10:55:32 INFO SparkContext: Starting job: parquet at NativeMethodAccessorImpl.java:0
23/03/10 10:55:32 INFO DAGScheduler: Got job 5 (parquet at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 10:55:32 INFO DAGScheduler: Final stage: ResultStage 9 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 10:55:32 INFO DAGScheduler: Parents of final stage: List()
23/03/10 10:55:32 INFO DAGScheduler: Missing parents: List()
23/03/10 10:55:32 INFO DAGScheduler: Submitting ResultStage 9 (MapPartitionsRDD[23] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 10:55:32 INFO MemoryStore: Block broadcast_8 stored as values in memory (estimated size 104.4 KiB, free 364.9 MiB)
23/03/10 10:55:32 INFO MemoryStore: Block broadcast_8_piece0 stored as bytes in memory (estimated size 37.6 KiB, free 364.9 MiB)
23/03/10 10:55:32 INFO BlockManagerInfo: Added broadcast_8_piece0 in memory on 172.27.188.152:38061 (size: 37.6 KiB, free: 366.1 MiB)
23/03/10 10:55:32 INFO SparkContext: Created broadcast 8 from broadcast at DAGScheduler.scala:1513
23/03/10 10:55:32 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 9 (MapPartitionsRDD[23] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 10:55:32 INFO TaskSchedulerImpl: Adding task set 9.0 with 1 tasks resource profile 0
23/03/10 10:55:32 INFO TaskSetManager: Starting task 0.0 in stage 9.0 (TID 6) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 4649 bytes) taskResourceAssignments Map()
23/03/10 10:55:32 INFO BlockManagerInfo: Added broadcast_8_piece0 in memory on 172.27.188.152:46737 (size: 37.6 KiB, free: 366.1 MiB)
23/03/10 10:55:32 INFO TaskSetManager: Finished task 0.0 in stage 9.0 (TID 6) in 95 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 10:55:32 INFO TaskSchedulerImpl: Removed TaskSet 9.0, whose tasks have all completed, from pool 
23/03/10 10:55:32 INFO DAGScheduler: ResultStage 9 (parquet at NativeMethodAccessorImpl.java:0) finished in 0.116 s
23/03/10 10:55:32 INFO DAGScheduler: Job 5 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 10:55:32 INFO TaskSchedulerImpl: Killing all running tasks in stage 9: Stage finished
23/03/10 10:55:32 INFO DAGScheduler: Job 5 finished: parquet at NativeMethodAccessorImpl.java:0, took 0.128220 s
##########   Parquet File Output    ########################
23/03/10 10:55:32 INFO FileSourceStrategy: Pushed Filters: 
23/03/10 10:55:32 INFO FileSourceStrategy: Post-Scan Filters: 
23/03/10 10:55:32 INFO FileSourceStrategy: Output Data Schema: struct<age: string, count: bigint>
23/03/10 10:55:32 INFO CodeGenerator: Code generated in 18.574343 ms
23/03/10 10:55:32 INFO MemoryStore: Block broadcast_9 stored as values in memory (estimated size 357.5 KiB, free 364.6 MiB)
23/03/10 10:55:32 INFO MemoryStore: Block broadcast_9_piece0 stored as bytes in memory (estimated size 35.4 KiB, free 364.5 MiB)
23/03/10 10:55:32 INFO BlockManagerInfo: Added broadcast_9_piece0 in memory on 172.27.188.152:38061 (size: 35.4 KiB, free: 366.0 MiB)
23/03/10 10:55:32 INFO SparkContext: Created broadcast 9 from showString at NativeMethodAccessorImpl.java:0
23/03/10 10:55:32 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 10:55:32 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
23/03/10 10:55:32 INFO DAGScheduler: Got job 6 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 10:55:32 INFO DAGScheduler: Final stage: ResultStage 10 (showString at NativeMethodAccessorImpl.java:0)
23/03/10 10:55:32 INFO DAGScheduler: Parents of final stage: List()
23/03/10 10:55:32 INFO DAGScheduler: Missing parents: List()
23/03/10 10:55:32 INFO DAGScheduler: Submitting ResultStage 10 (MapPartitionsRDD[27] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 10:55:32 INFO MemoryStore: Block broadcast_10 stored as values in memory (estimated size 13.6 KiB, free 364.5 MiB)
23/03/10 10:55:32 INFO MemoryStore: Block broadcast_10_piece0 stored as bytes in memory (estimated size 6.1 KiB, free 364.5 MiB)
23/03/10 10:55:32 INFO BlockManagerInfo: Added broadcast_10_piece0 in memory on 172.27.188.152:38061 (size: 6.1 KiB, free: 366.0 MiB)
23/03/10 10:55:32 INFO SparkContext: Created broadcast 10 from broadcast at DAGScheduler.scala:1513
23/03/10 10:55:32 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 10 (MapPartitionsRDD[27] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 10:55:32 INFO TaskSchedulerImpl: Adding task set 10.0 with 1 tasks resource profile 0
23/03/10 10:55:32 INFO TaskSetManager: Starting task 0.0 in stage 10.0 (TID 7) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 4974 bytes) taskResourceAssignments Map()
23/03/10 10:55:32 INFO BlockManagerInfo: Added broadcast_10_piece0 in memory on 172.27.188.152:46737 (size: 6.1 KiB, free: 366.1 MiB)
23/03/10 10:55:32 INFO BlockManagerInfo: Added broadcast_9_piece0 in memory on 172.27.188.152:46737 (size: 35.4 KiB, free: 366.0 MiB)
23/03/10 10:55:32 INFO TaskSetManager: Finished task 0.0 in stage 10.0 (TID 7) in 194 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 10:55:32 INFO TaskSchedulerImpl: Removed TaskSet 10.0, whose tasks have all completed, from pool 
23/03/10 10:55:32 INFO DAGScheduler: ResultStage 10 (showString at NativeMethodAccessorImpl.java:0) finished in 0.218 s
23/03/10 10:55:32 INFO DAGScheduler: Job 6 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 10:55:32 INFO TaskSchedulerImpl: Killing all running tasks in stage 10: Stage finished
23/03/10 10:55:32 INFO DAGScheduler: Job 6 finished: showString at NativeMethodAccessorImpl.java:0, took 0.228289 s
23/03/10 10:55:32 INFO CodeGenerator: Code generated in 10.935915 ms
+---+-----+
|age|count|
+---+-----+
| 32|  221|
| 30|  217|
| 33|  210|
| 35|  209|
| 31|  206|
| 34|  198|
| 36|  195|
| 29|  171|
| 37|  170|
| 28|  162|
| 38|  144|
| 39|  143|
| 27|  141|
| 26|  134|
| 41|  120|
| 46|  118|
| 40|  116|
| 47|  113|
| 25|  113|
| 42|  111|
+---+-----+
only showing top 20 rows

None
23/03/10 10:55:32 INFO BlockManagerInfo: Removed broadcast_3_piece0 on 172.27.188.152:38061 in memory (size: 34.7 KiB, free: 366.0 MiB)
23/03/10 10:55:32 INFO BlockManagerInfo: Removed broadcast_3_piece0 on 172.27.188.152:46737 in memory (size: 34.7 KiB, free: 366.1 MiB)
23/03/10 10:55:32 INFO BlockManagerInfo: Removed broadcast_6_piece0 on 172.27.188.152:38061 in memory (size: 19.9 KiB, free: 366.1 MiB)
23/03/10 10:55:32 INFO BlockManagerInfo: Removed broadcast_6_piece0 on 172.27.188.152:46737 in memory (size: 19.9 KiB, free: 366.1 MiB)
23/03/10 10:55:32 INFO BlockManagerInfo: Removed broadcast_7_piece0 on 172.27.188.152:38061 in memory (size: 89.2 KiB, free: 366.2 MiB)
23/03/10 10:55:32 INFO BlockManagerInfo: Removed broadcast_7_piece0 on 172.27.188.152:46737 in memory (size: 89.2 KiB, free: 366.2 MiB)
23/03/10 10:55:32 INFO BlockManagerInfo: Removed broadcast_4_piece0 on 172.27.188.152:38061 in memory (size: 18.2 KiB, free: 366.2 MiB)
23/03/10 10:55:32 INFO BlockManagerInfo: Removed broadcast_4_piece0 on 172.27.188.152:46737 in memory (size: 18.2 KiB, free: 366.2 MiB)
23/03/10 10:55:32 INFO BlockManagerInfo: Removed broadcast_8_piece0 on 172.27.188.152:38061 in memory (size: 37.6 KiB, free: 366.2 MiB)
23/03/10 10:55:32 INFO BlockManagerInfo: Removed broadcast_8_piece0 on 172.27.188.152:46737 in memory (size: 37.6 KiB, free: 366.2 MiB)
23/03/10 10:55:32 INFO BlockManagerInfo: Removed broadcast_10_piece0 on 172.27.188.152:38061 in memory (size: 6.1 KiB, free: 366.2 MiB)
23/03/10 10:55:32 INFO BlockManagerInfo: Removed broadcast_10_piece0 on 172.27.188.152:46737 in memory (size: 6.1 KiB, free: 366.2 MiB)
23/03/10 10:55:32 INFO BlockManagerInfo: Removed broadcast_5_piece0 on 172.27.188.152:38061 in memory (size: 19.2 KiB, free: 366.2 MiB)
23/03/10 10:55:32 INFO BlockManagerInfo: Removed broadcast_5_piece0 on 172.27.188.152:46737 in memory (size: 19.2 KiB, free: 366.3 MiB)
23/03/10 10:55:33 INFO FileSourceStrategy: Pushed Filters: IsNotNull(y),EqualTo(y,yes)
23/03/10 10:55:33 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(y#33),(y#33 = yes)
23/03/10 10:55:33 INFO FileSourceStrategy: Output Data Schema: struct<age: string, y: string>
23/03/10 10:55:33 INFO deprecation: mapred.output.compress is deprecated. Instead, use mapreduce.output.fileoutputformat.compress
23/03/10 10:55:33 INFO AvroUtils: Compressing Avro output using the snappy codec
23/03/10 10:55:33 INFO CodeGenerator: Code generated in 49.918794 ms
23/03/10 10:55:33 INFO CodeGenerator: Code generated in 11.441168 ms
23/03/10 10:55:33 INFO MemoryStore: Block broadcast_11 stored as values in memory (estimated size 353.2 KiB, free 365.2 MiB)
23/03/10 10:55:33 INFO MemoryStore: Block broadcast_11_piece0 stored as bytes in memory (estimated size 34.7 KiB, free 365.2 MiB)
23/03/10 10:55:33 INFO BlockManagerInfo: Added broadcast_11_piece0 in memory on 172.27.188.152:38061 (size: 34.7 KiB, free: 366.2 MiB)
23/03/10 10:55:33 INFO SparkContext: Created broadcast 11 from save at NativeMethodAccessorImpl.java:0
23/03/10 10:55:33 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 10:55:33 INFO DAGScheduler: Registering RDD 34 (save at NativeMethodAccessorImpl.java:0) as input to shuffle 2
23/03/10 10:55:33 INFO DAGScheduler: Got map stage job 7 (save at NativeMethodAccessorImpl.java:0) with 2 output partitions
23/03/10 10:55:33 INFO DAGScheduler: Final stage: ShuffleMapStage 11 (save at NativeMethodAccessorImpl.java:0)
23/03/10 10:55:33 INFO DAGScheduler: Parents of final stage: List()
23/03/10 10:55:33 INFO DAGScheduler: Missing parents: List()
23/03/10 10:55:33 INFO DAGScheduler: Submitting ShuffleMapStage 11 (MapPartitionsRDD[34] at save at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 10:55:33 INFO MemoryStore: Block broadcast_12 stored as values in memory (estimated size 46.0 KiB, free 365.1 MiB)
23/03/10 10:55:33 INFO MemoryStore: Block broadcast_12_piece0 stored as bytes in memory (estimated size 21.8 KiB, free 365.1 MiB)
23/03/10 10:55:33 INFO BlockManagerInfo: Added broadcast_12_piece0 in memory on 172.27.188.152:38061 (size: 21.8 KiB, free: 366.2 MiB)
23/03/10 10:55:33 INFO SparkContext: Created broadcast 12 from broadcast at DAGScheduler.scala:1513
23/03/10 10:55:33 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 11 (MapPartitionsRDD[34] at save at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
23/03/10 10:55:33 INFO TaskSchedulerImpl: Adding task set 11.0 with 2 tasks resource profile 0
23/03/10 10:55:33 INFO TaskSetManager: Starting task 0.0 in stage 11.0 (TID 8) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 4974 bytes) taskResourceAssignments Map()
23/03/10 10:55:33 INFO TaskSetManager: Starting task 1.0 in stage 11.0 (TID 9) (172.27.188.152, executor 0, partition 1, PROCESS_LOCAL, 4974 bytes) taskResourceAssignments Map()
23/03/10 10:55:33 INFO BlockManagerInfo: Added broadcast_12_piece0 in memory on 172.27.188.152:46737 (size: 21.8 KiB, free: 366.2 MiB)
23/03/10 10:55:34 INFO BlockManagerInfo: Added broadcast_11_piece0 in memory on 172.27.188.152:46737 (size: 34.7 KiB, free: 366.2 MiB)
23/03/10 10:55:34 INFO TaskSetManager: Finished task 1.0 in stage 11.0 (TID 9) in 1092 ms on 172.27.188.152 (executor 0) (1/2)
23/03/10 10:55:34 INFO PythonAccumulatorV2: Connected to AccumulatorServer at host: 127.0.0.1 port: 42219
23/03/10 10:55:34 INFO TaskSetManager: Finished task 0.0 in stage 11.0 (TID 8) in 1186 ms on 172.27.188.152 (executor 0) (2/2)
23/03/10 10:55:34 INFO TaskSchedulerImpl: Removed TaskSet 11.0, whose tasks have all completed, from pool 
23/03/10 10:55:34 INFO DAGScheduler: ShuffleMapStage 11 (save at NativeMethodAccessorImpl.java:0) finished in 1.209 s
23/03/10 10:55:34 INFO DAGScheduler: looking for newly runnable stages
23/03/10 10:55:34 INFO DAGScheduler: running: Set()
23/03/10 10:55:34 INFO DAGScheduler: waiting: Set()
23/03/10 10:55:34 INFO DAGScheduler: failed: Set()
23/03/10 10:55:34 INFO ShufflePartitionsUtil: For shuffle(2), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
23/03/10 10:55:34 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
23/03/10 10:55:34 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
23/03/10 10:55:34 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter
23/03/10 10:55:34 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
23/03/10 10:55:34 INFO CodeGenerator: Code generated in 14.911033 ms
23/03/10 10:55:34 INFO SparkContext: Starting job: save at NativeMethodAccessorImpl.java:0
23/03/10 10:55:34 INFO DAGScheduler: Got job 8 (save at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 10:55:34 INFO DAGScheduler: Final stage: ResultStage 13 (save at NativeMethodAccessorImpl.java:0)
23/03/10 10:55:34 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 12)
23/03/10 10:55:34 INFO DAGScheduler: Missing parents: List()
23/03/10 10:55:34 INFO DAGScheduler: Submitting ResultStage 13 (MapPartitionsRDD[36] at save at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 10:55:34 INFO MemoryStore: Block broadcast_13 stored as values in memory (estimated size 245.3 KiB, free 364.9 MiB)
23/03/10 10:55:34 INFO MemoryStore: Block broadcast_13_piece0 stored as bytes in memory (estimated size 91.8 KiB, free 364.8 MiB)
23/03/10 10:55:34 INFO BlockManagerInfo: Added broadcast_13_piece0 in memory on 172.27.188.152:38061 (size: 91.8 KiB, free: 366.1 MiB)
23/03/10 10:55:34 INFO SparkContext: Created broadcast 13 from broadcast at DAGScheduler.scala:1513
23/03/10 10:55:34 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 13 (MapPartitionsRDD[36] at save at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 10:55:34 INFO TaskSchedulerImpl: Adding task set 13.0 with 1 tasks resource profile 0
23/03/10 10:55:34 INFO TaskSetManager: Starting task 0.0 in stage 13.0 (TID 10) (172.27.188.152, executor 0, partition 0, NODE_LOCAL, 4457 bytes) taskResourceAssignments Map()
23/03/10 10:55:34 INFO BlockManagerInfo: Added broadcast_13_piece0 in memory on 172.27.188.152:46737 (size: 91.8 KiB, free: 366.1 MiB)
23/03/10 10:55:34 INFO MapOutputTrackerMasterEndpoint: Asked to send map output locations for shuffle 2 to 172.27.188.152:44664
23/03/10 10:55:34 INFO TaskSetManager: Finished task 0.0 in stage 13.0 (TID 10) in 211 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 10:55:34 INFO TaskSchedulerImpl: Removed TaskSet 13.0, whose tasks have all completed, from pool 
23/03/10 10:55:34 INFO DAGScheduler: ResultStage 13 (save at NativeMethodAccessorImpl.java:0) finished in 0.244 s
23/03/10 10:55:34 INFO DAGScheduler: Job 8 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 10:55:34 INFO TaskSchedulerImpl: Killing all running tasks in stage 13: Stage finished
23/03/10 10:55:34 INFO DAGScheduler: Job 8 finished: save at NativeMethodAccessorImpl.java:0, took 0.258192 s
23/03/10 10:55:34 INFO FileFormatWriter: Start to commit write Job 8c111155-320d-4565-8cd5-36e716e805c7.
23/03/10 10:55:34 INFO FileFormatWriter: Write Job 8c111155-320d-4565-8cd5-36e716e805c7 committed. Elapsed time: 10 ms.
23/03/10 10:55:34 INFO FileFormatWriter: Finished processing stats for write job 8c111155-320d-4565-8cd5-36e716e805c7.
#######  Created Avro File  #########
23/03/10 10:55:34 INFO InMemoryFileIndex: It took 1 ms to list leaf files for 1 paths.
##########   Avro File Output    ########################
23/03/10 10:55:34 INFO FileSourceStrategy: Pushed Filters: 
23/03/10 10:55:34 INFO FileSourceStrategy: Post-Scan Filters: 
23/03/10 10:55:34 INFO FileSourceStrategy: Output Data Schema: struct<age_cat: string, count: bigint>
23/03/10 10:55:35 INFO CodeGenerator: Code generated in 13.407398 ms
23/03/10 10:55:35 INFO MemoryStore: Block broadcast_14 stored as values in memory (estimated size 352.9 KiB, free 364.4 MiB)
23/03/10 10:55:35 INFO MemoryStore: Block broadcast_14_piece0 stored as bytes in memory (estimated size 34.8 KiB, free 364.4 MiB)
23/03/10 10:55:35 INFO BlockManagerInfo: Added broadcast_14_piece0 in memory on 172.27.188.152:38061 (size: 34.8 KiB, free: 366.1 MiB)
23/03/10 10:55:35 INFO SparkContext: Created broadcast 14 from showString at NativeMethodAccessorImpl.java:0
23/03/10 10:55:35 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 10:55:35 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
23/03/10 10:55:35 INFO DAGScheduler: Got job 9 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 10:55:35 INFO DAGScheduler: Final stage: ResultStage 14 (showString at NativeMethodAccessorImpl.java:0)
23/03/10 10:55:35 INFO DAGScheduler: Parents of final stage: List()
23/03/10 10:55:35 INFO DAGScheduler: Missing parents: List()
23/03/10 10:55:35 INFO DAGScheduler: Submitting ResultStage 14 (MapPartitionsRDD[40] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 10:55:35 INFO MemoryStore: Block broadcast_15 stored as values in memory (estimated size 12.0 KiB, free 364.4 MiB)
23/03/10 10:55:35 INFO MemoryStore: Block broadcast_15_piece0 stored as bytes in memory (estimated size 6.0 KiB, free 364.4 MiB)
23/03/10 10:55:35 INFO BlockManagerInfo: Added broadcast_15_piece0 in memory on 172.27.188.152:38061 (size: 6.0 KiB, free: 366.0 MiB)
23/03/10 10:55:35 INFO SparkContext: Created broadcast 15 from broadcast at DAGScheduler.scala:1513
23/03/10 10:55:35 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 14 (MapPartitionsRDD[40] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 10:55:35 INFO TaskSchedulerImpl: Adding task set 14.0 with 1 tasks resource profile 0
23/03/10 10:55:35 INFO TaskSetManager: Starting task 0.0 in stage 14.0 (TID 11) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 4961 bytes) taskResourceAssignments Map()
23/03/10 10:55:35 INFO BlockManagerInfo: Added broadcast_15_piece0 in memory on 172.27.188.152:46737 (size: 6.0 KiB, free: 366.1 MiB)
23/03/10 10:55:35 INFO BlockManagerInfo: Added broadcast_14_piece0 in memory on 172.27.188.152:46737 (size: 34.8 KiB, free: 366.1 MiB)
23/03/10 10:55:35 INFO TaskSetManager: Finished task 0.0 in stage 14.0 (TID 11) in 166 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 10:55:35 INFO TaskSchedulerImpl: Removed TaskSet 14.0, whose tasks have all completed, from pool 
23/03/10 10:55:35 INFO DAGScheduler: ResultStage 14 (showString at NativeMethodAccessorImpl.java:0) finished in 0.185 s
23/03/10 10:55:35 INFO DAGScheduler: Job 9 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 10:55:35 INFO TaskSchedulerImpl: Killing all running tasks in stage 14: Stage finished
23/03/10 10:55:35 INFO DAGScheduler: Job 9 finished: showString at NativeMethodAccessorImpl.java:0, took 0.196953 s
+-------+-----+
|age_cat|count|
+-------+-----+
|  Young| 2924|
+-------+-----+

None
23/03/10 10:55:35 INFO SparkContext: Invoking stop() from shutdown hook
23/03/10 10:55:35 INFO SparkUI: Stopped Spark web UI at http://172.27.188.152:4040
23/03/10 10:55:35 INFO StandaloneSchedulerBackend: Shutting down all executors
23/03/10 10:55:35 INFO CoarseGrainedSchedulerBackend$DriverEndpoint: Asking each executor to shut down
23/03/10 10:55:35 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
23/03/10 10:55:35 INFO MemoryStore: MemoryStore cleared
23/03/10 10:55:35 INFO BlockManager: BlockManager stopped
23/03/10 10:55:35 INFO BlockManagerMaster: BlockManagerMaster stopped
23/03/10 10:55:35 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
23/03/10 10:55:35 INFO SparkContext: Successfully stopped SparkContext
23/03/10 10:55:35 INFO ShutdownHookManager: Shutdown hook called
23/03/10 10:55:35 INFO ShutdownHookManager: Deleting directory /tmp/spark-056c605b-4a49-480f-9b25-3b9819a57a86
23/03/10 10:55:35 INFO ShutdownHookManager: Deleting directory /tmp/spark-6ad655a0-4c77-4d2d-b3f5-90a2ffb9a8b4/pyspark-0a091bcd-f000-4caf-82eb-95104f844822
23/03/10 10:55:35 INFO ShutdownHookManager: Deleting directory /tmp/spark-6ad655a0-4c77-4d2d-b3f5-90a2ffb9a8b4
##### Finished Executor #####
============================================
Fri Mar 10 05:30:01 UTC 2023
##### Started Executor #####
23/03/10 11:00:03 WARN Utils: Your hostname, MILES-BL-4819-LAP resolves to a loopback address: 127.0.1.1; using 172.27.188.152 instead (on interface eth0)
23/03/10 11:00:03 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
:: loading settings :: url = jar:file:/opt/spark/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml
Ivy Default Cache set to: /home/shashi/.ivy2/cache
The jars for the packages stored in: /home/shashi/.ivy2/jars
org.apache.spark#spark-avro_2.12 added as a dependency
:: resolving dependencies :: org.apache.spark#spark-submit-parent-11148716-7354-4acc-bf36-4fa45de8c445;1.0
	confs: [default]
	found org.apache.spark#spark-avro_2.12;3.3.2 in central
	found org.tukaani#xz;1.9 in central
	found org.spark-project.spark#unused;1.0.0 in central
:: resolution report :: resolve 322ms :: artifacts dl 11ms
	:: modules in use:
	org.apache.spark#spark-avro_2.12;3.3.2 from central in [default]
	org.spark-project.spark#unused;1.0.0 from central in [default]
	org.tukaani#xz;1.9 from central in [default]
	---------------------------------------------------------------------
	|                  |            modules            ||   artifacts   |
	|       conf       | number| search|dwnlded|evicted|| number|dwnlded|
	---------------------------------------------------------------------
	|      default     |   3   |   0   |   0   |   0   ||   3   |   0   |
	---------------------------------------------------------------------
:: retrieving :: org.apache.spark#spark-submit-parent-11148716-7354-4acc-bf36-4fa45de8c445
	confs: [default]
	0 artifacts copied, 3 already retrieved (0kB/12ms)
23/03/10 11:00:05 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
23/03/10 11:00:06 INFO SparkContext: Running Spark version 3.3.2
23/03/10 11:00:07 INFO ResourceUtils: ==============================================================
23/03/10 11:00:07 INFO ResourceUtils: No custom resources configured for spark.driver.
23/03/10 11:00:07 INFO ResourceUtils: ==============================================================
23/03/10 11:00:07 INFO SparkContext: Submitted application: Bank Market
23/03/10 11:00:07 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
23/03/10 11:00:07 INFO ResourceProfile: Limiting resource is cpu
23/03/10 11:00:07 INFO ResourceProfileManager: Added ResourceProfile id: 0
23/03/10 11:00:07 INFO SecurityManager: Changing view acls to: shashi
23/03/10 11:00:07 INFO SecurityManager: Changing modify acls to: shashi
23/03/10 11:00:07 INFO SecurityManager: Changing view acls groups to: 
23/03/10 11:00:07 INFO SecurityManager: Changing modify acls groups to: 
23/03/10 11:00:07 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(shashi); groups with view permissions: Set(); users  with modify permissions: Set(shashi); groups with modify permissions: Set()
23/03/10 11:00:07 INFO Utils: Successfully started service 'sparkDriver' on port 33411.
23/03/10 11:00:07 INFO SparkEnv: Registering MapOutputTracker
23/03/10 11:00:07 INFO SparkEnv: Registering BlockManagerMaster
23/03/10 11:00:07 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
23/03/10 11:00:07 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
23/03/10 11:00:07 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
23/03/10 11:00:07 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-8d378678-0de1-4f67-974f-b8ba5d168cac
23/03/10 11:00:07 INFO MemoryStore: MemoryStore started with capacity 366.3 MiB
23/03/10 11:00:08 INFO SparkEnv: Registering OutputCommitCoordinator
23/03/10 11:00:08 INFO Utils: Successfully started service 'SparkUI' on port 4040.
23/03/10 11:00:08 INFO SparkContext: Added JAR file:///home/shashi/.ivy2/jars/org.apache.spark_spark-avro_2.12-3.3.2.jar at spark://172.27.188.152:33411/jars/org.apache.spark_spark-avro_2.12-3.3.2.jar with timestamp 1678426206978
23/03/10 11:00:08 INFO SparkContext: Added JAR file:///home/shashi/.ivy2/jars/org.tukaani_xz-1.9.jar at spark://172.27.188.152:33411/jars/org.tukaani_xz-1.9.jar with timestamp 1678426206978
23/03/10 11:00:08 INFO SparkContext: Added JAR file:///home/shashi/.ivy2/jars/org.spark-project.spark_unused-1.0.0.jar at spark://172.27.188.152:33411/jars/org.spark-project.spark_unused-1.0.0.jar with timestamp 1678426206978
23/03/10 11:00:08 INFO SparkContext: Added file file:///home/shashi/.ivy2/jars/org.apache.spark_spark-avro_2.12-3.3.2.jar at spark://172.27.188.152:33411/files/org.apache.spark_spark-avro_2.12-3.3.2.jar with timestamp 1678426206978
23/03/10 11:00:08 INFO Utils: Copying /home/shashi/.ivy2/jars/org.apache.spark_spark-avro_2.12-3.3.2.jar to /tmp/spark-47fa4466-9e1e-4623-9fcb-b88244b93585/userFiles-a0e37095-e3a3-43d8-b31d-5b5bc9a18e3b/org.apache.spark_spark-avro_2.12-3.3.2.jar
23/03/10 11:00:08 INFO SparkContext: Added file file:///home/shashi/.ivy2/jars/org.tukaani_xz-1.9.jar at spark://172.27.188.152:33411/files/org.tukaani_xz-1.9.jar with timestamp 1678426206978
23/03/10 11:00:08 INFO Utils: Copying /home/shashi/.ivy2/jars/org.tukaani_xz-1.9.jar to /tmp/spark-47fa4466-9e1e-4623-9fcb-b88244b93585/userFiles-a0e37095-e3a3-43d8-b31d-5b5bc9a18e3b/org.tukaani_xz-1.9.jar
23/03/10 11:00:08 INFO SparkContext: Added file file:///home/shashi/.ivy2/jars/org.spark-project.spark_unused-1.0.0.jar at spark://172.27.188.152:33411/files/org.spark-project.spark_unused-1.0.0.jar with timestamp 1678426206978
23/03/10 11:00:08 INFO Utils: Copying /home/shashi/.ivy2/jars/org.spark-project.spark_unused-1.0.0.jar to /tmp/spark-47fa4466-9e1e-4623-9fcb-b88244b93585/userFiles-a0e37095-e3a3-43d8-b31d-5b5bc9a18e3b/org.spark-project.spark_unused-1.0.0.jar
23/03/10 11:00:08 INFO StandaloneAppClient$ClientEndpoint: Connecting to master spark://MILES-BL-4819-LAP.:7077...
23/03/10 11:00:08 INFO TransportClientFactory: Successfully created connection to MILES-BL-4819-LAP./127.0.1.1:7077 after 38 ms (0 ms spent in bootstraps)
23/03/10 11:00:08 INFO StandaloneSchedulerBackend: Connected to Spark cluster with app ID app-20230310110008-0004
23/03/10 11:00:08 INFO StandaloneAppClient$ClientEndpoint: Executor added: app-20230310110008-0004/0 on worker-20230309123128-172.27.188.152-45151 (172.27.188.152:45151) with 8 core(s)
23/03/10 11:00:08 INFO StandaloneSchedulerBackend: Granted executor ID app-20230310110008-0004/0 on hostPort 172.27.188.152:45151 with 8 core(s), 1024.0 MiB RAM
23/03/10 11:00:08 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 33271.
23/03/10 11:00:08 INFO NettyBlockTransferService: Server created on 172.27.188.152:33271
23/03/10 11:00:08 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
23/03/10 11:00:08 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, 172.27.188.152, 33271, None)
23/03/10 11:00:08 INFO BlockManagerMasterEndpoint: Registering block manager 172.27.188.152:33271 with 366.3 MiB RAM, BlockManagerId(driver, 172.27.188.152, 33271, None)
23/03/10 11:00:08 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, 172.27.188.152, 33271, None)
23/03/10 11:00:08 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, 172.27.188.152, 33271, None)
23/03/10 11:00:08 INFO StandaloneAppClient$ClientEndpoint: Executor updated: app-20230310110008-0004/0 is now RUNNING
23/03/10 11:00:09 INFO SingleEventLogFileWriter: Logging events to file:/tmp/spark-events/app-20230310110008-0004.inprogress
23/03/10 11:00:09 INFO StandaloneSchedulerBackend: SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio: 0.0
23/03/10 11:00:10 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
23/03/10 11:00:10 INFO SharedState: Warehouse path is 'file:/home/shashi/spark-warehouse'.
23/03/10 11:00:11 INFO InMemoryFileIndex: It took 108 ms to list leaf files for 1 paths.
23/03/10 11:00:11 INFO InMemoryFileIndex: It took 72 ms to list leaf files for 1 paths.
23/03/10 11:00:13 INFO CoarseGrainedSchedulerBackend$DriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (172.27.188.152:33974) with ID 0,  ResourceProfileId 0
23/03/10 11:00:13 INFO BlockManagerMasterEndpoint: Registering block manager 172.27.188.152:34685 with 366.3 MiB RAM, BlockManagerId(0, 172.27.188.152, 34685, None)
23/03/10 11:00:14 INFO FileSourceStrategy: Pushed Filters: 
23/03/10 11:00:14 INFO FileSourceStrategy: Post-Scan Filters: (length(trim(value#0, None)) > 0)
23/03/10 11:00:14 INFO FileSourceStrategy: Output Data Schema: struct<value: string>
23/03/10 11:00:15 INFO CodeGenerator: Code generated in 224.415911 ms
23/03/10 11:00:15 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 353.3 KiB, free 366.0 MiB)
23/03/10 11:00:15 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 34.8 KiB, free 365.9 MiB)
23/03/10 11:00:15 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 172.27.188.152:33271 (size: 34.8 KiB, free: 366.3 MiB)
23/03/10 11:00:15 INFO SparkContext: Created broadcast 0 from load at NativeMethodAccessorImpl.java:0
23/03/10 11:00:15 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 11:00:15 INFO SparkContext: Starting job: load at NativeMethodAccessorImpl.java:0
23/03/10 11:00:15 INFO DAGScheduler: Got job 0 (load at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 11:00:15 INFO DAGScheduler: Final stage: ResultStage 0 (load at NativeMethodAccessorImpl.java:0)
23/03/10 11:00:15 INFO DAGScheduler: Parents of final stage: List()
23/03/10 11:00:15 INFO DAGScheduler: Missing parents: List()
23/03/10 11:00:15 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at load at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:00:15 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 11.9 KiB, free 365.9 MiB)
23/03/10 11:00:15 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 5.9 KiB, free 365.9 MiB)
23/03/10 11:00:15 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on 172.27.188.152:33271 (size: 5.9 KiB, free: 366.3 MiB)
23/03/10 11:00:15 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1513
23/03/10 11:00:15 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at load at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 11:00:15 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
23/03/10 11:00:15 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 4985 bytes) taskResourceAssignments Map()
23/03/10 11:00:16 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on 172.27.188.152:34685 (size: 5.9 KiB, free: 366.3 MiB)
23/03/10 11:00:17 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 172.27.188.152:34685 (size: 34.8 KiB, free: 366.3 MiB)
23/03/10 11:00:17 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 1859 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 11:00:17 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool 
23/03/10 11:00:17 INFO DAGScheduler: ResultStage 0 (load at NativeMethodAccessorImpl.java:0) finished in 1.986 s
23/03/10 11:00:17 INFO DAGScheduler: Job 0 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 11:00:17 INFO TaskSchedulerImpl: Killing all running tasks in stage 0: Stage finished
23/03/10 11:00:17 INFO DAGScheduler: Job 0 finished: load at NativeMethodAccessorImpl.java:0, took 2.072200 s
23/03/10 11:00:17 INFO CodeGenerator: Code generated in 15.440608 ms
23/03/10 11:00:17 INFO FileSourceStrategy: Pushed Filters: 
23/03/10 11:00:17 INFO FileSourceStrategy: Post-Scan Filters: 
23/03/10 11:00:17 INFO FileSourceStrategy: Output Data Schema: struct<value: string>
23/03/10 11:00:17 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 353.3 KiB, free 365.6 MiB)
23/03/10 11:00:17 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 34.8 KiB, free 365.5 MiB)
23/03/10 11:00:17 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on 172.27.188.152:33271 (size: 34.8 KiB, free: 366.2 MiB)
23/03/10 11:00:17 INFO SparkContext: Created broadcast 2 from load at NativeMethodAccessorImpl.java:0
23/03/10 11:00:17 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 11:00:17 INFO BlockManagerInfo: Removed broadcast_1_piece0 on 172.27.188.152:33271 in memory (size: 5.9 KiB, free: 366.2 MiB)
23/03/10 11:00:17 INFO BlockManagerInfo: Removed broadcast_1_piece0 on 172.27.188.152:34685 in memory (size: 5.9 KiB, free: 366.3 MiB)
23/03/10 11:00:18 INFO BlockManagerInfo: Removed broadcast_0_piece0 on 172.27.188.152:33271 in memory (size: 34.8 KiB, free: 366.3 MiB)
23/03/10 11:00:18 INFO BlockManagerInfo: Removed broadcast_0_piece0 on 172.27.188.152:34685 in memory (size: 34.8 KiB, free: 366.3 MiB)
23/03/10 11:00:18 INFO FileSourceStrategy: Pushed Filters: IsNotNull(y),EqualTo(y,yes)
23/03/10 11:00:18 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(y#33),(y#33 = yes)
23/03/10 11:00:18 INFO FileSourceStrategy: Output Data Schema: struct<age: string, y: string>
23/03/10 11:00:18 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
23/03/10 11:00:18 INFO CodeGenerator: Code generated in 81.61872 ms
23/03/10 11:00:18 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 353.2 KiB, free 365.6 MiB)
23/03/10 11:00:18 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 34.8 KiB, free 365.5 MiB)
23/03/10 11:00:18 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on 172.27.188.152:33271 (size: 34.8 KiB, free: 366.2 MiB)
23/03/10 11:00:18 INFO SparkContext: Created broadcast 3 from parquet at NativeMethodAccessorImpl.java:0
23/03/10 11:00:18 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 11:00:18 INFO DAGScheduler: Registering RDD 13 (parquet at NativeMethodAccessorImpl.java:0) as input to shuffle 0
23/03/10 11:00:18 INFO DAGScheduler: Got map stage job 1 (parquet at NativeMethodAccessorImpl.java:0) with 2 output partitions
23/03/10 11:00:18 INFO DAGScheduler: Final stage: ShuffleMapStage 1 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 11:00:18 INFO DAGScheduler: Parents of final stage: List()
23/03/10 11:00:18 INFO DAGScheduler: Missing parents: List()
23/03/10 11:00:18 INFO DAGScheduler: Submitting ShuffleMapStage 1 (MapPartitionsRDD[13] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:00:18 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 38.5 KiB, free 365.5 MiB)
23/03/10 11:00:18 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 18.2 KiB, free 365.5 MiB)
23/03/10 11:00:18 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on 172.27.188.152:33271 (size: 18.2 KiB, free: 366.2 MiB)
23/03/10 11:00:18 INFO SparkContext: Created broadcast 4 from broadcast at DAGScheduler.scala:1513
23/03/10 11:00:18 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 1 (MapPartitionsRDD[13] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
23/03/10 11:00:18 INFO TaskSchedulerImpl: Adding task set 1.0 with 2 tasks resource profile 0
23/03/10 11:00:18 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 1) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 4974 bytes) taskResourceAssignments Map()
23/03/10 11:00:18 INFO TaskSetManager: Starting task 1.0 in stage 1.0 (TID 2) (172.27.188.152, executor 0, partition 1, PROCESS_LOCAL, 4974 bytes) taskResourceAssignments Map()
23/03/10 11:00:18 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on 172.27.188.152:34685 (size: 18.2 KiB, free: 366.3 MiB)
23/03/10 11:00:19 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on 172.27.188.152:34685 (size: 34.8 KiB, free: 366.2 MiB)
23/03/10 11:00:19 INFO TaskSetManager: Finished task 1.0 in stage 1.0 (TID 2) in 906 ms on 172.27.188.152 (executor 0) (1/2)
23/03/10 11:00:19 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 1) in 989 ms on 172.27.188.152 (executor 0) (2/2)
23/03/10 11:00:19 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool 
23/03/10 11:00:19 INFO DAGScheduler: ShuffleMapStage 1 (parquet at NativeMethodAccessorImpl.java:0) finished in 1.018 s
23/03/10 11:00:19 INFO DAGScheduler: looking for newly runnable stages
23/03/10 11:00:19 INFO DAGScheduler: running: Set()
23/03/10 11:00:19 INFO DAGScheduler: waiting: Set()
23/03/10 11:00:19 INFO DAGScheduler: failed: Set()
23/03/10 11:00:19 INFO ShufflePartitionsUtil: For shuffle(0), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
23/03/10 11:00:19 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
23/03/10 11:00:19 INFO CodeGenerator: Code generated in 23.720496 ms
23/03/10 11:00:19 INFO CodeGenerator: Code generated in 32.219616 ms
23/03/10 11:00:19 INFO SparkContext: Starting job: parquet at NativeMethodAccessorImpl.java:0
23/03/10 11:00:20 INFO DAGScheduler: Got job 2 (parquet at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 11:00:20 INFO DAGScheduler: Final stage: ResultStage 3 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 11:00:20 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 2)
23/03/10 11:00:20 INFO DAGScheduler: Missing parents: List()
23/03/10 11:00:20 INFO DAGScheduler: Submitting ResultStage 3 (MapPartitionsRDD[18] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:00:20 INFO MemoryStore: Block broadcast_5 stored as values in memory (estimated size 40.0 KiB, free 365.4 MiB)
23/03/10 11:00:20 INFO MemoryStore: Block broadcast_5_piece0 stored as bytes in memory (estimated size 19.2 KiB, free 365.4 MiB)
23/03/10 11:00:20 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on 172.27.188.152:33271 (size: 19.2 KiB, free: 366.2 MiB)
23/03/10 11:00:20 INFO SparkContext: Created broadcast 5 from broadcast at DAGScheduler.scala:1513
23/03/10 11:00:20 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 3 (MapPartitionsRDD[18] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 11:00:20 INFO TaskSchedulerImpl: Adding task set 3.0 with 1 tasks resource profile 0
23/03/10 11:00:20 INFO TaskSetManager: Starting task 0.0 in stage 3.0 (TID 3) (172.27.188.152, executor 0, partition 0, NODE_LOCAL, 4457 bytes) taskResourceAssignments Map()
23/03/10 11:00:20 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on 172.27.188.152:34685 (size: 19.2 KiB, free: 366.2 MiB)
23/03/10 11:00:20 INFO MapOutputTrackerMasterEndpoint: Asked to send map output locations for shuffle 0 to 172.27.188.152:33974
23/03/10 11:00:20 INFO TaskSetManager: Finished task 0.0 in stage 3.0 (TID 3) in 318 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 11:00:20 INFO TaskSchedulerImpl: Removed TaskSet 3.0, whose tasks have all completed, from pool 
23/03/10 11:00:20 INFO DAGScheduler: ResultStage 3 (parquet at NativeMethodAccessorImpl.java:0) finished in 0.349 s
23/03/10 11:00:20 INFO DAGScheduler: Job 2 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 11:00:20 INFO TaskSchedulerImpl: Killing all running tasks in stage 3: Stage finished
23/03/10 11:00:20 INFO DAGScheduler: Job 2 finished: parquet at NativeMethodAccessorImpl.java:0, took 0.382720 s
23/03/10 11:00:20 INFO DAGScheduler: Registering RDD 19 (parquet at NativeMethodAccessorImpl.java:0) as input to shuffle 1
23/03/10 11:00:20 INFO DAGScheduler: Got map stage job 3 (parquet at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 11:00:20 INFO DAGScheduler: Final stage: ShuffleMapStage 5 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 11:00:20 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 4)
23/03/10 11:00:20 INFO DAGScheduler: Missing parents: List()
23/03/10 11:00:20 INFO DAGScheduler: Submitting ShuffleMapStage 5 (MapPartitionsRDD[19] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:00:20 INFO MemoryStore: Block broadcast_6 stored as values in memory (estimated size 42.0 KiB, free 365.4 MiB)
23/03/10 11:00:20 INFO MemoryStore: Block broadcast_6_piece0 stored as bytes in memory (estimated size 19.9 KiB, free 365.4 MiB)
23/03/10 11:00:20 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on 172.27.188.152:33271 (size: 19.9 KiB, free: 366.2 MiB)
23/03/10 11:00:20 INFO SparkContext: Created broadcast 6 from broadcast at DAGScheduler.scala:1513
23/03/10 11:00:20 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 5 (MapPartitionsRDD[19] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 11:00:20 INFO TaskSchedulerImpl: Adding task set 5.0 with 1 tasks resource profile 0
23/03/10 11:00:20 INFO TaskSetManager: Starting task 0.0 in stage 5.0 (TID 4) (172.27.188.152, executor 0, partition 0, NODE_LOCAL, 4446 bytes) taskResourceAssignments Map()
23/03/10 11:00:20 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on 172.27.188.152:34685 (size: 19.9 KiB, free: 366.2 MiB)
23/03/10 11:00:20 INFO TaskSetManager: Finished task 0.0 in stage 5.0 (TID 4) in 115 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 11:00:20 INFO TaskSchedulerImpl: Removed TaskSet 5.0, whose tasks have all completed, from pool 
23/03/10 11:00:20 INFO DAGScheduler: ShuffleMapStage 5 (parquet at NativeMethodAccessorImpl.java:0) finished in 0.146 s
23/03/10 11:00:20 INFO DAGScheduler: looking for newly runnable stages
23/03/10 11:00:20 INFO DAGScheduler: running: Set()
23/03/10 11:00:20 INFO DAGScheduler: waiting: Set()
23/03/10 11:00:20 INFO DAGScheduler: failed: Set()
23/03/10 11:00:20 INFO ShufflePartitionsUtil: For shuffle(1), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
23/03/10 11:00:20 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
23/03/10 11:00:20 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
23/03/10 11:00:20 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
23/03/10 11:00:20 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
23/03/10 11:00:20 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
23/03/10 11:00:20 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
23/03/10 11:00:20 INFO CodeGenerator: Code generated in 12.987102 ms
23/03/10 11:00:20 INFO SparkContext: Starting job: parquet at NativeMethodAccessorImpl.java:0
23/03/10 11:00:20 INFO DAGScheduler: Got job 4 (parquet at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 11:00:20 INFO DAGScheduler: Final stage: ResultStage 8 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 11:00:20 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 7)
23/03/10 11:00:20 INFO DAGScheduler: Missing parents: List()
23/03/10 11:00:20 INFO DAGScheduler: Submitting ResultStage 8 (MapPartitionsRDD[21] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:00:20 INFO MemoryStore: Block broadcast_7 stored as values in memory (estimated size 240.4 KiB, free 365.1 MiB)
23/03/10 11:00:20 INFO MemoryStore: Block broadcast_7_piece0 stored as bytes in memory (estimated size 89.4 KiB, free 365.0 MiB)
23/03/10 11:00:20 INFO BlockManagerInfo: Added broadcast_7_piece0 in memory on 172.27.188.152:33271 (size: 89.4 KiB, free: 366.1 MiB)
23/03/10 11:00:20 INFO SparkContext: Created broadcast 7 from broadcast at DAGScheduler.scala:1513
23/03/10 11:00:20 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 8 (MapPartitionsRDD[21] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 11:00:20 INFO TaskSchedulerImpl: Adding task set 8.0 with 1 tasks resource profile 0
23/03/10 11:00:20 INFO TaskSetManager: Starting task 0.0 in stage 8.0 (TID 5) (172.27.188.152, executor 0, partition 0, NODE_LOCAL, 4457 bytes) taskResourceAssignments Map()
23/03/10 11:00:20 INFO BlockManagerInfo: Added broadcast_7_piece0 in memory on 172.27.188.152:34685 (size: 89.4 KiB, free: 366.1 MiB)
23/03/10 11:00:20 INFO MapOutputTrackerMasterEndpoint: Asked to send map output locations for shuffle 1 to 172.27.188.152:33974
23/03/10 11:00:22 INFO TaskSetManager: Finished task 0.0 in stage 8.0 (TID 5) in 1706 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 11:00:22 INFO TaskSchedulerImpl: Removed TaskSet 8.0, whose tasks have all completed, from pool 
23/03/10 11:00:22 INFO DAGScheduler: ResultStage 8 (parquet at NativeMethodAccessorImpl.java:0) finished in 1.739 s
23/03/10 11:00:22 INFO DAGScheduler: Job 4 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 11:00:22 INFO TaskSchedulerImpl: Killing all running tasks in stage 8: Stage finished
23/03/10 11:00:22 INFO DAGScheduler: Job 4 finished: parquet at NativeMethodAccessorImpl.java:0, took 1.756551 s
23/03/10 11:00:22 INFO FileFormatWriter: Start to commit write Job 152f5235-dbc3-40b2-a230-8a66f37af9a0.
23/03/10 11:00:23 INFO FileFormatWriter: Write Job 152f5235-dbc3-40b2-a230-8a66f37af9a0 committed. Elapsed time: 632 ms.
23/03/10 11:00:23 INFO FileFormatWriter: Finished processing stats for write job 152f5235-dbc3-40b2-a230-8a66f37af9a0.
#######  Created Parquet File  #########
23/03/10 11:00:23 INFO InMemoryFileIndex: It took 116 ms to list leaf files for 1 paths.
23/03/10 11:00:23 INFO SparkContext: Starting job: parquet at NativeMethodAccessorImpl.java:0
23/03/10 11:00:23 INFO DAGScheduler: Got job 5 (parquet at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 11:00:23 INFO DAGScheduler: Final stage: ResultStage 9 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 11:00:23 INFO DAGScheduler: Parents of final stage: List()
23/03/10 11:00:23 INFO DAGScheduler: Missing parents: List()
23/03/10 11:00:23 INFO DAGScheduler: Submitting ResultStage 9 (MapPartitionsRDD[23] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:00:23 INFO MemoryStore: Block broadcast_8 stored as values in memory (estimated size 104.4 KiB, free 364.9 MiB)
23/03/10 11:00:23 INFO MemoryStore: Block broadcast_8_piece0 stored as bytes in memory (estimated size 37.6 KiB, free 364.9 MiB)
23/03/10 11:00:23 INFO BlockManagerInfo: Added broadcast_8_piece0 in memory on 172.27.188.152:33271 (size: 37.6 KiB, free: 366.1 MiB)
23/03/10 11:00:23 INFO SparkContext: Created broadcast 8 from broadcast at DAGScheduler.scala:1513
23/03/10 11:00:23 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 9 (MapPartitionsRDD[23] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 11:00:23 INFO TaskSchedulerImpl: Adding task set 9.0 with 1 tasks resource profile 0
23/03/10 11:00:23 INFO TaskSetManager: Starting task 0.0 in stage 9.0 (TID 6) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 4731 bytes) taskResourceAssignments Map()
23/03/10 11:00:23 INFO BlockManagerInfo: Added broadcast_8_piece0 in memory on 172.27.188.152:34685 (size: 37.6 KiB, free: 366.1 MiB)
23/03/10 11:00:23 INFO TaskSetManager: Finished task 0.0 in stage 9.0 (TID 6) in 207 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 11:00:23 INFO TaskSchedulerImpl: Removed TaskSet 9.0, whose tasks have all completed, from pool 
23/03/10 11:00:23 INFO DAGScheduler: ResultStage 9 (parquet at NativeMethodAccessorImpl.java:0) finished in 0.237 s
23/03/10 11:00:23 INFO DAGScheduler: Job 5 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 11:00:23 INFO TaskSchedulerImpl: Killing all running tasks in stage 9: Stage finished
23/03/10 11:00:23 INFO DAGScheduler: Job 5 finished: parquet at NativeMethodAccessorImpl.java:0, took 0.248716 s
##########   Parquet File Output    ########################
23/03/10 11:00:23 INFO FileSourceStrategy: Pushed Filters: 
23/03/10 11:00:23 INFO FileSourceStrategy: Post-Scan Filters: 
23/03/10 11:00:23 INFO FileSourceStrategy: Output Data Schema: struct<age: string, count: bigint>
23/03/10 11:00:23 INFO CodeGenerator: Code generated in 27.018659 ms
23/03/10 11:00:23 INFO MemoryStore: Block broadcast_9 stored as values in memory (estimated size 357.5 KiB, free 364.6 MiB)
23/03/10 11:00:23 INFO MemoryStore: Block broadcast_9_piece0 stored as bytes in memory (estimated size 35.4 KiB, free 364.5 MiB)
23/03/10 11:00:23 INFO BlockManagerInfo: Added broadcast_9_piece0 in memory on 172.27.188.152:33271 (size: 35.4 KiB, free: 366.0 MiB)
23/03/10 11:00:23 INFO SparkContext: Created broadcast 9 from showString at NativeMethodAccessorImpl.java:0
23/03/10 11:00:23 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 11:00:23 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
23/03/10 11:00:23 INFO DAGScheduler: Got job 6 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 11:00:23 INFO DAGScheduler: Final stage: ResultStage 10 (showString at NativeMethodAccessorImpl.java:0)
23/03/10 11:00:23 INFO DAGScheduler: Parents of final stage: List()
23/03/10 11:00:23 INFO DAGScheduler: Missing parents: List()
23/03/10 11:00:23 INFO DAGScheduler: Submitting ResultStage 10 (MapPartitionsRDD[27] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:00:23 INFO MemoryStore: Block broadcast_10 stored as values in memory (estimated size 13.6 KiB, free 364.5 MiB)
23/03/10 11:00:23 INFO MemoryStore: Block broadcast_10_piece0 stored as bytes in memory (estimated size 6.1 KiB, free 364.5 MiB)
23/03/10 11:00:23 INFO BlockManagerInfo: Added broadcast_10_piece0 in memory on 172.27.188.152:33271 (size: 6.1 KiB, free: 366.0 MiB)
23/03/10 11:00:23 INFO SparkContext: Created broadcast 10 from broadcast at DAGScheduler.scala:1513
23/03/10 11:00:23 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 10 (MapPartitionsRDD[27] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 11:00:23 INFO TaskSchedulerImpl: Adding task set 10.0 with 1 tasks resource profile 0
23/03/10 11:00:23 INFO TaskSetManager: Starting task 0.0 in stage 10.0 (TID 7) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 5056 bytes) taskResourceAssignments Map()
23/03/10 11:00:23 INFO BlockManagerInfo: Added broadcast_10_piece0 in memory on 172.27.188.152:34685 (size: 6.1 KiB, free: 366.1 MiB)
23/03/10 11:00:23 INFO BlockManagerInfo: Added broadcast_9_piece0 in memory on 172.27.188.152:34685 (size: 35.4 KiB, free: 366.0 MiB)
23/03/10 11:00:24 INFO TaskSetManager: Finished task 0.0 in stage 10.0 (TID 7) in 389 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 11:00:24 INFO TaskSchedulerImpl: Removed TaskSet 10.0, whose tasks have all completed, from pool 
23/03/10 11:00:24 INFO DAGScheduler: ResultStage 10 (showString at NativeMethodAccessorImpl.java:0) finished in 0.417 s
23/03/10 11:00:24 INFO DAGScheduler: Job 6 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 11:00:24 INFO TaskSchedulerImpl: Killing all running tasks in stage 10: Stage finished
23/03/10 11:00:24 INFO DAGScheduler: Job 6 finished: showString at NativeMethodAccessorImpl.java:0, took 0.426848 s
23/03/10 11:00:24 INFO CodeGenerator: Code generated in 10.177553 ms
+---+-----+
|age|count|
+---+-----+
| 32|  221|
| 30|  217|
| 33|  210|
| 35|  209|
| 31|  206|
| 34|  198|
| 36|  195|
| 29|  171|
| 37|  170|
| 28|  162|
| 38|  144|
| 39|  143|
| 27|  141|
| 26|  134|
| 41|  120|
| 46|  118|
| 40|  116|
| 47|  113|
| 25|  113|
| 42|  111|
+---+-----+
only showing top 20 rows

None
23/03/10 11:00:24 INFO FileSourceStrategy: Pushed Filters: IsNotNull(y),EqualTo(y,yes)
23/03/10 11:00:24 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(y#33),(y#33 = yes)
23/03/10 11:00:24 INFO FileSourceStrategy: Output Data Schema: struct<age: string, y: string>
23/03/10 11:00:24 INFO deprecation: mapred.output.compress is deprecated. Instead, use mapreduce.output.fileoutputformat.compress
23/03/10 11:00:24 INFO AvroUtils: Compressing Avro output using the snappy codec
23/03/10 11:00:24 INFO CodeGenerator: Code generated in 35.077021 ms
23/03/10 11:00:24 INFO CodeGenerator: Code generated in 8.228824 ms
23/03/10 11:00:24 INFO MemoryStore: Block broadcast_11 stored as values in memory (estimated size 353.2 KiB, free 364.2 MiB)
23/03/10 11:00:24 INFO MemoryStore: Block broadcast_11_piece0 stored as bytes in memory (estimated size 34.8 KiB, free 364.1 MiB)
23/03/10 11:00:24 INFO BlockManagerInfo: Added broadcast_11_piece0 in memory on 172.27.188.152:33271 (size: 34.8 KiB, free: 366.0 MiB)
23/03/10 11:00:24 INFO SparkContext: Created broadcast 11 from save at NativeMethodAccessorImpl.java:0
23/03/10 11:00:24 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 11:00:24 INFO DAGScheduler: Registering RDD 34 (save at NativeMethodAccessorImpl.java:0) as input to shuffle 2
23/03/10 11:00:24 INFO DAGScheduler: Got map stage job 7 (save at NativeMethodAccessorImpl.java:0) with 2 output partitions
23/03/10 11:00:24 INFO DAGScheduler: Final stage: ShuffleMapStage 11 (save at NativeMethodAccessorImpl.java:0)
23/03/10 11:00:24 INFO DAGScheduler: Parents of final stage: List()
23/03/10 11:00:24 INFO DAGScheduler: Missing parents: List()
23/03/10 11:00:24 INFO DAGScheduler: Submitting ShuffleMapStage 11 (MapPartitionsRDD[34] at save at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:00:24 INFO MemoryStore: Block broadcast_12 stored as values in memory (estimated size 46.0 KiB, free 364.1 MiB)
23/03/10 11:00:24 INFO MemoryStore: Block broadcast_12_piece0 stored as bytes in memory (estimated size 21.8 KiB, free 364.1 MiB)
23/03/10 11:00:24 INFO BlockManagerInfo: Added broadcast_12_piece0 in memory on 172.27.188.152:33271 (size: 21.8 KiB, free: 366.0 MiB)
23/03/10 11:00:24 INFO SparkContext: Created broadcast 12 from broadcast at DAGScheduler.scala:1513
23/03/10 11:00:24 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 11 (MapPartitionsRDD[34] at save at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
23/03/10 11:00:24 INFO TaskSchedulerImpl: Adding task set 11.0 with 2 tasks resource profile 0
23/03/10 11:00:24 INFO TaskSetManager: Starting task 0.0 in stage 11.0 (TID 8) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 4974 bytes) taskResourceAssignments Map()
23/03/10 11:00:24 INFO BlockManagerInfo: Removed broadcast_6_piece0 on 172.27.188.152:33271 in memory (size: 19.9 KiB, free: 366.0 MiB)
23/03/10 11:00:24 INFO TaskSetManager: Starting task 1.0 in stage 11.0 (TID 9) (172.27.188.152, executor 0, partition 1, PROCESS_LOCAL, 4974 bytes) taskResourceAssignments Map()
23/03/10 11:00:24 INFO BlockManagerInfo: Removed broadcast_6_piece0 on 172.27.188.152:34685 in memory (size: 19.9 KiB, free: 366.1 MiB)
23/03/10 11:00:24 INFO BlockManagerInfo: Removed broadcast_9_piece0 on 172.27.188.152:33271 in memory (size: 35.4 KiB, free: 366.0 MiB)
23/03/10 11:00:24 INFO BlockManagerInfo: Removed broadcast_9_piece0 on 172.27.188.152:34685 in memory (size: 35.4 KiB, free: 366.1 MiB)
23/03/10 11:00:24 INFO BlockManagerInfo: Added broadcast_12_piece0 in memory on 172.27.188.152:34685 (size: 21.8 KiB, free: 366.1 MiB)
23/03/10 11:00:24 INFO BlockManagerInfo: Removed broadcast_10_piece0 on 172.27.188.152:33271 in memory (size: 6.1 KiB, free: 366.0 MiB)
23/03/10 11:00:24 INFO BlockManagerInfo: Removed broadcast_10_piece0 on 172.27.188.152:34685 in memory (size: 6.1 KiB, free: 366.1 MiB)
23/03/10 11:00:24 INFO BlockManagerInfo: Removed broadcast_5_piece0 on 172.27.188.152:33271 in memory (size: 19.2 KiB, free: 366.0 MiB)
23/03/10 11:00:24 INFO BlockManagerInfo: Removed broadcast_5_piece0 on 172.27.188.152:34685 in memory (size: 19.2 KiB, free: 366.1 MiB)
23/03/10 11:00:24 INFO BlockManagerInfo: Removed broadcast_3_piece0 on 172.27.188.152:33271 in memory (size: 34.8 KiB, free: 366.1 MiB)
23/03/10 11:00:24 INFO BlockManagerInfo: Removed broadcast_3_piece0 on 172.27.188.152:34685 in memory (size: 34.8 KiB, free: 366.1 MiB)
23/03/10 11:00:24 INFO BlockManagerInfo: Removed broadcast_7_piece0 on 172.27.188.152:33271 in memory (size: 89.4 KiB, free: 366.2 MiB)
23/03/10 11:00:24 INFO BlockManagerInfo: Removed broadcast_7_piece0 on 172.27.188.152:34685 in memory (size: 89.4 KiB, free: 366.2 MiB)
23/03/10 11:00:24 INFO BlockManagerInfo: Removed broadcast_8_piece0 on 172.27.188.152:33271 in memory (size: 37.6 KiB, free: 366.2 MiB)
23/03/10 11:00:24 INFO BlockManagerInfo: Removed broadcast_8_piece0 on 172.27.188.152:34685 in memory (size: 37.6 KiB, free: 366.3 MiB)
23/03/10 11:00:25 INFO BlockManagerInfo: Removed broadcast_4_piece0 on 172.27.188.152:33271 in memory (size: 18.2 KiB, free: 366.2 MiB)
23/03/10 11:00:25 INFO BlockManagerInfo: Removed broadcast_4_piece0 on 172.27.188.152:34685 in memory (size: 18.2 KiB, free: 366.3 MiB)
23/03/10 11:00:25 INFO BlockManagerInfo: Added broadcast_11_piece0 in memory on 172.27.188.152:34685 (size: 34.8 KiB, free: 366.2 MiB)
23/03/10 11:00:25 INFO TaskSetManager: Finished task 1.0 in stage 11.0 (TID 9) in 1093 ms on 172.27.188.152 (executor 0) (1/2)
23/03/10 11:00:25 INFO PythonAccumulatorV2: Connected to AccumulatorServer at host: 127.0.0.1 port: 43467
23/03/10 11:00:26 INFO TaskSetManager: Finished task 0.0 in stage 11.0 (TID 8) in 1194 ms on 172.27.188.152 (executor 0) (2/2)
23/03/10 11:00:26 INFO TaskSchedulerImpl: Removed TaskSet 11.0, whose tasks have all completed, from pool 
23/03/10 11:00:26 INFO DAGScheduler: ShuffleMapStage 11 (save at NativeMethodAccessorImpl.java:0) finished in 1.238 s
23/03/10 11:00:26 INFO DAGScheduler: looking for newly runnable stages
23/03/10 11:00:26 INFO DAGScheduler: running: Set()
23/03/10 11:00:26 INFO DAGScheduler: waiting: Set()
23/03/10 11:00:26 INFO DAGScheduler: failed: Set()
23/03/10 11:00:26 INFO ShufflePartitionsUtil: For shuffle(2), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
23/03/10 11:00:26 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
23/03/10 11:00:26 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
23/03/10 11:00:26 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter
23/03/10 11:00:26 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
23/03/10 11:00:26 INFO CodeGenerator: Code generated in 27.255758 ms
23/03/10 11:00:26 INFO SparkContext: Starting job: save at NativeMethodAccessorImpl.java:0
23/03/10 11:00:26 INFO DAGScheduler: Got job 8 (save at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 11:00:26 INFO DAGScheduler: Final stage: ResultStage 13 (save at NativeMethodAccessorImpl.java:0)
23/03/10 11:00:26 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 12)
23/03/10 11:00:26 INFO DAGScheduler: Missing parents: List()
23/03/10 11:00:26 INFO DAGScheduler: Submitting ResultStage 13 (MapPartitionsRDD[36] at save at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:00:26 INFO MemoryStore: Block broadcast_13 stored as values in memory (estimated size 245.5 KiB, free 365.2 MiB)
23/03/10 11:00:26 INFO MemoryStore: Block broadcast_13_piece0 stored as bytes in memory (estimated size 91.9 KiB, free 365.1 MiB)
23/03/10 11:00:26 INFO BlockManagerInfo: Added broadcast_13_piece0 in memory on 172.27.188.152:33271 (size: 91.9 KiB, free: 366.1 MiB)
23/03/10 11:00:26 INFO SparkContext: Created broadcast 13 from broadcast at DAGScheduler.scala:1513
23/03/10 11:00:26 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 13 (MapPartitionsRDD[36] at save at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 11:00:26 INFO TaskSchedulerImpl: Adding task set 13.0 with 1 tasks resource profile 0
23/03/10 11:00:26 INFO TaskSetManager: Starting task 0.0 in stage 13.0 (TID 10) (172.27.188.152, executor 0, partition 0, NODE_LOCAL, 4457 bytes) taskResourceAssignments Map()
23/03/10 11:00:26 INFO BlockManagerInfo: Added broadcast_13_piece0 in memory on 172.27.188.152:34685 (size: 91.9 KiB, free: 366.2 MiB)
23/03/10 11:00:26 INFO MapOutputTrackerMasterEndpoint: Asked to send map output locations for shuffle 2 to 172.27.188.152:33974
23/03/10 11:00:27 INFO TaskSetManager: Finished task 0.0 in stage 13.0 (TID 10) in 859 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 11:00:27 INFO TaskSchedulerImpl: Removed TaskSet 13.0, whose tasks have all completed, from pool 
23/03/10 11:00:27 INFO DAGScheduler: ResultStage 13 (save at NativeMethodAccessorImpl.java:0) finished in 0.896 s
23/03/10 11:00:27 INFO DAGScheduler: Job 8 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 11:00:27 INFO TaskSchedulerImpl: Killing all running tasks in stage 13: Stage finished
23/03/10 11:00:27 INFO DAGScheduler: Job 8 finished: save at NativeMethodAccessorImpl.java:0, took 0.912072 s
23/03/10 11:00:27 INFO FileFormatWriter: Start to commit write Job 48b427a2-6898-41a9-817b-0feef1c0c7fa.
23/03/10 11:00:27 INFO FileFormatWriter: Write Job 48b427a2-6898-41a9-817b-0feef1c0c7fa committed. Elapsed time: 693 ms.
23/03/10 11:00:27 INFO FileFormatWriter: Finished processing stats for write job 48b427a2-6898-41a9-817b-0feef1c0c7fa.
#######  Created Avro File  #########
23/03/10 11:00:28 INFO InMemoryFileIndex: It took 114 ms to list leaf files for 1 paths.
##########   Avro File Output    ########################
23/03/10 11:00:28 INFO FileSourceStrategy: Pushed Filters: 
23/03/10 11:00:28 INFO FileSourceStrategy: Post-Scan Filters: 
23/03/10 11:00:28 INFO FileSourceStrategy: Output Data Schema: struct<age_cat: string, count: bigint>
23/03/10 11:00:28 INFO CodeGenerator: Code generated in 12.39795 ms
23/03/10 11:00:28 INFO MemoryStore: Block broadcast_14 stored as values in memory (estimated size 352.9 KiB, free 364.8 MiB)
23/03/10 11:00:28 INFO MemoryStore: Block broadcast_14_piece0 stored as bytes in memory (estimated size 34.8 KiB, free 364.8 MiB)
23/03/10 11:00:28 INFO BlockManagerInfo: Added broadcast_14_piece0 in memory on 172.27.188.152:33271 (size: 34.8 KiB, free: 366.1 MiB)
23/03/10 11:00:28 INFO SparkContext: Created broadcast 14 from showString at NativeMethodAccessorImpl.java:0
23/03/10 11:00:28 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 11:00:28 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
23/03/10 11:00:28 INFO DAGScheduler: Got job 9 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 11:00:28 INFO DAGScheduler: Final stage: ResultStage 14 (showString at NativeMethodAccessorImpl.java:0)
23/03/10 11:00:28 INFO DAGScheduler: Parents of final stage: List()
23/03/10 11:00:28 INFO DAGScheduler: Missing parents: List()
23/03/10 11:00:28 INFO DAGScheduler: Submitting ResultStage 14 (MapPartitionsRDD[40] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:00:28 INFO MemoryStore: Block broadcast_15 stored as values in memory (estimated size 12.0 KiB, free 364.8 MiB)
23/03/10 11:00:28 INFO MemoryStore: Block broadcast_15_piece0 stored as bytes in memory (estimated size 6.0 KiB, free 364.8 MiB)
23/03/10 11:00:28 INFO BlockManagerInfo: Added broadcast_15_piece0 in memory on 172.27.188.152:33271 (size: 6.0 KiB, free: 366.1 MiB)
23/03/10 11:00:28 INFO SparkContext: Created broadcast 15 from broadcast at DAGScheduler.scala:1513
23/03/10 11:00:28 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 14 (MapPartitionsRDD[40] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 11:00:28 INFO TaskSchedulerImpl: Adding task set 14.0 with 1 tasks resource profile 0
23/03/10 11:00:28 INFO TaskSetManager: Starting task 0.0 in stage 14.0 (TID 11) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 5043 bytes) taskResourceAssignments Map()
23/03/10 11:00:28 INFO BlockManagerInfo: Added broadcast_15_piece0 in memory on 172.27.188.152:34685 (size: 6.0 KiB, free: 366.1 MiB)
23/03/10 11:00:28 INFO BlockManagerInfo: Added broadcast_14_piece0 in memory on 172.27.188.152:34685 (size: 34.8 KiB, free: 366.1 MiB)
23/03/10 11:00:28 INFO TaskSetManager: Finished task 0.0 in stage 14.0 (TID 11) in 270 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 11:00:28 INFO TaskSchedulerImpl: Removed TaskSet 14.0, whose tasks have all completed, from pool 
23/03/10 11:00:28 INFO DAGScheduler: ResultStage 14 (showString at NativeMethodAccessorImpl.java:0) finished in 0.289 s
23/03/10 11:00:28 INFO DAGScheduler: Job 9 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 11:00:28 INFO TaskSchedulerImpl: Killing all running tasks in stage 14: Stage finished
23/03/10 11:00:28 INFO DAGScheduler: Job 9 finished: showString at NativeMethodAccessorImpl.java:0, took 0.300184 s
+-------+-----+
|age_cat|count|
+-------+-----+
|  Young| 2924|
+-------+-----+

None
23/03/10 11:00:28 INFO SparkContext: Invoking stop() from shutdown hook
23/03/10 11:00:28 INFO SparkUI: Stopped Spark web UI at http://172.27.188.152:4040
23/03/10 11:00:28 INFO StandaloneSchedulerBackend: Shutting down all executors
23/03/10 11:00:28 INFO CoarseGrainedSchedulerBackend$DriverEndpoint: Asking each executor to shut down
23/03/10 11:00:28 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
23/03/10 11:00:28 INFO MemoryStore: MemoryStore cleared
23/03/10 11:00:28 INFO BlockManager: BlockManager stopped
23/03/10 11:00:28 INFO BlockManagerMaster: BlockManagerMaster stopped
23/03/10 11:00:28 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
23/03/10 11:00:28 INFO SparkContext: Successfully stopped SparkContext
23/03/10 11:00:28 INFO ShutdownHookManager: Shutdown hook called
23/03/10 11:00:28 INFO ShutdownHookManager: Deleting directory /tmp/spark-f7c9cc38-396c-4d00-b8de-18f06f20fa34
23/03/10 11:00:28 INFO ShutdownHookManager: Deleting directory /tmp/spark-47fa4466-9e1e-4623-9fcb-b88244b93585/pyspark-6b1a66c4-931a-4d68-9c6d-31ef8eec3af4
23/03/10 11:00:28 INFO ShutdownHookManager: Deleting directory /tmp/spark-47fa4466-9e1e-4623-9fcb-b88244b93585
##### Finished Executor #####
============================================
============================================
Fri Mar 10 05:35:01 UTC 2023
##### Started Executor #####
23/03/10 11:05:03 WARN Utils: Your hostname, MILES-BL-4819-LAP resolves to a loopback address: 127.0.1.1; using 172.27.188.152 instead (on interface eth0)
23/03/10 11:05:03 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
:: loading settings :: url = jar:file:/opt/spark/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml
23/03/10 11:05:05 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
23/03/10 11:05:06 INFO SparkContext: Running Spark version 3.3.2
23/03/10 11:05:06 INFO ResourceUtils: ==============================================================
23/03/10 11:05:06 INFO ResourceUtils: No custom resources configured for spark.driver.
23/03/10 11:05:06 INFO ResourceUtils: ==============================================================
23/03/10 11:05:06 INFO SparkContext: Submitted application: Bank Market
23/03/10 11:05:06 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
23/03/10 11:05:06 INFO ResourceProfile: Limiting resource is cpu
23/03/10 11:05:06 INFO ResourceProfileManager: Added ResourceProfile id: 0
23/03/10 11:05:06 INFO SecurityManager: Changing view acls to: shashi
23/03/10 11:05:06 INFO SecurityManager: Changing modify acls to: shashi
23/03/10 11:05:06 INFO SecurityManager: Changing view acls groups to: 
23/03/10 11:05:06 INFO SecurityManager: Changing modify acls groups to: 
23/03/10 11:05:06 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(shashi); groups with view permissions: Set(); users  with modify permissions: Set(shashi); groups with modify permissions: Set()
23/03/10 11:05:07 INFO Utils: Successfully started service 'sparkDriver' on port 39183.
23/03/10 11:05:07 INFO SparkEnv: Registering MapOutputTracker
23/03/10 11:05:07 INFO SparkEnv: Registering BlockManagerMaster
23/03/10 11:05:07 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
23/03/10 11:05:07 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
23/03/10 11:05:07 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
23/03/10 11:05:07 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-c9c907f4-eef2-4352-abcd-72d201f994b6
23/03/10 11:05:07 INFO MemoryStore: MemoryStore started with capacity 366.3 MiB
23/03/10 11:05:07 INFO SparkEnv: Registering OutputCommitCoordinator
23/03/10 11:05:07 INFO Utils: Successfully started service 'SparkUI' on port 4040.
23/03/10 11:05:07 INFO SparkContext: Added JAR file:///home/shashi/.ivy2/jars/org.apache.spark_spark-avro_2.12-3.3.2.jar at spark://172.27.188.152:39183/jars/org.apache.spark_spark-avro_2.12-3.3.2.jar with timestamp 1678426506581
23/03/10 11:05:07 INFO SparkContext: Added JAR file:///home/shashi/.ivy2/jars/org.tukaani_xz-1.9.jar at spark://172.27.188.152:39183/jars/org.tukaani_xz-1.9.jar with timestamp 1678426506581
23/03/10 11:05:07 INFO SparkContext: Added JAR file:///home/shashi/.ivy2/jars/org.spark-project.spark_unused-1.0.0.jar at spark://172.27.188.152:39183/jars/org.spark-project.spark_unused-1.0.0.jar with timestamp 1678426506581
23/03/10 11:05:07 INFO SparkContext: Added file file:///home/shashi/.ivy2/jars/org.apache.spark_spark-avro_2.12-3.3.2.jar at spark://172.27.188.152:39183/files/org.apache.spark_spark-avro_2.12-3.3.2.jar with timestamp 1678426506581
23/03/10 11:05:07 INFO Utils: Copying /home/shashi/.ivy2/jars/org.apache.spark_spark-avro_2.12-3.3.2.jar to /tmp/spark-ca0cb18e-d5b4-487b-a25b-04d33718acfd/userFiles-38dd04aa-2214-49ee-a644-c4a00649ed17/org.apache.spark_spark-avro_2.12-3.3.2.jar
23/03/10 11:05:07 INFO SparkContext: Added file file:///home/shashi/.ivy2/jars/org.tukaani_xz-1.9.jar at spark://172.27.188.152:39183/files/org.tukaani_xz-1.9.jar with timestamp 1678426506581
23/03/10 11:05:07 INFO Utils: Copying /home/shashi/.ivy2/jars/org.tukaani_xz-1.9.jar to /tmp/spark-ca0cb18e-d5b4-487b-a25b-04d33718acfd/userFiles-38dd04aa-2214-49ee-a644-c4a00649ed17/org.tukaani_xz-1.9.jar
23/03/10 11:05:07 INFO SparkContext: Added file file:///home/shashi/.ivy2/jars/org.spark-project.spark_unused-1.0.0.jar at spark://172.27.188.152:39183/files/org.spark-project.spark_unused-1.0.0.jar with timestamp 1678426506581
23/03/10 11:05:07 INFO Utils: Copying /home/shashi/.ivy2/jars/org.spark-project.spark_unused-1.0.0.jar to /tmp/spark-ca0cb18e-d5b4-487b-a25b-04d33718acfd/userFiles-38dd04aa-2214-49ee-a644-c4a00649ed17/org.spark-project.spark_unused-1.0.0.jar
23/03/10 11:05:07 INFO StandaloneAppClient$ClientEndpoint: Connecting to master spark://MILES-BL-4819-LAP.:7077...
23/03/10 11:05:07 INFO TransportClientFactory: Successfully created connection to MILES-BL-4819-LAP./127.0.1.1:7077 after 32 ms (0 ms spent in bootstraps)
23/03/10 11:05:08 INFO StandaloneSchedulerBackend: Connected to Spark cluster with app ID app-20230310110508-0005
23/03/10 11:05:08 INFO StandaloneAppClient$ClientEndpoint: Executor added: app-20230310110508-0005/0 on worker-20230309123128-172.27.188.152-45151 (172.27.188.152:45151) with 8 core(s)
23/03/10 11:05:08 INFO StandaloneSchedulerBackend: Granted executor ID app-20230310110508-0005/0 on hostPort 172.27.188.152:45151 with 8 core(s), 1024.0 MiB RAM
23/03/10 11:05:08 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 34675.
23/03/10 11:05:08 INFO NettyBlockTransferService: Server created on 172.27.188.152:34675
23/03/10 11:05:08 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
23/03/10 11:05:08 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, 172.27.188.152, 34675, None)
23/03/10 11:05:08 INFO BlockManagerMasterEndpoint: Registering block manager 172.27.188.152:34675 with 366.3 MiB RAM, BlockManagerId(driver, 172.27.188.152, 34675, None)
23/03/10 11:05:08 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, 172.27.188.152, 34675, None)
23/03/10 11:05:08 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, 172.27.188.152, 34675, None)
23/03/10 11:05:08 INFO StandaloneAppClient$ClientEndpoint: Executor updated: app-20230310110508-0005/0 is now RUNNING
23/03/10 11:05:08 INFO SingleEventLogFileWriter: Logging events to file:/tmp/spark-events/app-20230310110508-0005.inprogress
23/03/10 11:05:08 INFO StandaloneSchedulerBackend: SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio: 0.0
23/03/10 11:05:09 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
23/03/10 11:05:09 INFO SharedState: Warehouse path is 'file:/home/shashi/spark-warehouse'.
23/03/10 11:05:10 INFO InMemoryFileIndex: It took 118 ms to list leaf files for 1 paths.
23/03/10 11:05:10 INFO InMemoryFileIndex: It took 74 ms to list leaf files for 1 paths.
23/03/10 11:05:12 INFO CoarseGrainedSchedulerBackend$DriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (172.27.188.152:51312) with ID 0,  ResourceProfileId 0
23/03/10 11:05:12 INFO BlockManagerMasterEndpoint: Registering block manager 172.27.188.152:38753 with 366.3 MiB RAM, BlockManagerId(0, 172.27.188.152, 38753, None)
23/03/10 11:05:14 INFO FileSourceStrategy: Pushed Filters: 
23/03/10 11:05:14 INFO FileSourceStrategy: Post-Scan Filters: (length(trim(value#0, None)) > 0)
23/03/10 11:05:14 INFO FileSourceStrategy: Output Data Schema: struct<value: string>
23/03/10 11:05:15 INFO CodeGenerator: Code generated in 305.716389 ms
23/03/10 11:05:15 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 353.3 KiB, free 366.0 MiB)
23/03/10 11:05:15 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 34.7 KiB, free 365.9 MiB)
23/03/10 11:05:15 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 172.27.188.152:34675 (size: 34.7 KiB, free: 366.3 MiB)
23/03/10 11:05:15 INFO SparkContext: Created broadcast 0 from load at NativeMethodAccessorImpl.java:0
23/03/10 11:05:15 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 11:05:16 INFO SparkContext: Starting job: load at NativeMethodAccessorImpl.java:0
23/03/10 11:05:16 INFO DAGScheduler: Got job 0 (load at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 11:05:16 INFO DAGScheduler: Final stage: ResultStage 0 (load at NativeMethodAccessorImpl.java:0)
23/03/10 11:05:16 INFO DAGScheduler: Parents of final stage: List()
23/03/10 11:05:16 INFO DAGScheduler: Missing parents: List()
23/03/10 11:05:16 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at load at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:05:16 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 11.9 KiB, free 365.9 MiB)
23/03/10 11:05:16 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 5.9 KiB, free 365.9 MiB)
23/03/10 11:05:16 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on 172.27.188.152:34675 (size: 5.9 KiB, free: 366.3 MiB)
23/03/10 11:05:16 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1513
23/03/10 11:05:16 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at load at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 11:05:16 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
23/03/10 11:05:16 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 4985 bytes) taskResourceAssignments Map()
23/03/10 11:05:16 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on 172.27.188.152:38753 (size: 5.9 KiB, free: 366.3 MiB)
23/03/10 11:05:17 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 172.27.188.152:38753 (size: 34.7 KiB, free: 366.3 MiB)
23/03/10 11:05:18 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 1965 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 11:05:18 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool 
23/03/10 11:05:18 INFO DAGScheduler: ResultStage 0 (load at NativeMethodAccessorImpl.java:0) finished in 2.143 s
23/03/10 11:05:18 INFO DAGScheduler: Job 0 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 11:05:18 INFO TaskSchedulerImpl: Killing all running tasks in stage 0: Stage finished
23/03/10 11:05:18 INFO DAGScheduler: Job 0 finished: load at NativeMethodAccessorImpl.java:0, took 2.240927 s
23/03/10 11:05:18 INFO CodeGenerator: Code generated in 15.727534 ms
23/03/10 11:05:18 INFO BlockManagerInfo: Removed broadcast_1_piece0 on 172.27.188.152:34675 in memory (size: 5.9 KiB, free: 366.3 MiB)
23/03/10 11:05:18 INFO BlockManagerInfo: Removed broadcast_1_piece0 on 172.27.188.152:38753 in memory (size: 5.9 KiB, free: 366.3 MiB)
23/03/10 11:05:18 INFO FileSourceStrategy: Pushed Filters: 
23/03/10 11:05:18 INFO FileSourceStrategy: Post-Scan Filters: 
23/03/10 11:05:18 INFO FileSourceStrategy: Output Data Schema: struct<value: string>
23/03/10 11:05:18 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 353.3 KiB, free 365.6 MiB)
23/03/10 11:05:18 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 34.7 KiB, free 365.5 MiB)
23/03/10 11:05:18 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on 172.27.188.152:34675 (size: 34.7 KiB, free: 366.2 MiB)
23/03/10 11:05:18 INFO SparkContext: Created broadcast 2 from load at NativeMethodAccessorImpl.java:0
23/03/10 11:05:18 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 11:05:18 INFO FileSourceStrategy: Pushed Filters: IsNotNull(y),EqualTo(y,yes)
23/03/10 11:05:18 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(y#33),(y#33 = yes)
23/03/10 11:05:18 INFO FileSourceStrategy: Output Data Schema: struct<age: string, y: string>
23/03/10 11:05:19 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
23/03/10 11:05:19 INFO CodeGenerator: Code generated in 90.803986 ms
23/03/10 11:05:19 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 353.2 KiB, free 365.2 MiB)
23/03/10 11:05:19 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 34.7 KiB, free 365.2 MiB)
23/03/10 11:05:19 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on 172.27.188.152:34675 (size: 34.7 KiB, free: 366.2 MiB)
23/03/10 11:05:19 INFO SparkContext: Created broadcast 3 from parquet at NativeMethodAccessorImpl.java:0
23/03/10 11:05:19 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 11:05:19 INFO DAGScheduler: Registering RDD 13 (parquet at NativeMethodAccessorImpl.java:0) as input to shuffle 0
23/03/10 11:05:19 INFO DAGScheduler: Got map stage job 1 (parquet at NativeMethodAccessorImpl.java:0) with 2 output partitions
23/03/10 11:05:19 INFO DAGScheduler: Final stage: ShuffleMapStage 1 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 11:05:19 INFO DAGScheduler: Parents of final stage: List()
23/03/10 11:05:19 INFO DAGScheduler: Missing parents: List()
23/03/10 11:05:19 INFO DAGScheduler: Submitting ShuffleMapStage 1 (MapPartitionsRDD[13] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:05:19 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 38.5 KiB, free 365.1 MiB)
23/03/10 11:05:19 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 18.2 KiB, free 365.1 MiB)
23/03/10 11:05:19 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on 172.27.188.152:34675 (size: 18.2 KiB, free: 366.2 MiB)
23/03/10 11:05:19 INFO SparkContext: Created broadcast 4 from broadcast at DAGScheduler.scala:1513
23/03/10 11:05:19 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 1 (MapPartitionsRDD[13] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
23/03/10 11:05:19 INFO TaskSchedulerImpl: Adding task set 1.0 with 2 tasks resource profile 0
23/03/10 11:05:19 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 1) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 4974 bytes) taskResourceAssignments Map()
23/03/10 11:05:19 INFO TaskSetManager: Starting task 1.0 in stage 1.0 (TID 2) (172.27.188.152, executor 0, partition 1, PROCESS_LOCAL, 4974 bytes) taskResourceAssignments Map()
23/03/10 11:05:19 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on 172.27.188.152:38753 (size: 18.2 KiB, free: 366.2 MiB)
23/03/10 11:05:20 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on 172.27.188.152:38753 (size: 34.7 KiB, free: 366.2 MiB)
23/03/10 11:05:20 INFO TaskSetManager: Finished task 1.0 in stage 1.0 (TID 2) in 1001 ms on 172.27.188.152 (executor 0) (1/2)
23/03/10 11:05:20 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 1) in 1092 ms on 172.27.188.152 (executor 0) (2/2)
23/03/10 11:05:20 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool 
23/03/10 11:05:20 INFO DAGScheduler: ShuffleMapStage 1 (parquet at NativeMethodAccessorImpl.java:0) finished in 1.123 s
23/03/10 11:05:20 INFO DAGScheduler: looking for newly runnable stages
23/03/10 11:05:20 INFO DAGScheduler: running: Set()
23/03/10 11:05:20 INFO DAGScheduler: waiting: Set()
23/03/10 11:05:20 INFO DAGScheduler: failed: Set()
23/03/10 11:05:20 INFO ShufflePartitionsUtil: For shuffle(0), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
23/03/10 11:05:20 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
23/03/10 11:05:20 INFO CodeGenerator: Code generated in 28.823216 ms
23/03/10 11:05:20 INFO CodeGenerator: Code generated in 22.745814 ms
23/03/10 11:05:20 INFO SparkContext: Starting job: parquet at NativeMethodAccessorImpl.java:0
23/03/10 11:05:20 INFO DAGScheduler: Got job 2 (parquet at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 11:05:20 INFO DAGScheduler: Final stage: ResultStage 3 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 11:05:20 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 2)
23/03/10 11:05:20 INFO DAGScheduler: Missing parents: List()
23/03/10 11:05:20 INFO DAGScheduler: Submitting ResultStage 3 (MapPartitionsRDD[18] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:05:21 INFO MemoryStore: Block broadcast_5 stored as values in memory (estimated size 40.0 KiB, free 365.1 MiB)
23/03/10 11:05:21 INFO MemoryStore: Block broadcast_5_piece0 stored as bytes in memory (estimated size 19.2 KiB, free 365.1 MiB)
23/03/10 11:05:21 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on 172.27.188.152:34675 (size: 19.2 KiB, free: 366.2 MiB)
23/03/10 11:05:21 INFO SparkContext: Created broadcast 5 from broadcast at DAGScheduler.scala:1513
23/03/10 11:05:21 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 3 (MapPartitionsRDD[18] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 11:05:21 INFO TaskSchedulerImpl: Adding task set 3.0 with 1 tasks resource profile 0
23/03/10 11:05:21 INFO TaskSetManager: Starting task 0.0 in stage 3.0 (TID 3) (172.27.188.152, executor 0, partition 0, NODE_LOCAL, 4457 bytes) taskResourceAssignments Map()
23/03/10 11:05:21 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on 172.27.188.152:38753 (size: 19.2 KiB, free: 366.2 MiB)
23/03/10 11:05:21 INFO MapOutputTrackerMasterEndpoint: Asked to send map output locations for shuffle 0 to 172.27.188.152:51312
23/03/10 11:05:21 INFO TaskSetManager: Finished task 0.0 in stage 3.0 (TID 3) in 349 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 11:05:21 INFO TaskSchedulerImpl: Removed TaskSet 3.0, whose tasks have all completed, from pool 
23/03/10 11:05:21 INFO DAGScheduler: ResultStage 3 (parquet at NativeMethodAccessorImpl.java:0) finished in 0.379 s
23/03/10 11:05:21 INFO DAGScheduler: Job 2 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 11:05:21 INFO TaskSchedulerImpl: Killing all running tasks in stage 3: Stage finished
23/03/10 11:05:21 INFO DAGScheduler: Job 2 finished: parquet at NativeMethodAccessorImpl.java:0, took 0.444268 s
23/03/10 11:05:21 INFO DAGScheduler: Registering RDD 19 (parquet at NativeMethodAccessorImpl.java:0) as input to shuffle 1
23/03/10 11:05:21 INFO DAGScheduler: Got map stage job 3 (parquet at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 11:05:21 INFO DAGScheduler: Final stage: ShuffleMapStage 5 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 11:05:21 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 4)
23/03/10 11:05:21 INFO DAGScheduler: Missing parents: List()
23/03/10 11:05:21 INFO DAGScheduler: Submitting ShuffleMapStage 5 (MapPartitionsRDD[19] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:05:21 INFO MemoryStore: Block broadcast_6 stored as values in memory (estimated size 42.0 KiB, free 365.0 MiB)
23/03/10 11:05:21 INFO MemoryStore: Block broadcast_6_piece0 stored as bytes in memory (estimated size 19.9 KiB, free 365.0 MiB)
23/03/10 11:05:21 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on 172.27.188.152:34675 (size: 19.9 KiB, free: 366.1 MiB)
23/03/10 11:05:21 INFO SparkContext: Created broadcast 6 from broadcast at DAGScheduler.scala:1513
23/03/10 11:05:21 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 5 (MapPartitionsRDD[19] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 11:05:21 INFO TaskSchedulerImpl: Adding task set 5.0 with 1 tasks resource profile 0
23/03/10 11:05:21 INFO TaskSetManager: Starting task 0.0 in stage 5.0 (TID 4) (172.27.188.152, executor 0, partition 0, NODE_LOCAL, 4446 bytes) taskResourceAssignments Map()
23/03/10 11:05:21 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on 172.27.188.152:38753 (size: 19.9 KiB, free: 366.2 MiB)
23/03/10 11:05:21 INFO TaskSetManager: Finished task 0.0 in stage 5.0 (TID 4) in 124 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 11:05:21 INFO TaskSchedulerImpl: Removed TaskSet 5.0, whose tasks have all completed, from pool 
23/03/10 11:05:21 INFO DAGScheduler: ShuffleMapStage 5 (parquet at NativeMethodAccessorImpl.java:0) finished in 0.155 s
23/03/10 11:05:21 INFO DAGScheduler: looking for newly runnable stages
23/03/10 11:05:21 INFO DAGScheduler: running: Set()
23/03/10 11:05:21 INFO DAGScheduler: waiting: Set()
23/03/10 11:05:21 INFO DAGScheduler: failed: Set()
23/03/10 11:05:21 INFO ShufflePartitionsUtil: For shuffle(1), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
23/03/10 11:05:21 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
23/03/10 11:05:21 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
23/03/10 11:05:21 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
23/03/10 11:05:21 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
23/03/10 11:05:21 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
23/03/10 11:05:21 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
23/03/10 11:05:21 INFO CodeGenerator: Code generated in 13.752867 ms
23/03/10 11:05:21 INFO SparkContext: Starting job: parquet at NativeMethodAccessorImpl.java:0
23/03/10 11:05:21 INFO DAGScheduler: Got job 4 (parquet at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 11:05:21 INFO DAGScheduler: Final stage: ResultStage 8 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 11:05:21 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 7)
23/03/10 11:05:21 INFO DAGScheduler: Missing parents: List()
23/03/10 11:05:21 INFO DAGScheduler: Submitting ResultStage 8 (MapPartitionsRDD[21] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:05:21 INFO MemoryStore: Block broadcast_7 stored as values in memory (estimated size 240.4 KiB, free 364.8 MiB)
23/03/10 11:05:21 INFO MemoryStore: Block broadcast_7_piece0 stored as bytes in memory (estimated size 89.3 KiB, free 364.7 MiB)
23/03/10 11:05:21 INFO BlockManagerInfo: Added broadcast_7_piece0 in memory on 172.27.188.152:34675 (size: 89.3 KiB, free: 366.1 MiB)
23/03/10 11:05:21 INFO SparkContext: Created broadcast 7 from broadcast at DAGScheduler.scala:1513
23/03/10 11:05:21 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 8 (MapPartitionsRDD[21] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 11:05:21 INFO TaskSchedulerImpl: Adding task set 8.0 with 1 tasks resource profile 0
23/03/10 11:05:21 INFO TaskSetManager: Starting task 0.0 in stage 8.0 (TID 5) (172.27.188.152, executor 0, partition 0, NODE_LOCAL, 4457 bytes) taskResourceAssignments Map()
23/03/10 11:05:21 INFO BlockManagerInfo: Added broadcast_7_piece0 in memory on 172.27.188.152:38753 (size: 89.3 KiB, free: 366.1 MiB)
23/03/10 11:05:21 INFO MapOutputTrackerMasterEndpoint: Asked to send map output locations for shuffle 1 to 172.27.188.152:51312
23/03/10 11:05:23 INFO TaskSetManager: Finished task 0.0 in stage 8.0 (TID 5) in 1744 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 11:05:23 INFO TaskSchedulerImpl: Removed TaskSet 8.0, whose tasks have all completed, from pool 
23/03/10 11:05:23 INFO DAGScheduler: ResultStage 8 (parquet at NativeMethodAccessorImpl.java:0) finished in 1.790 s
23/03/10 11:05:23 INFO DAGScheduler: Job 4 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 11:05:23 INFO TaskSchedulerImpl: Killing all running tasks in stage 8: Stage finished
23/03/10 11:05:23 INFO DAGScheduler: Job 4 finished: parquet at NativeMethodAccessorImpl.java:0, took 1.806620 s
23/03/10 11:05:23 INFO FileFormatWriter: Start to commit write Job 2dd51723-d9eb-436c-9073-b8732bbc246f.
23/03/10 11:05:24 INFO FileFormatWriter: Write Job 2dd51723-d9eb-436c-9073-b8732bbc246f committed. Elapsed time: 810 ms.
23/03/10 11:05:24 INFO FileFormatWriter: Finished processing stats for write job 2dd51723-d9eb-436c-9073-b8732bbc246f.
#######  Created Parquet File  #########
23/03/10 11:05:24 INFO InMemoryFileIndex: It took 126 ms to list leaf files for 1 paths.
23/03/10 11:05:24 INFO SparkContext: Starting job: parquet at NativeMethodAccessorImpl.java:0
23/03/10 11:05:24 INFO DAGScheduler: Got job 5 (parquet at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 11:05:24 INFO DAGScheduler: Final stage: ResultStage 9 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 11:05:24 INFO DAGScheduler: Parents of final stage: List()
23/03/10 11:05:24 INFO DAGScheduler: Missing parents: List()
23/03/10 11:05:24 INFO DAGScheduler: Submitting ResultStage 9 (MapPartitionsRDD[23] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:05:24 INFO MemoryStore: Block broadcast_8 stored as values in memory (estimated size 104.4 KiB, free 364.6 MiB)
23/03/10 11:05:24 INFO MemoryStore: Block broadcast_8_piece0 stored as bytes in memory (estimated size 37.5 KiB, free 364.5 MiB)
23/03/10 11:05:24 INFO BlockManagerInfo: Added broadcast_8_piece0 in memory on 172.27.188.152:34675 (size: 37.5 KiB, free: 366.0 MiB)
23/03/10 11:05:24 INFO SparkContext: Created broadcast 8 from broadcast at DAGScheduler.scala:1513
23/03/10 11:05:24 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 9 (MapPartitionsRDD[23] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 11:05:24 INFO TaskSchedulerImpl: Adding task set 9.0 with 1 tasks resource profile 0
23/03/10 11:05:24 INFO TaskSetManager: Starting task 0.0 in stage 9.0 (TID 6) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 4731 bytes) taskResourceAssignments Map()
23/03/10 11:05:24 INFO BlockManagerInfo: Added broadcast_8_piece0 in memory on 172.27.188.152:38753 (size: 37.5 KiB, free: 366.1 MiB)
23/03/10 11:05:24 INFO TaskSetManager: Finished task 0.0 in stage 9.0 (TID 6) in 190 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 11:05:24 INFO TaskSchedulerImpl: Removed TaskSet 9.0, whose tasks have all completed, from pool 
23/03/10 11:05:24 INFO DAGScheduler: ResultStage 9 (parquet at NativeMethodAccessorImpl.java:0) finished in 0.214 s
23/03/10 11:05:24 INFO DAGScheduler: Job 5 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 11:05:24 INFO TaskSchedulerImpl: Killing all running tasks in stage 9: Stage finished
23/03/10 11:05:24 INFO DAGScheduler: Job 5 finished: parquet at NativeMethodAccessorImpl.java:0, took 0.225647 s
##########   Parquet File Output    ########################
23/03/10 11:05:24 INFO FileSourceStrategy: Pushed Filters: 
23/03/10 11:05:24 INFO FileSourceStrategy: Post-Scan Filters: 
23/03/10 11:05:24 INFO FileSourceStrategy: Output Data Schema: struct<age: string, count: bigint>
23/03/10 11:05:24 INFO CodeGenerator: Code generated in 18.691609 ms
23/03/10 11:05:25 INFO MemoryStore: Block broadcast_9 stored as values in memory (estimated size 357.5 KiB, free 364.2 MiB)
23/03/10 11:05:25 INFO MemoryStore: Block broadcast_9_piece0 stored as bytes in memory (estimated size 35.4 KiB, free 364.1 MiB)
23/03/10 11:05:25 INFO BlockManagerInfo: Added broadcast_9_piece0 in memory on 172.27.188.152:34675 (size: 35.4 KiB, free: 366.0 MiB)
23/03/10 11:05:25 INFO SparkContext: Created broadcast 9 from showString at NativeMethodAccessorImpl.java:0
23/03/10 11:05:25 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 11:05:25 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
23/03/10 11:05:25 INFO DAGScheduler: Got job 6 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 11:05:25 INFO DAGScheduler: Final stage: ResultStage 10 (showString at NativeMethodAccessorImpl.java:0)
23/03/10 11:05:25 INFO DAGScheduler: Parents of final stage: List()
23/03/10 11:05:25 INFO DAGScheduler: Missing parents: List()
23/03/10 11:05:25 INFO DAGScheduler: Submitting ResultStage 10 (MapPartitionsRDD[27] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:05:25 INFO MemoryStore: Block broadcast_10 stored as values in memory (estimated size 13.6 KiB, free 364.1 MiB)
23/03/10 11:05:25 INFO MemoryStore: Block broadcast_10_piece0 stored as bytes in memory (estimated size 6.1 KiB, free 364.1 MiB)
23/03/10 11:05:25 INFO BlockManagerInfo: Added broadcast_10_piece0 in memory on 172.27.188.152:34675 (size: 6.1 KiB, free: 366.0 MiB)
23/03/10 11:05:25 INFO SparkContext: Created broadcast 10 from broadcast at DAGScheduler.scala:1513
23/03/10 11:05:25 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 10 (MapPartitionsRDD[27] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 11:05:25 INFO TaskSchedulerImpl: Adding task set 10.0 with 1 tasks resource profile 0
23/03/10 11:05:25 INFO TaskSetManager: Starting task 0.0 in stage 10.0 (TID 7) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 5056 bytes) taskResourceAssignments Map()
23/03/10 11:05:25 INFO BlockManagerInfo: Added broadcast_10_piece0 in memory on 172.27.188.152:38753 (size: 6.1 KiB, free: 366.0 MiB)
23/03/10 11:05:25 INFO BlockManagerInfo: Added broadcast_9_piece0 in memory on 172.27.188.152:38753 (size: 35.4 KiB, free: 366.0 MiB)
23/03/10 11:05:25 INFO TaskSetManager: Finished task 0.0 in stage 10.0 (TID 7) in 385 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 11:05:25 INFO TaskSchedulerImpl: Removed TaskSet 10.0, whose tasks have all completed, from pool 
23/03/10 11:05:25 INFO DAGScheduler: ResultStage 10 (showString at NativeMethodAccessorImpl.java:0) finished in 0.406 s
23/03/10 11:05:25 INFO DAGScheduler: Job 6 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 11:05:25 INFO TaskSchedulerImpl: Killing all running tasks in stage 10: Stage finished
23/03/10 11:05:25 INFO DAGScheduler: Job 6 finished: showString at NativeMethodAccessorImpl.java:0, took 0.417637 s
23/03/10 11:05:25 INFO CodeGenerator: Code generated in 9.693224 ms
+---+-----+
|age|count|
+---+-----+
| 32|  221|
| 30|  217|
| 33|  210|
| 35|  209|
| 31|  206|
| 34|  198|
| 36|  195|
| 29|  171|
| 37|  170|
| 28|  162|
| 38|  144|
| 39|  143|
| 27|  141|
| 26|  134|
| 41|  120|
| 46|  118|
| 40|  116|
| 47|  113|
| 25|  113|
| 42|  111|
+---+-----+
only showing top 20 rows

None
23/03/10 11:05:25 INFO FileSourceStrategy: Pushed Filters: IsNotNull(y),EqualTo(y,yes)
23/03/10 11:05:25 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(y#33),(y#33 = yes)
23/03/10 11:05:25 INFO FileSourceStrategy: Output Data Schema: struct<age: string, y: string>
23/03/10 11:05:25 INFO BlockManagerInfo: Removed broadcast_0_piece0 on 172.27.188.152:34675 in memory (size: 34.7 KiB, free: 366.0 MiB)
23/03/10 11:05:25 INFO BlockManagerInfo: Removed broadcast_0_piece0 on 172.27.188.152:38753 in memory (size: 34.7 KiB, free: 366.0 MiB)
23/03/10 11:05:25 INFO BlockManagerInfo: Removed broadcast_5_piece0 on 172.27.188.152:34675 in memory (size: 19.2 KiB, free: 366.0 MiB)
23/03/10 11:05:25 INFO BlockManagerInfo: Removed broadcast_5_piece0 on 172.27.188.152:38753 in memory (size: 19.2 KiB, free: 366.1 MiB)
23/03/10 11:05:25 INFO BlockManagerInfo: Removed broadcast_7_piece0 on 172.27.188.152:34675 in memory (size: 89.3 KiB, free: 366.1 MiB)
23/03/10 11:05:25 INFO BlockManagerInfo: Removed broadcast_7_piece0 on 172.27.188.152:38753 in memory (size: 89.3 KiB, free: 366.2 MiB)
23/03/10 11:05:25 INFO BlockManagerInfo: Removed broadcast_6_piece0 on 172.27.188.152:34675 in memory (size: 19.9 KiB, free: 366.1 MiB)
23/03/10 11:05:25 INFO BlockManagerInfo: Removed broadcast_6_piece0 on 172.27.188.152:38753 in memory (size: 19.9 KiB, free: 366.2 MiB)
23/03/10 11:05:25 INFO BlockManagerInfo: Removed broadcast_4_piece0 on 172.27.188.152:34675 in memory (size: 18.2 KiB, free: 366.2 MiB)
23/03/10 11:05:25 INFO BlockManagerInfo: Removed broadcast_4_piece0 on 172.27.188.152:38753 in memory (size: 18.2 KiB, free: 366.2 MiB)
23/03/10 11:05:25 INFO BlockManagerInfo: Removed broadcast_3_piece0 on 172.27.188.152:34675 in memory (size: 34.7 KiB, free: 366.2 MiB)
23/03/10 11:05:25 INFO BlockManagerInfo: Removed broadcast_3_piece0 on 172.27.188.152:38753 in memory (size: 34.7 KiB, free: 366.2 MiB)
23/03/10 11:05:25 INFO BlockManagerInfo: Removed broadcast_10_piece0 on 172.27.188.152:34675 in memory (size: 6.1 KiB, free: 366.2 MiB)
23/03/10 11:05:25 INFO BlockManagerInfo: Removed broadcast_10_piece0 on 172.27.188.152:38753 in memory (size: 6.1 KiB, free: 366.2 MiB)
23/03/10 11:05:25 INFO BlockManagerInfo: Removed broadcast_8_piece0 on 172.27.188.152:34675 in memory (size: 37.5 KiB, free: 366.2 MiB)
23/03/10 11:05:25 INFO BlockManagerInfo: Removed broadcast_8_piece0 on 172.27.188.152:38753 in memory (size: 37.5 KiB, free: 366.3 MiB)
23/03/10 11:05:25 INFO deprecation: mapred.output.compress is deprecated. Instead, use mapreduce.output.fileoutputformat.compress
23/03/10 11:05:25 INFO AvroUtils: Compressing Avro output using the snappy codec
23/03/10 11:05:25 INFO CodeGenerator: Code generated in 35.053889 ms
23/03/10 11:05:25 INFO CodeGenerator: Code generated in 11.559348 ms
23/03/10 11:05:25 INFO MemoryStore: Block broadcast_11 stored as values in memory (estimated size 353.2 KiB, free 365.2 MiB)
23/03/10 11:05:26 INFO MemoryStore: Block broadcast_11_piece0 stored as bytes in memory (estimated size 34.7 KiB, free 365.2 MiB)
23/03/10 11:05:26 INFO BlockManagerInfo: Added broadcast_11_piece0 in memory on 172.27.188.152:34675 (size: 34.7 KiB, free: 366.2 MiB)
23/03/10 11:05:26 INFO SparkContext: Created broadcast 11 from save at NativeMethodAccessorImpl.java:0
23/03/10 11:05:26 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 11:05:26 INFO DAGScheduler: Registering RDD 34 (save at NativeMethodAccessorImpl.java:0) as input to shuffle 2
23/03/10 11:05:26 INFO DAGScheduler: Got map stage job 7 (save at NativeMethodAccessorImpl.java:0) with 2 output partitions
23/03/10 11:05:26 INFO DAGScheduler: Final stage: ShuffleMapStage 11 (save at NativeMethodAccessorImpl.java:0)
23/03/10 11:05:26 INFO DAGScheduler: Parents of final stage: List()
23/03/10 11:05:26 INFO DAGScheduler: Missing parents: List()
23/03/10 11:05:26 INFO DAGScheduler: Submitting ShuffleMapStage 11 (MapPartitionsRDD[34] at save at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:05:26 INFO MemoryStore: Block broadcast_12 stored as values in memory (estimated size 46.0 KiB, free 365.1 MiB)
23/03/10 11:05:26 INFO MemoryStore: Block broadcast_12_piece0 stored as bytes in memory (estimated size 21.8 KiB, free 365.1 MiB)
23/03/10 11:05:26 INFO BlockManagerInfo: Added broadcast_12_piece0 in memory on 172.27.188.152:34675 (size: 21.8 KiB, free: 366.2 MiB)
23/03/10 11:05:26 INFO SparkContext: Created broadcast 12 from broadcast at DAGScheduler.scala:1513
23/03/10 11:05:26 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 11 (MapPartitionsRDD[34] at save at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
23/03/10 11:05:26 INFO TaskSchedulerImpl: Adding task set 11.0 with 2 tasks resource profile 0
23/03/10 11:05:26 INFO TaskSetManager: Starting task 0.0 in stage 11.0 (TID 8) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 4974 bytes) taskResourceAssignments Map()
23/03/10 11:05:26 INFO TaskSetManager: Starting task 1.0 in stage 11.0 (TID 9) (172.27.188.152, executor 0, partition 1, PROCESS_LOCAL, 4974 bytes) taskResourceAssignments Map()
23/03/10 11:05:26 INFO BlockManagerInfo: Added broadcast_12_piece0 in memory on 172.27.188.152:38753 (size: 21.8 KiB, free: 366.2 MiB)
23/03/10 11:05:26 INFO BlockManagerInfo: Added broadcast_11_piece0 in memory on 172.27.188.152:38753 (size: 34.7 KiB, free: 366.2 MiB)
23/03/10 11:05:27 INFO TaskSetManager: Finished task 1.0 in stage 11.0 (TID 9) in 1043 ms on 172.27.188.152 (executor 0) (1/2)
23/03/10 11:05:27 INFO PythonAccumulatorV2: Connected to AccumulatorServer at host: 127.0.0.1 port: 46327
23/03/10 11:05:27 INFO TaskSetManager: Finished task 0.0 in stage 11.0 (TID 8) in 1129 ms on 172.27.188.152 (executor 0) (2/2)
23/03/10 11:05:27 INFO TaskSchedulerImpl: Removed TaskSet 11.0, whose tasks have all completed, from pool 
23/03/10 11:05:27 INFO DAGScheduler: ShuffleMapStage 11 (save at NativeMethodAccessorImpl.java:0) finished in 1.150 s
23/03/10 11:05:27 INFO DAGScheduler: looking for newly runnable stages
23/03/10 11:05:27 INFO DAGScheduler: running: Set()
23/03/10 11:05:27 INFO DAGScheduler: waiting: Set()
23/03/10 11:05:27 INFO DAGScheduler: failed: Set()
23/03/10 11:05:27 INFO ShufflePartitionsUtil: For shuffle(2), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
23/03/10 11:05:27 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
23/03/10 11:05:27 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
23/03/10 11:05:27 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter
23/03/10 11:05:27 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
23/03/10 11:05:27 INFO CodeGenerator: Code generated in 12.578517 ms
23/03/10 11:05:27 INFO SparkContext: Starting job: save at NativeMethodAccessorImpl.java:0
23/03/10 11:05:27 INFO DAGScheduler: Got job 8 (save at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 11:05:27 INFO DAGScheduler: Final stage: ResultStage 13 (save at NativeMethodAccessorImpl.java:0)
23/03/10 11:05:27 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 12)
23/03/10 11:05:27 INFO DAGScheduler: Missing parents: List()
23/03/10 11:05:27 INFO DAGScheduler: Submitting ResultStage 13 (MapPartitionsRDD[36] at save at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:05:27 INFO MemoryStore: Block broadcast_13 stored as values in memory (estimated size 245.5 KiB, free 364.9 MiB)
23/03/10 11:05:27 INFO MemoryStore: Block broadcast_13_piece0 stored as bytes in memory (estimated size 91.8 KiB, free 364.8 MiB)
23/03/10 11:05:27 INFO BlockManagerInfo: Added broadcast_13_piece0 in memory on 172.27.188.152:34675 (size: 91.8 KiB, free: 366.1 MiB)
23/03/10 11:05:27 INFO SparkContext: Created broadcast 13 from broadcast at DAGScheduler.scala:1513
23/03/10 11:05:27 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 13 (MapPartitionsRDD[36] at save at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 11:05:27 INFO TaskSchedulerImpl: Adding task set 13.0 with 1 tasks resource profile 0
23/03/10 11:05:27 INFO TaskSetManager: Starting task 0.0 in stage 13.0 (TID 10) (172.27.188.152, executor 0, partition 0, NODE_LOCAL, 4457 bytes) taskResourceAssignments Map()
23/03/10 11:05:27 INFO BlockManagerInfo: Added broadcast_13_piece0 in memory on 172.27.188.152:38753 (size: 91.8 KiB, free: 366.1 MiB)
23/03/10 11:05:27 INFO MapOutputTrackerMasterEndpoint: Asked to send map output locations for shuffle 2 to 172.27.188.152:51312
23/03/10 11:05:28 INFO TaskSetManager: Finished task 0.0 in stage 13.0 (TID 10) in 891 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 11:05:28 INFO TaskSchedulerImpl: Removed TaskSet 13.0, whose tasks have all completed, from pool 
23/03/10 11:05:28 INFO DAGScheduler: ResultStage 13 (save at NativeMethodAccessorImpl.java:0) finished in 0.927 s
23/03/10 11:05:28 INFO DAGScheduler: Job 8 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 11:05:28 INFO TaskSchedulerImpl: Killing all running tasks in stage 13: Stage finished
23/03/10 11:05:28 INFO DAGScheduler: Job 8 finished: save at NativeMethodAccessorImpl.java:0, took 0.943186 s
23/03/10 11:05:28 INFO FileFormatWriter: Start to commit write Job 96881147-2afa-42ad-89af-b5416c61c852.
23/03/10 11:05:29 INFO FileFormatWriter: Write Job 96881147-2afa-42ad-89af-b5416c61c852 committed. Elapsed time: 797 ms.
23/03/10 11:05:29 INFO FileFormatWriter: Finished processing stats for write job 96881147-2afa-42ad-89af-b5416c61c852.
#######  Created Avro File  #########
23/03/10 11:05:29 INFO InMemoryFileIndex: It took 156 ms to list leaf files for 1 paths.
##########   Avro File Output    ########################
23/03/10 11:05:29 INFO FileSourceStrategy: Pushed Filters: 
23/03/10 11:05:29 INFO FileSourceStrategy: Post-Scan Filters: 
23/03/10 11:05:29 INFO FileSourceStrategy: Output Data Schema: struct<age_cat: string, count: bigint>
23/03/10 11:05:29 INFO CodeGenerator: Code generated in 7.487782 ms
23/03/10 11:05:29 INFO MemoryStore: Block broadcast_14 stored as values in memory (estimated size 352.9 KiB, free 364.4 MiB)
23/03/10 11:05:29 INFO MemoryStore: Block broadcast_14_piece0 stored as bytes in memory (estimated size 34.8 KiB, free 364.4 MiB)
23/03/10 11:05:29 INFO BlockManagerInfo: Added broadcast_14_piece0 in memory on 172.27.188.152:34675 (size: 34.8 KiB, free: 366.1 MiB)
23/03/10 11:05:29 INFO SparkContext: Created broadcast 14 from showString at NativeMethodAccessorImpl.java:0
23/03/10 11:05:29 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 11:05:29 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
23/03/10 11:05:29 INFO DAGScheduler: Got job 9 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 11:05:29 INFO DAGScheduler: Final stage: ResultStage 14 (showString at NativeMethodAccessorImpl.java:0)
23/03/10 11:05:29 INFO DAGScheduler: Parents of final stage: List()
23/03/10 11:05:29 INFO DAGScheduler: Missing parents: List()
23/03/10 11:05:29 INFO DAGScheduler: Submitting ResultStage 14 (MapPartitionsRDD[40] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:05:29 INFO MemoryStore: Block broadcast_15 stored as values in memory (estimated size 12.0 KiB, free 364.4 MiB)
23/03/10 11:05:29 INFO MemoryStore: Block broadcast_15_piece0 stored as bytes in memory (estimated size 6.0 KiB, free 364.4 MiB)
23/03/10 11:05:29 INFO BlockManagerInfo: Added broadcast_15_piece0 in memory on 172.27.188.152:34675 (size: 6.0 KiB, free: 366.0 MiB)
23/03/10 11:05:29 INFO SparkContext: Created broadcast 15 from broadcast at DAGScheduler.scala:1513
23/03/10 11:05:29 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 14 (MapPartitionsRDD[40] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 11:05:29 INFO TaskSchedulerImpl: Adding task set 14.0 with 1 tasks resource profile 0
23/03/10 11:05:29 INFO TaskSetManager: Starting task 0.0 in stage 14.0 (TID 11) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 5043 bytes) taskResourceAssignments Map()
23/03/10 11:05:29 INFO BlockManagerInfo: Added broadcast_15_piece0 in memory on 172.27.188.152:38753 (size: 6.0 KiB, free: 366.1 MiB)
23/03/10 11:05:29 INFO BlockManagerInfo: Added broadcast_14_piece0 in memory on 172.27.188.152:38753 (size: 34.8 KiB, free: 366.1 MiB)
23/03/10 11:05:30 INFO TaskSetManager: Finished task 0.0 in stage 14.0 (TID 11) in 299 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 11:05:30 INFO TaskSchedulerImpl: Removed TaskSet 14.0, whose tasks have all completed, from pool 
23/03/10 11:05:30 INFO DAGScheduler: ResultStage 14 (showString at NativeMethodAccessorImpl.java:0) finished in 0.325 s
23/03/10 11:05:30 INFO DAGScheduler: Job 9 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 11:05:30 INFO TaskSchedulerImpl: Killing all running tasks in stage 14: Stage finished
23/03/10 11:05:30 INFO DAGScheduler: Job 9 finished: showString at NativeMethodAccessorImpl.java:0, took 0.337109 s
+-------+-----+
|age_cat|count|
+-------+-----+
|  Young| 2924|
+-------+-----+

None
23/03/10 11:05:30 INFO SparkContext: Invoking stop() from shutdown hook
23/03/10 11:05:30 INFO SparkUI: Stopped Spark web UI at http://172.27.188.152:4040
23/03/10 11:05:30 INFO StandaloneSchedulerBackend: Shutting down all executors
23/03/10 11:05:30 INFO CoarseGrainedSchedulerBackend$DriverEndpoint: Asking each executor to shut down
23/03/10 11:05:30 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
23/03/10 11:05:30 INFO MemoryStore: MemoryStore cleared
23/03/10 11:05:30 INFO BlockManager: BlockManager stopped
23/03/10 11:05:30 INFO BlockManagerMaster: BlockManagerMaster stopped
23/03/10 11:05:30 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
23/03/10 11:05:30 INFO SparkContext: Successfully stopped SparkContext
23/03/10 11:05:30 INFO ShutdownHookManager: Shutdown hook called
23/03/10 11:05:30 INFO ShutdownHookManager: Deleting directory /tmp/spark-f77da921-b675-4fb3-b416-8080f730b662
23/03/10 11:05:30 INFO ShutdownHookManager: Deleting directory /tmp/spark-ca0cb18e-d5b4-487b-a25b-04d33718acfd
23/03/10 11:05:30 INFO ShutdownHookManager: Deleting directory /tmp/spark-ca0cb18e-d5b4-487b-a25b-04d33718acfd/pyspark-7e072049-61a9-4cf6-934d-20d1818c69a9
##### Finished Executor #####
============================================
============================================
Fri Mar 10 05:40:01 UTC 2023
##### Started Executor #####
23/03/10 11:10:03 WARN Utils: Your hostname, MILES-BL-4819-LAP resolves to a loopback address: 127.0.1.1; using 172.27.188.152 instead (on interface eth0)
23/03/10 11:10:03 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
:: loading settings :: url = jar:file:/opt/spark/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml
23/03/10 11:10:05 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
23/03/10 11:10:06 INFO SparkContext: Running Spark version 3.3.2
23/03/10 11:10:06 INFO ResourceUtils: ==============================================================
23/03/10 11:10:06 INFO ResourceUtils: No custom resources configured for spark.driver.
23/03/10 11:10:06 INFO ResourceUtils: ==============================================================
23/03/10 11:10:06 INFO SparkContext: Submitted application: Bank Market
23/03/10 11:10:06 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
23/03/10 11:10:06 INFO ResourceProfile: Limiting resource is cpu
23/03/10 11:10:06 INFO ResourceProfileManager: Added ResourceProfile id: 0
23/03/10 11:10:06 INFO SecurityManager: Changing view acls to: shashi
23/03/10 11:10:06 INFO SecurityManager: Changing modify acls to: shashi
23/03/10 11:10:06 INFO SecurityManager: Changing view acls groups to: 
23/03/10 11:10:06 INFO SecurityManager: Changing modify acls groups to: 
23/03/10 11:10:06 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(shashi); groups with view permissions: Set(); users  with modify permissions: Set(shashi); groups with modify permissions: Set()
23/03/10 11:10:06 INFO Utils: Successfully started service 'sparkDriver' on port 42441.
23/03/10 11:10:06 INFO SparkEnv: Registering MapOutputTracker
23/03/10 11:10:06 INFO SparkEnv: Registering BlockManagerMaster
23/03/10 11:10:06 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
23/03/10 11:10:06 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
23/03/10 11:10:06 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
23/03/10 11:10:06 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-a53cedb1-4e3d-47d7-b84d-6db1aac6fbe1
23/03/10 11:10:06 INFO MemoryStore: MemoryStore started with capacity 366.3 MiB
23/03/10 11:10:06 INFO SparkEnv: Registering OutputCommitCoordinator
23/03/10 11:10:07 INFO Utils: Successfully started service 'SparkUI' on port 4040.
23/03/10 11:10:07 INFO SparkContext: Added JAR file:///home/shashi/.ivy2/jars/org.apache.spark_spark-avro_2.12-3.3.2.jar at spark://172.27.188.152:42441/jars/org.apache.spark_spark-avro_2.12-3.3.2.jar with timestamp 1678426805990
23/03/10 11:10:07 INFO SparkContext: Added JAR file:///home/shashi/.ivy2/jars/org.tukaani_xz-1.9.jar at spark://172.27.188.152:42441/jars/org.tukaani_xz-1.9.jar with timestamp 1678426805990
23/03/10 11:10:07 INFO SparkContext: Added JAR file:///home/shashi/.ivy2/jars/org.spark-project.spark_unused-1.0.0.jar at spark://172.27.188.152:42441/jars/org.spark-project.spark_unused-1.0.0.jar with timestamp 1678426805990
23/03/10 11:10:07 INFO SparkContext: Added file file:///home/shashi/.ivy2/jars/org.apache.spark_spark-avro_2.12-3.3.2.jar at spark://172.27.188.152:42441/files/org.apache.spark_spark-avro_2.12-3.3.2.jar with timestamp 1678426805990
23/03/10 11:10:07 INFO Utils: Copying /home/shashi/.ivy2/jars/org.apache.spark_spark-avro_2.12-3.3.2.jar to /tmp/spark-ba67b18c-6a0e-4ef8-9dac-d945c46001a5/userFiles-a424d610-a771-474d-84ac-cf735697aa79/org.apache.spark_spark-avro_2.12-3.3.2.jar
23/03/10 11:10:07 INFO SparkContext: Added file file:///home/shashi/.ivy2/jars/org.tukaani_xz-1.9.jar at spark://172.27.188.152:42441/files/org.tukaani_xz-1.9.jar with timestamp 1678426805990
23/03/10 11:10:07 INFO Utils: Copying /home/shashi/.ivy2/jars/org.tukaani_xz-1.9.jar to /tmp/spark-ba67b18c-6a0e-4ef8-9dac-d945c46001a5/userFiles-a424d610-a771-474d-84ac-cf735697aa79/org.tukaani_xz-1.9.jar
23/03/10 11:10:07 INFO SparkContext: Added file file:///home/shashi/.ivy2/jars/org.spark-project.spark_unused-1.0.0.jar at spark://172.27.188.152:42441/files/org.spark-project.spark_unused-1.0.0.jar with timestamp 1678426805990
23/03/10 11:10:07 INFO Utils: Copying /home/shashi/.ivy2/jars/org.spark-project.spark_unused-1.0.0.jar to /tmp/spark-ba67b18c-6a0e-4ef8-9dac-d945c46001a5/userFiles-a424d610-a771-474d-84ac-cf735697aa79/org.spark-project.spark_unused-1.0.0.jar
23/03/10 11:10:07 INFO StandaloneAppClient$ClientEndpoint: Connecting to master spark://MILES-BL-4819-LAP.:7077...
23/03/10 11:10:07 INFO TransportClientFactory: Successfully created connection to MILES-BL-4819-LAP./127.0.1.1:7077 after 57 ms (0 ms spent in bootstraps)
23/03/10 11:10:07 INFO StandaloneSchedulerBackend: Connected to Spark cluster with app ID app-20230310111007-0006
23/03/10 11:10:07 INFO StandaloneAppClient$ClientEndpoint: Executor added: app-20230310111007-0006/0 on worker-20230309123128-172.27.188.152-45151 (172.27.188.152:45151) with 8 core(s)
23/03/10 11:10:07 INFO StandaloneSchedulerBackend: Granted executor ID app-20230310111007-0006/0 on hostPort 172.27.188.152:45151 with 8 core(s), 1024.0 MiB RAM
23/03/10 11:10:07 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 40207.
23/03/10 11:10:07 INFO NettyBlockTransferService: Server created on 172.27.188.152:40207
23/03/10 11:10:07 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
23/03/10 11:10:07 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, 172.27.188.152, 40207, None)
23/03/10 11:10:07 INFO BlockManagerMasterEndpoint: Registering block manager 172.27.188.152:40207 with 366.3 MiB RAM, BlockManagerId(driver, 172.27.188.152, 40207, None)
23/03/10 11:10:07 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, 172.27.188.152, 40207, None)
23/03/10 11:10:07 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, 172.27.188.152, 40207, None)
23/03/10 11:10:07 INFO StandaloneAppClient$ClientEndpoint: Executor updated: app-20230310111007-0006/0 is now RUNNING
23/03/10 11:10:07 INFO SingleEventLogFileWriter: Logging events to file:/tmp/spark-events/app-20230310111007-0006.inprogress
23/03/10 11:10:08 INFO StandaloneSchedulerBackend: SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio: 0.0
23/03/10 11:10:08 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
23/03/10 11:10:08 INFO SharedState: Warehouse path is 'file:/home/shashi/spark-warehouse'.
23/03/10 11:10:09 INFO InMemoryFileIndex: It took 91 ms to list leaf files for 1 paths.
23/03/10 11:10:09 INFO InMemoryFileIndex: It took 62 ms to list leaf files for 1 paths.
23/03/10 11:10:11 INFO CoarseGrainedSchedulerBackend$DriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (172.27.188.152:58636) with ID 0,  ResourceProfileId 0
23/03/10 11:10:12 INFO BlockManagerMasterEndpoint: Registering block manager 172.27.188.152:32817 with 366.3 MiB RAM, BlockManagerId(0, 172.27.188.152, 32817, None)
23/03/10 11:10:13 INFO FileSourceStrategy: Pushed Filters: 
23/03/10 11:10:13 INFO FileSourceStrategy: Post-Scan Filters: (length(trim(value#0, None)) > 0)
23/03/10 11:10:13 INFO FileSourceStrategy: Output Data Schema: struct<value: string>
23/03/10 11:10:13 INFO CodeGenerator: Code generated in 236.232935 ms
23/03/10 11:10:13 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 353.3 KiB, free 366.0 MiB)
23/03/10 11:10:13 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 34.8 KiB, free 365.9 MiB)
23/03/10 11:10:14 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 172.27.188.152:40207 (size: 34.8 KiB, free: 366.3 MiB)
23/03/10 11:10:14 INFO SparkContext: Created broadcast 0 from load at NativeMethodAccessorImpl.java:0
23/03/10 11:10:14 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 11:10:14 INFO SparkContext: Starting job: load at NativeMethodAccessorImpl.java:0
23/03/10 11:10:14 INFO DAGScheduler: Got job 0 (load at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 11:10:14 INFO DAGScheduler: Final stage: ResultStage 0 (load at NativeMethodAccessorImpl.java:0)
23/03/10 11:10:14 INFO DAGScheduler: Parents of final stage: List()
23/03/10 11:10:14 INFO DAGScheduler: Missing parents: List()
23/03/10 11:10:14 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at load at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:10:14 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 11.9 KiB, free 365.9 MiB)
23/03/10 11:10:14 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 5.9 KiB, free 365.9 MiB)
23/03/10 11:10:14 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on 172.27.188.152:40207 (size: 5.9 KiB, free: 366.3 MiB)
23/03/10 11:10:14 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1513
23/03/10 11:10:14 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at load at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 11:10:14 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
23/03/10 11:10:14 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 4985 bytes) taskResourceAssignments Map()
23/03/10 11:10:14 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on 172.27.188.152:32817 (size: 5.9 KiB, free: 366.3 MiB)
23/03/10 11:10:15 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 172.27.188.152:32817 (size: 34.8 KiB, free: 366.3 MiB)
23/03/10 11:10:16 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 1905 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 11:10:16 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool 
23/03/10 11:10:16 INFO DAGScheduler: ResultStage 0 (load at NativeMethodAccessorImpl.java:0) finished in 2.030 s
23/03/10 11:10:16 INFO DAGScheduler: Job 0 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 11:10:16 INFO TaskSchedulerImpl: Killing all running tasks in stage 0: Stage finished
23/03/10 11:10:16 INFO DAGScheduler: Job 0 finished: load at NativeMethodAccessorImpl.java:0, took 2.099090 s
23/03/10 11:10:16 INFO CodeGenerator: Code generated in 11.852314 ms
23/03/10 11:10:16 INFO FileSourceStrategy: Pushed Filters: 
23/03/10 11:10:16 INFO FileSourceStrategy: Post-Scan Filters: 
23/03/10 11:10:16 INFO FileSourceStrategy: Output Data Schema: struct<value: string>
23/03/10 11:10:16 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 353.3 KiB, free 365.6 MiB)
23/03/10 11:10:16 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 34.8 KiB, free 365.5 MiB)
23/03/10 11:10:16 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on 172.27.188.152:40207 (size: 34.8 KiB, free: 366.2 MiB)
23/03/10 11:10:16 INFO SparkContext: Created broadcast 2 from load at NativeMethodAccessorImpl.java:0
23/03/10 11:10:16 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 11:10:16 INFO FileSourceStrategy: Pushed Filters: IsNotNull(y),EqualTo(y,yes)
23/03/10 11:10:16 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(y#33),(y#33 = yes)
23/03/10 11:10:16 INFO FileSourceStrategy: Output Data Schema: struct<age: string, y: string>
23/03/10 11:10:17 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
23/03/10 11:10:17 INFO BlockManagerInfo: Removed broadcast_0_piece0 on 172.27.188.152:40207 in memory (size: 34.8 KiB, free: 366.3 MiB)
23/03/10 11:10:17 INFO BlockManagerInfo: Removed broadcast_0_piece0 on 172.27.188.152:32817 in memory (size: 34.8 KiB, free: 366.3 MiB)
23/03/10 11:10:17 INFO BlockManagerInfo: Removed broadcast_1_piece0 on 172.27.188.152:40207 in memory (size: 5.9 KiB, free: 366.3 MiB)
23/03/10 11:10:17 INFO BlockManagerInfo: Removed broadcast_1_piece0 on 172.27.188.152:32817 in memory (size: 5.9 KiB, free: 366.3 MiB)
23/03/10 11:10:17 INFO CodeGenerator: Code generated in 258.021154 ms
23/03/10 11:10:17 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 353.2 KiB, free 365.6 MiB)
23/03/10 11:10:17 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 34.8 KiB, free 365.5 MiB)
23/03/10 11:10:17 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on 172.27.188.152:40207 (size: 34.8 KiB, free: 366.2 MiB)
23/03/10 11:10:17 INFO SparkContext: Created broadcast 3 from parquet at NativeMethodAccessorImpl.java:0
23/03/10 11:10:17 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 11:10:17 INFO DAGScheduler: Registering RDD 13 (parquet at NativeMethodAccessorImpl.java:0) as input to shuffle 0
23/03/10 11:10:17 INFO DAGScheduler: Got map stage job 1 (parquet at NativeMethodAccessorImpl.java:0) with 2 output partitions
23/03/10 11:10:17 INFO DAGScheduler: Final stage: ShuffleMapStage 1 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 11:10:17 INFO DAGScheduler: Parents of final stage: List()
23/03/10 11:10:17 INFO DAGScheduler: Missing parents: List()
23/03/10 11:10:17 INFO DAGScheduler: Submitting ShuffleMapStage 1 (MapPartitionsRDD[13] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:10:17 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 38.5 KiB, free 365.5 MiB)
23/03/10 11:10:17 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 18.2 KiB, free 365.5 MiB)
23/03/10 11:10:17 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on 172.27.188.152:40207 (size: 18.2 KiB, free: 366.2 MiB)
23/03/10 11:10:17 INFO SparkContext: Created broadcast 4 from broadcast at DAGScheduler.scala:1513
23/03/10 11:10:17 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 1 (MapPartitionsRDD[13] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
23/03/10 11:10:17 INFO TaskSchedulerImpl: Adding task set 1.0 with 2 tasks resource profile 0
23/03/10 11:10:17 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 1) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 4974 bytes) taskResourceAssignments Map()
23/03/10 11:10:17 INFO TaskSetManager: Starting task 1.0 in stage 1.0 (TID 2) (172.27.188.152, executor 0, partition 1, PROCESS_LOCAL, 4974 bytes) taskResourceAssignments Map()
23/03/10 11:10:17 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on 172.27.188.152:32817 (size: 18.2 KiB, free: 366.3 MiB)
23/03/10 11:10:18 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on 172.27.188.152:32817 (size: 34.8 KiB, free: 366.2 MiB)
23/03/10 11:10:18 INFO TaskSetManager: Finished task 1.0 in stage 1.0 (TID 2) in 1054 ms on 172.27.188.152 (executor 0) (1/2)
23/03/10 11:10:19 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 1) in 1135 ms on 172.27.188.152 (executor 0) (2/2)
23/03/10 11:10:19 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool 
23/03/10 11:10:19 INFO DAGScheduler: ShuffleMapStage 1 (parquet at NativeMethodAccessorImpl.java:0) finished in 1.168 s
23/03/10 11:10:19 INFO DAGScheduler: looking for newly runnable stages
23/03/10 11:10:19 INFO DAGScheduler: running: Set()
23/03/10 11:10:19 INFO DAGScheduler: waiting: Set()
23/03/10 11:10:19 INFO DAGScheduler: failed: Set()
23/03/10 11:10:19 INFO ShufflePartitionsUtil: For shuffle(0), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
23/03/10 11:10:19 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
23/03/10 11:10:19 INFO CodeGenerator: Code generated in 18.279808 ms
23/03/10 11:10:19 INFO CodeGenerator: Code generated in 17.734764 ms
23/03/10 11:10:19 INFO SparkContext: Starting job: parquet at NativeMethodAccessorImpl.java:0
23/03/10 11:10:19 INFO DAGScheduler: Got job 2 (parquet at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 11:10:19 INFO DAGScheduler: Final stage: ResultStage 3 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 11:10:19 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 2)
23/03/10 11:10:19 INFO DAGScheduler: Missing parents: List()
23/03/10 11:10:19 INFO DAGScheduler: Submitting ResultStage 3 (MapPartitionsRDD[18] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:10:19 INFO MemoryStore: Block broadcast_5 stored as values in memory (estimated size 40.0 KiB, free 365.4 MiB)
23/03/10 11:10:19 INFO MemoryStore: Block broadcast_5_piece0 stored as bytes in memory (estimated size 19.2 KiB, free 365.4 MiB)
23/03/10 11:10:19 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on 172.27.188.152:40207 (size: 19.2 KiB, free: 366.2 MiB)
23/03/10 11:10:19 INFO SparkContext: Created broadcast 5 from broadcast at DAGScheduler.scala:1513
23/03/10 11:10:19 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 3 (MapPartitionsRDD[18] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 11:10:19 INFO TaskSchedulerImpl: Adding task set 3.0 with 1 tasks resource profile 0
23/03/10 11:10:19 INFO TaskSetManager: Starting task 0.0 in stage 3.0 (TID 3) (172.27.188.152, executor 0, partition 0, NODE_LOCAL, 4457 bytes) taskResourceAssignments Map()
23/03/10 11:10:19 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on 172.27.188.152:32817 (size: 19.2 KiB, free: 366.2 MiB)
23/03/10 11:10:19 INFO MapOutputTrackerMasterEndpoint: Asked to send map output locations for shuffle 0 to 172.27.188.152:58636
23/03/10 11:10:19 INFO TaskSetManager: Finished task 0.0 in stage 3.0 (TID 3) in 329 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 11:10:19 INFO TaskSchedulerImpl: Removed TaskSet 3.0, whose tasks have all completed, from pool 
23/03/10 11:10:19 INFO DAGScheduler: ResultStage 3 (parquet at NativeMethodAccessorImpl.java:0) finished in 0.352 s
23/03/10 11:10:19 INFO DAGScheduler: Job 2 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 11:10:19 INFO TaskSchedulerImpl: Killing all running tasks in stage 3: Stage finished
23/03/10 11:10:19 INFO DAGScheduler: Job 2 finished: parquet at NativeMethodAccessorImpl.java:0, took 0.394351 s
23/03/10 11:10:19 INFO DAGScheduler: Registering RDD 19 (parquet at NativeMethodAccessorImpl.java:0) as input to shuffle 1
23/03/10 11:10:19 INFO DAGScheduler: Got map stage job 3 (parquet at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 11:10:19 INFO DAGScheduler: Final stage: ShuffleMapStage 5 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 11:10:19 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 4)
23/03/10 11:10:19 INFO DAGScheduler: Missing parents: List()
23/03/10 11:10:19 INFO DAGScheduler: Submitting ShuffleMapStage 5 (MapPartitionsRDD[19] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:10:19 INFO MemoryStore: Block broadcast_6 stored as values in memory (estimated size 42.0 KiB, free 365.4 MiB)
23/03/10 11:10:19 INFO MemoryStore: Block broadcast_6_piece0 stored as bytes in memory (estimated size 19.9 KiB, free 365.4 MiB)
23/03/10 11:10:19 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on 172.27.188.152:40207 (size: 19.9 KiB, free: 366.2 MiB)
23/03/10 11:10:19 INFO SparkContext: Created broadcast 6 from broadcast at DAGScheduler.scala:1513
23/03/10 11:10:19 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 5 (MapPartitionsRDD[19] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 11:10:19 INFO TaskSchedulerImpl: Adding task set 5.0 with 1 tasks resource profile 0
23/03/10 11:10:19 INFO TaskSetManager: Starting task 0.0 in stage 5.0 (TID 4) (172.27.188.152, executor 0, partition 0, NODE_LOCAL, 4446 bytes) taskResourceAssignments Map()
23/03/10 11:10:19 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on 172.27.188.152:32817 (size: 19.9 KiB, free: 366.2 MiB)
23/03/10 11:10:19 INFO TaskSetManager: Finished task 0.0 in stage 5.0 (TID 4) in 119 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 11:10:19 INFO TaskSchedulerImpl: Removed TaskSet 5.0, whose tasks have all completed, from pool 
23/03/10 11:10:19 INFO DAGScheduler: ShuffleMapStage 5 (parquet at NativeMethodAccessorImpl.java:0) finished in 0.151 s
23/03/10 11:10:19 INFO DAGScheduler: looking for newly runnable stages
23/03/10 11:10:19 INFO DAGScheduler: running: Set()
23/03/10 11:10:19 INFO DAGScheduler: waiting: Set()
23/03/10 11:10:19 INFO DAGScheduler: failed: Set()
23/03/10 11:10:19 INFO ShufflePartitionsUtil: For shuffle(1), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
23/03/10 11:10:19 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
23/03/10 11:10:19 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
23/03/10 11:10:19 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
23/03/10 11:10:19 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
23/03/10 11:10:19 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
23/03/10 11:10:19 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
23/03/10 11:10:20 INFO CodeGenerator: Code generated in 14.370195 ms
23/03/10 11:10:20 INFO SparkContext: Starting job: parquet at NativeMethodAccessorImpl.java:0
23/03/10 11:10:20 INFO DAGScheduler: Got job 4 (parquet at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 11:10:20 INFO DAGScheduler: Final stage: ResultStage 8 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 11:10:20 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 7)
23/03/10 11:10:20 INFO DAGScheduler: Missing parents: List()
23/03/10 11:10:20 INFO DAGScheduler: Submitting ResultStage 8 (MapPartitionsRDD[21] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:10:20 INFO MemoryStore: Block broadcast_7 stored as values in memory (estimated size 240.4 KiB, free 365.1 MiB)
23/03/10 11:10:20 INFO MemoryStore: Block broadcast_7_piece0 stored as bytes in memory (estimated size 89.4 KiB, free 365.0 MiB)
23/03/10 11:10:20 INFO BlockManagerInfo: Added broadcast_7_piece0 in memory on 172.27.188.152:40207 (size: 89.4 KiB, free: 366.1 MiB)
23/03/10 11:10:20 INFO SparkContext: Created broadcast 7 from broadcast at DAGScheduler.scala:1513
23/03/10 11:10:20 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 8 (MapPartitionsRDD[21] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 11:10:20 INFO TaskSchedulerImpl: Adding task set 8.0 with 1 tasks resource profile 0
23/03/10 11:10:20 INFO TaskSetManager: Starting task 0.0 in stage 8.0 (TID 5) (172.27.188.152, executor 0, partition 0, NODE_LOCAL, 4457 bytes) taskResourceAssignments Map()
23/03/10 11:10:20 INFO BlockManagerInfo: Added broadcast_7_piece0 in memory on 172.27.188.152:32817 (size: 89.4 KiB, free: 366.1 MiB)
23/03/10 11:10:20 INFO MapOutputTrackerMasterEndpoint: Asked to send map output locations for shuffle 1 to 172.27.188.152:58636
23/03/10 11:10:22 INFO TaskSetManager: Finished task 0.0 in stage 8.0 (TID 5) in 2146 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 11:10:22 INFO TaskSchedulerImpl: Removed TaskSet 8.0, whose tasks have all completed, from pool 
23/03/10 11:10:22 INFO DAGScheduler: ResultStage 8 (parquet at NativeMethodAccessorImpl.java:0) finished in 2.185 s
23/03/10 11:10:22 INFO DAGScheduler: Job 4 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 11:10:22 INFO TaskSchedulerImpl: Killing all running tasks in stage 8: Stage finished
23/03/10 11:10:22 INFO DAGScheduler: Job 4 finished: parquet at NativeMethodAccessorImpl.java:0, took 2.203263 s
23/03/10 11:10:22 INFO FileFormatWriter: Start to commit write Job cf92c13b-349a-4714-89cf-2965bb4d5475.
23/03/10 11:10:22 INFO FileFormatWriter: Write Job cf92c13b-349a-4714-89cf-2965bb4d5475 committed. Elapsed time: 693 ms.
23/03/10 11:10:22 INFO FileFormatWriter: Finished processing stats for write job cf92c13b-349a-4714-89cf-2965bb4d5475.
#######  Created Parquet File  #########
23/03/10 11:10:23 INFO InMemoryFileIndex: It took 109 ms to list leaf files for 1 paths.
23/03/10 11:10:23 INFO SparkContext: Starting job: parquet at NativeMethodAccessorImpl.java:0
23/03/10 11:10:23 INFO DAGScheduler: Got job 5 (parquet at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 11:10:23 INFO DAGScheduler: Final stage: ResultStage 9 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 11:10:23 INFO DAGScheduler: Parents of final stage: List()
23/03/10 11:10:23 INFO DAGScheduler: Missing parents: List()
23/03/10 11:10:23 INFO DAGScheduler: Submitting ResultStage 9 (MapPartitionsRDD[23] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:10:23 INFO MemoryStore: Block broadcast_8 stored as values in memory (estimated size 104.4 KiB, free 364.9 MiB)
23/03/10 11:10:23 INFO MemoryStore: Block broadcast_8_piece0 stored as bytes in memory (estimated size 37.6 KiB, free 364.9 MiB)
23/03/10 11:10:23 INFO BlockManagerInfo: Added broadcast_8_piece0 in memory on 172.27.188.152:40207 (size: 37.6 KiB, free: 366.1 MiB)
23/03/10 11:10:23 INFO SparkContext: Created broadcast 8 from broadcast at DAGScheduler.scala:1513
23/03/10 11:10:23 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 9 (MapPartitionsRDD[23] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 11:10:23 INFO TaskSchedulerImpl: Adding task set 9.0 with 1 tasks resource profile 0
23/03/10 11:10:23 INFO TaskSetManager: Starting task 0.0 in stage 9.0 (TID 6) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 4731 bytes) taskResourceAssignments Map()
23/03/10 11:10:23 INFO BlockManagerInfo: Added broadcast_8_piece0 in memory on 172.27.188.152:32817 (size: 37.6 KiB, free: 366.1 MiB)
23/03/10 11:10:23 INFO TaskSetManager: Finished task 0.0 in stage 9.0 (TID 6) in 188 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 11:10:23 INFO TaskSchedulerImpl: Removed TaskSet 9.0, whose tasks have all completed, from pool 
23/03/10 11:10:23 INFO DAGScheduler: ResultStage 9 (parquet at NativeMethodAccessorImpl.java:0) finished in 0.215 s
23/03/10 11:10:23 INFO DAGScheduler: Job 5 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 11:10:23 INFO TaskSchedulerImpl: Killing all running tasks in stage 9: Stage finished
23/03/10 11:10:23 INFO DAGScheduler: Job 5 finished: parquet at NativeMethodAccessorImpl.java:0, took 0.228048 s
##########   Parquet File Output    ########################
23/03/10 11:10:23 INFO FileSourceStrategy: Pushed Filters: 
23/03/10 11:10:23 INFO FileSourceStrategy: Post-Scan Filters: 
23/03/10 11:10:23 INFO FileSourceStrategy: Output Data Schema: struct<age: string, count: bigint>
23/03/10 11:10:23 INFO CodeGenerator: Code generated in 22.637273 ms
23/03/10 11:10:23 INFO MemoryStore: Block broadcast_9 stored as values in memory (estimated size 357.5 KiB, free 364.6 MiB)
23/03/10 11:10:23 INFO MemoryStore: Block broadcast_9_piece0 stored as bytes in memory (estimated size 35.4 KiB, free 364.5 MiB)
23/03/10 11:10:23 INFO BlockManagerInfo: Added broadcast_9_piece0 in memory on 172.27.188.152:40207 (size: 35.4 KiB, free: 366.0 MiB)
23/03/10 11:10:23 INFO SparkContext: Created broadcast 9 from showString at NativeMethodAccessorImpl.java:0
23/03/10 11:10:23 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 11:10:23 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
23/03/10 11:10:23 INFO DAGScheduler: Got job 6 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 11:10:23 INFO DAGScheduler: Final stage: ResultStage 10 (showString at NativeMethodAccessorImpl.java:0)
23/03/10 11:10:23 INFO DAGScheduler: Parents of final stage: List()
23/03/10 11:10:23 INFO DAGScheduler: Missing parents: List()
23/03/10 11:10:23 INFO DAGScheduler: Submitting ResultStage 10 (MapPartitionsRDD[27] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:10:23 INFO MemoryStore: Block broadcast_10 stored as values in memory (estimated size 13.6 KiB, free 364.5 MiB)
23/03/10 11:10:23 INFO MemoryStore: Block broadcast_10_piece0 stored as bytes in memory (estimated size 6.1 KiB, free 364.5 MiB)
23/03/10 11:10:23 INFO BlockManagerInfo: Added broadcast_10_piece0 in memory on 172.27.188.152:40207 (size: 6.1 KiB, free: 366.0 MiB)
23/03/10 11:10:23 INFO SparkContext: Created broadcast 10 from broadcast at DAGScheduler.scala:1513
23/03/10 11:10:23 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 10 (MapPartitionsRDD[27] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 11:10:23 INFO TaskSchedulerImpl: Adding task set 10.0 with 1 tasks resource profile 0
23/03/10 11:10:23 INFO TaskSetManager: Starting task 0.0 in stage 10.0 (TID 7) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 5056 bytes) taskResourceAssignments Map()
23/03/10 11:10:23 INFO BlockManagerInfo: Added broadcast_10_piece0 in memory on 172.27.188.152:32817 (size: 6.1 KiB, free: 366.1 MiB)
23/03/10 11:10:23 INFO BlockManagerInfo: Added broadcast_9_piece0 in memory on 172.27.188.152:32817 (size: 35.4 KiB, free: 366.0 MiB)
23/03/10 11:10:24 INFO TaskSetManager: Finished task 0.0 in stage 10.0 (TID 7) in 430 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 11:10:24 INFO TaskSchedulerImpl: Removed TaskSet 10.0, whose tasks have all completed, from pool 
23/03/10 11:10:24 INFO DAGScheduler: ResultStage 10 (showString at NativeMethodAccessorImpl.java:0) finished in 0.459 s
23/03/10 11:10:24 INFO DAGScheduler: Job 6 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 11:10:24 INFO TaskSchedulerImpl: Killing all running tasks in stage 10: Stage finished
23/03/10 11:10:24 INFO DAGScheduler: Job 6 finished: showString at NativeMethodAccessorImpl.java:0, took 0.473474 s
23/03/10 11:10:24 INFO CodeGenerator: Code generated in 13.535503 ms
+---+-----+
|age|count|
+---+-----+
| 32|  221|
| 30|  217|
| 33|  210|
| 35|  209|
| 31|  206|
| 34|  198|
| 36|  195|
| 29|  171|
| 37|  170|
| 28|  162|
| 38|  144|
| 39|  143|
| 27|  141|
| 26|  134|
| 41|  120|
| 46|  118|
| 40|  116|
| 47|  113|
| 25|  113|
| 42|  111|
+---+-----+
only showing top 20 rows

None
23/03/10 11:10:24 INFO FileSourceStrategy: Pushed Filters: IsNotNull(y),EqualTo(y,yes)
23/03/10 11:10:24 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(y#33),(y#33 = yes)
23/03/10 11:10:24 INFO FileSourceStrategy: Output Data Schema: struct<age: string, y: string>
23/03/10 11:10:24 INFO deprecation: mapred.output.compress is deprecated. Instead, use mapreduce.output.fileoutputformat.compress
23/03/10 11:10:24 INFO AvroUtils: Compressing Avro output using the snappy codec
23/03/10 11:10:24 INFO CodeGenerator: Code generated in 43.442112 ms
23/03/10 11:10:24 INFO CodeGenerator: Code generated in 10.751429 ms
23/03/10 11:10:24 INFO MemoryStore: Block broadcast_11 stored as values in memory (estimated size 353.2 KiB, free 364.2 MiB)
23/03/10 11:10:24 INFO MemoryStore: Block broadcast_11_piece0 stored as bytes in memory (estimated size 34.8 KiB, free 364.1 MiB)
23/03/10 11:10:24 INFO BlockManagerInfo: Added broadcast_11_piece0 in memory on 172.27.188.152:40207 (size: 34.8 KiB, free: 366.0 MiB)
23/03/10 11:10:24 INFO SparkContext: Created broadcast 11 from save at NativeMethodAccessorImpl.java:0
23/03/10 11:10:24 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 11:10:24 INFO DAGScheduler: Registering RDD 34 (save at NativeMethodAccessorImpl.java:0) as input to shuffle 2
23/03/10 11:10:24 INFO DAGScheduler: Got map stage job 7 (save at NativeMethodAccessorImpl.java:0) with 2 output partitions
23/03/10 11:10:24 INFO DAGScheduler: Final stage: ShuffleMapStage 11 (save at NativeMethodAccessorImpl.java:0)
23/03/10 11:10:24 INFO DAGScheduler: Parents of final stage: List()
23/03/10 11:10:24 INFO DAGScheduler: Missing parents: List()
23/03/10 11:10:24 INFO DAGScheduler: Submitting ShuffleMapStage 11 (MapPartitionsRDD[34] at save at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:10:24 INFO MemoryStore: Block broadcast_12 stored as values in memory (estimated size 46.0 KiB, free 364.1 MiB)
23/03/10 11:10:24 INFO MemoryStore: Block broadcast_12_piece0 stored as bytes in memory (estimated size 21.8 KiB, free 364.1 MiB)
23/03/10 11:10:24 INFO BlockManagerInfo: Added broadcast_12_piece0 in memory on 172.27.188.152:40207 (size: 21.8 KiB, free: 366.0 MiB)
23/03/10 11:10:24 INFO SparkContext: Created broadcast 12 from broadcast at DAGScheduler.scala:1513
23/03/10 11:10:24 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 11 (MapPartitionsRDD[34] at save at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
23/03/10 11:10:24 INFO TaskSchedulerImpl: Adding task set 11.0 with 2 tasks resource profile 0
23/03/10 11:10:24 INFO TaskSetManager: Starting task 0.0 in stage 11.0 (TID 8) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 4974 bytes) taskResourceAssignments Map()
23/03/10 11:10:24 INFO TaskSetManager: Starting task 1.0 in stage 11.0 (TID 9) (172.27.188.152, executor 0, partition 1, PROCESS_LOCAL, 4974 bytes) taskResourceAssignments Map()
23/03/10 11:10:24 INFO BlockManagerInfo: Added broadcast_12_piece0 in memory on 172.27.188.152:32817 (size: 21.8 KiB, free: 366.0 MiB)
23/03/10 11:10:25 INFO BlockManagerInfo: Added broadcast_11_piece0 in memory on 172.27.188.152:32817 (size: 34.8 KiB, free: 366.0 MiB)
23/03/10 11:10:25 INFO TaskSetManager: Finished task 1.0 in stage 11.0 (TID 9) in 1083 ms on 172.27.188.152 (executor 0) (1/2)
23/03/10 11:10:25 INFO PythonAccumulatorV2: Connected to AccumulatorServer at host: 127.0.0.1 port: 41649
23/03/10 11:10:25 INFO TaskSetManager: Finished task 0.0 in stage 11.0 (TID 8) in 1158 ms on 172.27.188.152 (executor 0) (2/2)
23/03/10 11:10:25 INFO TaskSchedulerImpl: Removed TaskSet 11.0, whose tasks have all completed, from pool 
23/03/10 11:10:25 INFO DAGScheduler: ShuffleMapStage 11 (save at NativeMethodAccessorImpl.java:0) finished in 1.179 s
23/03/10 11:10:25 INFO DAGScheduler: looking for newly runnable stages
23/03/10 11:10:25 INFO DAGScheduler: running: Set()
23/03/10 11:10:25 INFO DAGScheduler: waiting: Set()
23/03/10 11:10:25 INFO DAGScheduler: failed: Set()
23/03/10 11:10:25 INFO ShufflePartitionsUtil: For shuffle(2), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
23/03/10 11:10:25 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
23/03/10 11:10:25 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
23/03/10 11:10:25 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter
23/03/10 11:10:26 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
23/03/10 11:10:26 INFO CodeGenerator: Code generated in 16.091278 ms
23/03/10 11:10:26 INFO SparkContext: Starting job: save at NativeMethodAccessorImpl.java:0
23/03/10 11:10:26 INFO DAGScheduler: Got job 8 (save at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 11:10:26 INFO DAGScheduler: Final stage: ResultStage 13 (save at NativeMethodAccessorImpl.java:0)
23/03/10 11:10:26 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 12)
23/03/10 11:10:26 INFO DAGScheduler: Missing parents: List()
23/03/10 11:10:26 INFO DAGScheduler: Submitting ResultStage 13 (MapPartitionsRDD[36] at save at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:10:26 INFO MemoryStore: Block broadcast_13 stored as values in memory (estimated size 245.5 KiB, free 363.8 MiB)
23/03/10 11:10:26 INFO MemoryStore: Block broadcast_13_piece0 stored as bytes in memory (estimated size 91.9 KiB, free 363.7 MiB)
23/03/10 11:10:26 INFO BlockManagerInfo: Added broadcast_13_piece0 in memory on 172.27.188.152:40207 (size: 91.9 KiB, free: 365.9 MiB)
23/03/10 11:10:26 INFO SparkContext: Created broadcast 13 from broadcast at DAGScheduler.scala:1513
23/03/10 11:10:26 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 13 (MapPartitionsRDD[36] at save at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 11:10:26 INFO TaskSchedulerImpl: Adding task set 13.0 with 1 tasks resource profile 0
23/03/10 11:10:26 INFO TaskSetManager: Starting task 0.0 in stage 13.0 (TID 10) (172.27.188.152, executor 0, partition 0, NODE_LOCAL, 4457 bytes) taskResourceAssignments Map()
23/03/10 11:10:26 INFO BlockManagerInfo: Added broadcast_13_piece0 in memory on 172.27.188.152:32817 (size: 91.9 KiB, free: 365.9 MiB)
23/03/10 11:10:26 INFO MapOutputTrackerMasterEndpoint: Asked to send map output locations for shuffle 2 to 172.27.188.152:58636
23/03/10 11:10:27 INFO TaskSetManager: Finished task 0.0 in stage 13.0 (TID 10) in 805 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 11:10:27 INFO TaskSchedulerImpl: Removed TaskSet 13.0, whose tasks have all completed, from pool 
23/03/10 11:10:27 INFO DAGScheduler: ResultStage 13 (save at NativeMethodAccessorImpl.java:0) finished in 0.836 s
23/03/10 11:10:27 INFO DAGScheduler: Job 8 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 11:10:27 INFO TaskSchedulerImpl: Killing all running tasks in stage 13: Stage finished
23/03/10 11:10:27 INFO DAGScheduler: Job 8 finished: save at NativeMethodAccessorImpl.java:0, took 0.854819 s
23/03/10 11:10:27 INFO FileFormatWriter: Start to commit write Job f4033fe9-1099-4599-8539-a5a650df6356.
23/03/10 11:10:27 INFO FileFormatWriter: Write Job f4033fe9-1099-4599-8539-a5a650df6356 committed. Elapsed time: 668 ms.
23/03/10 11:10:27 INFO FileFormatWriter: Finished processing stats for write job f4033fe9-1099-4599-8539-a5a650df6356.
#######  Created Avro File  #########
23/03/10 11:10:27 INFO InMemoryFileIndex: It took 93 ms to list leaf files for 1 paths.
##########   Avro File Output    ########################
23/03/10 11:10:28 INFO FileSourceStrategy: Pushed Filters: 
23/03/10 11:10:28 INFO FileSourceStrategy: Post-Scan Filters: 
23/03/10 11:10:28 INFO FileSourceStrategy: Output Data Schema: struct<age_cat: string, count: bigint>
23/03/10 11:10:28 INFO CodeGenerator: Code generated in 7.556655 ms
23/03/10 11:10:28 INFO MemoryStore: Block broadcast_14 stored as values in memory (estimated size 352.9 KiB, free 363.4 MiB)
23/03/10 11:10:28 INFO MemoryStore: Block broadcast_14_piece0 stored as bytes in memory (estimated size 34.8 KiB, free 363.4 MiB)
23/03/10 11:10:28 INFO BlockManagerInfo: Added broadcast_14_piece0 in memory on 172.27.188.152:40207 (size: 34.8 KiB, free: 365.8 MiB)
23/03/10 11:10:28 INFO SparkContext: Created broadcast 14 from showString at NativeMethodAccessorImpl.java:0
23/03/10 11:10:28 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 11:10:28 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
23/03/10 11:10:28 INFO DAGScheduler: Got job 9 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 11:10:28 INFO DAGScheduler: Final stage: ResultStage 14 (showString at NativeMethodAccessorImpl.java:0)
23/03/10 11:10:28 INFO DAGScheduler: Parents of final stage: List()
23/03/10 11:10:28 INFO DAGScheduler: Missing parents: List()
23/03/10 11:10:28 INFO DAGScheduler: Submitting ResultStage 14 (MapPartitionsRDD[40] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:10:28 INFO MemoryStore: Block broadcast_15 stored as values in memory (estimated size 12.0 KiB, free 363.3 MiB)
23/03/10 11:10:28 INFO MemoryStore: Block broadcast_15_piece0 stored as bytes in memory (estimated size 6.0 KiB, free 363.3 MiB)
23/03/10 11:10:28 INFO BlockManagerInfo: Added broadcast_15_piece0 in memory on 172.27.188.152:40207 (size: 6.0 KiB, free: 365.8 MiB)
23/03/10 11:10:28 INFO SparkContext: Created broadcast 15 from broadcast at DAGScheduler.scala:1513
23/03/10 11:10:28 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 14 (MapPartitionsRDD[40] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 11:10:28 INFO TaskSchedulerImpl: Adding task set 14.0 with 1 tasks resource profile 0
23/03/10 11:10:28 INFO TaskSetManager: Starting task 0.0 in stage 14.0 (TID 11) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 5043 bytes) taskResourceAssignments Map()
23/03/10 11:10:28 INFO BlockManagerInfo: Added broadcast_15_piece0 in memory on 172.27.188.152:32817 (size: 6.0 KiB, free: 365.9 MiB)
23/03/10 11:10:28 INFO BlockManagerInfo: Added broadcast_14_piece0 in memory on 172.27.188.152:32817 (size: 34.8 KiB, free: 365.9 MiB)
23/03/10 11:10:28 INFO TaskSetManager: Finished task 0.0 in stage 14.0 (TID 11) in 253 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 11:10:28 INFO TaskSchedulerImpl: Removed TaskSet 14.0, whose tasks have all completed, from pool 
23/03/10 11:10:28 INFO DAGScheduler: ResultStage 14 (showString at NativeMethodAccessorImpl.java:0) finished in 0.274 s
23/03/10 11:10:28 INFO DAGScheduler: Job 9 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 11:10:28 INFO TaskSchedulerImpl: Killing all running tasks in stage 14: Stage finished
23/03/10 11:10:28 INFO DAGScheduler: Job 9 finished: showString at NativeMethodAccessorImpl.java:0, took 0.286323 s
+-------+-----+
|age_cat|count|
+-------+-----+
|  Young| 2924|
+-------+-----+

None
23/03/10 11:10:28 INFO SparkContext: Invoking stop() from shutdown hook
23/03/10 11:10:28 INFO SparkUI: Stopped Spark web UI at http://172.27.188.152:4040
23/03/10 11:10:28 INFO StandaloneSchedulerBackend: Shutting down all executors
23/03/10 11:10:28 INFO CoarseGrainedSchedulerBackend$DriverEndpoint: Asking each executor to shut down
23/03/10 11:10:28 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
23/03/10 11:10:28 INFO MemoryStore: MemoryStore cleared
23/03/10 11:10:28 INFO BlockManager: BlockManager stopped
23/03/10 11:10:28 INFO BlockManagerMaster: BlockManagerMaster stopped
23/03/10 11:10:28 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
23/03/10 11:10:28 INFO SparkContext: Successfully stopped SparkContext
23/03/10 11:10:28 INFO ShutdownHookManager: Shutdown hook called
23/03/10 11:10:28 INFO ShutdownHookManager: Deleting directory /tmp/spark-762deaa3-6abb-4dd4-b529-cd098eed3bbd
23/03/10 11:10:28 INFO ShutdownHookManager: Deleting directory /tmp/spark-ba67b18c-6a0e-4ef8-9dac-d945c46001a5
23/03/10 11:10:28 INFO ShutdownHookManager: Deleting directory /tmp/spark-ba67b18c-6a0e-4ef8-9dac-d945c46001a5/pyspark-859dc7f1-efbe-4207-ac95-7e65fbaafd32
##### Finished Executor #####
============================================
============================================
Fri Mar 10 05:45:01 UTC 2023
##### Started Executor #####
23/03/10 11:15:03 WARN Utils: Your hostname, MILES-BL-4819-LAP resolves to a loopback address: 127.0.1.1; using 172.27.188.152 instead (on interface eth0)
23/03/10 11:15:03 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
:: loading settings :: url = jar:file:/opt/spark/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml
23/03/10 11:15:05 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
23/03/10 11:15:07 INFO SparkContext: Running Spark version 3.3.2
23/03/10 11:15:07 INFO ResourceUtils: ==============================================================
23/03/10 11:15:07 INFO ResourceUtils: No custom resources configured for spark.driver.
23/03/10 11:15:07 INFO ResourceUtils: ==============================================================
23/03/10 11:15:07 INFO SparkContext: Submitted application: Bank Market
23/03/10 11:15:07 INFO ResourceProfile: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
23/03/10 11:15:07 INFO ResourceProfile: Limiting resource is cpu
23/03/10 11:15:07 INFO ResourceProfileManager: Added ResourceProfile id: 0
23/03/10 11:15:07 INFO SecurityManager: Changing view acls to: shashi
23/03/10 11:15:07 INFO SecurityManager: Changing modify acls to: shashi
23/03/10 11:15:07 INFO SecurityManager: Changing view acls groups to: 
23/03/10 11:15:07 INFO SecurityManager: Changing modify acls groups to: 
23/03/10 11:15:07 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(shashi); groups with view permissions: Set(); users  with modify permissions: Set(shashi); groups with modify permissions: Set()
23/03/10 11:15:07 INFO Utils: Successfully started service 'sparkDriver' on port 45881.
23/03/10 11:15:07 INFO SparkEnv: Registering MapOutputTracker
23/03/10 11:15:08 INFO SparkEnv: Registering BlockManagerMaster
23/03/10 11:15:08 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
23/03/10 11:15:08 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
23/03/10 11:15:08 INFO SparkEnv: Registering BlockManagerMasterHeartbeat
23/03/10 11:15:08 INFO DiskBlockManager: Created local directory at /tmp/blockmgr-ebf09e93-a171-46f4-88c5-840ae6b92105
23/03/10 11:15:08 INFO MemoryStore: MemoryStore started with capacity 366.3 MiB
23/03/10 11:15:08 INFO SparkEnv: Registering OutputCommitCoordinator
23/03/10 11:15:08 INFO Utils: Successfully started service 'SparkUI' on port 4040.
23/03/10 11:15:08 INFO SparkContext: Added JAR file:///home/shashi/.ivy2/jars/org.apache.spark_spark-avro_2.12-3.3.2.jar at spark://172.27.188.152:45881/jars/org.apache.spark_spark-avro_2.12-3.3.2.jar with timestamp 1678427107071
23/03/10 11:15:08 INFO SparkContext: Added JAR file:///home/shashi/.ivy2/jars/org.tukaani_xz-1.9.jar at spark://172.27.188.152:45881/jars/org.tukaani_xz-1.9.jar with timestamp 1678427107071
23/03/10 11:15:08 INFO SparkContext: Added JAR file:///home/shashi/.ivy2/jars/org.spark-project.spark_unused-1.0.0.jar at spark://172.27.188.152:45881/jars/org.spark-project.spark_unused-1.0.0.jar with timestamp 1678427107071
23/03/10 11:15:08 INFO SparkContext: Added file file:///home/shashi/.ivy2/jars/org.apache.spark_spark-avro_2.12-3.3.2.jar at spark://172.27.188.152:45881/files/org.apache.spark_spark-avro_2.12-3.3.2.jar with timestamp 1678427107071
23/03/10 11:15:08 INFO Utils: Copying /home/shashi/.ivy2/jars/org.apache.spark_spark-avro_2.12-3.3.2.jar to /tmp/spark-caeceac7-005c-452c-b4e2-ba3cd390cb43/userFiles-bae9ee86-85c0-423d-9e89-b19c7ca728c6/org.apache.spark_spark-avro_2.12-3.3.2.jar
23/03/10 11:15:08 INFO SparkContext: Added file file:///home/shashi/.ivy2/jars/org.tukaani_xz-1.9.jar at spark://172.27.188.152:45881/files/org.tukaani_xz-1.9.jar with timestamp 1678427107071
23/03/10 11:15:08 INFO Utils: Copying /home/shashi/.ivy2/jars/org.tukaani_xz-1.9.jar to /tmp/spark-caeceac7-005c-452c-b4e2-ba3cd390cb43/userFiles-bae9ee86-85c0-423d-9e89-b19c7ca728c6/org.tukaani_xz-1.9.jar
23/03/10 11:15:08 INFO SparkContext: Added file file:///home/shashi/.ivy2/jars/org.spark-project.spark_unused-1.0.0.jar at spark://172.27.188.152:45881/files/org.spark-project.spark_unused-1.0.0.jar with timestamp 1678427107071
23/03/10 11:15:08 INFO Utils: Copying /home/shashi/.ivy2/jars/org.spark-project.spark_unused-1.0.0.jar to /tmp/spark-caeceac7-005c-452c-b4e2-ba3cd390cb43/userFiles-bae9ee86-85c0-423d-9e89-b19c7ca728c6/org.spark-project.spark_unused-1.0.0.jar
23/03/10 11:15:08 INFO StandaloneAppClient$ClientEndpoint: Connecting to master spark://MILES-BL-4819-LAP.:7077...
23/03/10 11:15:08 INFO TransportClientFactory: Successfully created connection to MILES-BL-4819-LAP./127.0.1.1:7077 after 59 ms (0 ms spent in bootstraps)
23/03/10 11:15:09 INFO StandaloneSchedulerBackend: Connected to Spark cluster with app ID app-20230310111509-0007
23/03/10 11:15:09 INFO StandaloneAppClient$ClientEndpoint: Executor added: app-20230310111509-0007/0 on worker-20230309123128-172.27.188.152-45151 (172.27.188.152:45151) with 8 core(s)
23/03/10 11:15:09 INFO StandaloneSchedulerBackend: Granted executor ID app-20230310111509-0007/0 on hostPort 172.27.188.152:45151 with 8 core(s), 1024.0 MiB RAM
23/03/10 11:15:09 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 43967.
23/03/10 11:15:09 INFO NettyBlockTransferService: Server created on 172.27.188.152:43967
23/03/10 11:15:09 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
23/03/10 11:15:09 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, 172.27.188.152, 43967, None)
23/03/10 11:15:09 INFO BlockManagerMasterEndpoint: Registering block manager 172.27.188.152:43967 with 366.3 MiB RAM, BlockManagerId(driver, 172.27.188.152, 43967, None)
23/03/10 11:15:09 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, 172.27.188.152, 43967, None)
23/03/10 11:15:09 INFO BlockManager: Initialized BlockManager: BlockManagerId(driver, 172.27.188.152, 43967, None)
23/03/10 11:15:09 INFO StandaloneAppClient$ClientEndpoint: Executor updated: app-20230310111509-0007/0 is now RUNNING
23/03/10 11:15:09 INFO SingleEventLogFileWriter: Logging events to file:/tmp/spark-events/app-20230310111509-0007.inprogress
23/03/10 11:15:09 INFO StandaloneSchedulerBackend: SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio: 0.0
23/03/10 11:15:10 INFO SharedState: Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir.
23/03/10 11:15:10 INFO SharedState: Warehouse path is 'file:/home/shashi/spark-warehouse'.
23/03/10 11:15:11 INFO InMemoryFileIndex: It took 118 ms to list leaf files for 1 paths.
23/03/10 11:15:12 INFO InMemoryFileIndex: It took 66 ms to list leaf files for 1 paths.
23/03/10 11:15:14 INFO CoarseGrainedSchedulerBackend$DriverEndpoint: Registered executor NettyRpcEndpointRef(spark-client://Executor) (172.27.188.152:45916) with ID 0,  ResourceProfileId 0
23/03/10 11:15:14 INFO BlockManagerMasterEndpoint: Registering block manager 172.27.188.152:43031 with 366.3 MiB RAM, BlockManagerId(0, 172.27.188.152, 43031, None)
23/03/10 11:15:15 INFO FileSourceStrategy: Pushed Filters: 
23/03/10 11:15:15 INFO FileSourceStrategy: Post-Scan Filters: (length(trim(value#0, None)) > 0)
23/03/10 11:15:15 INFO FileSourceStrategy: Output Data Schema: struct<value: string>
23/03/10 11:15:16 INFO CodeGenerator: Code generated in 229.460595 ms
23/03/10 11:15:16 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 353.3 KiB, free 366.0 MiB)
23/03/10 11:15:16 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 34.8 KiB, free 365.9 MiB)
23/03/10 11:15:16 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 172.27.188.152:43967 (size: 34.8 KiB, free: 366.3 MiB)
23/03/10 11:15:16 INFO SparkContext: Created broadcast 0 from load at NativeMethodAccessorImpl.java:0
23/03/10 11:15:16 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 11:15:16 INFO SparkContext: Starting job: load at NativeMethodAccessorImpl.java:0
23/03/10 11:15:16 INFO DAGScheduler: Got job 0 (load at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 11:15:16 INFO DAGScheduler: Final stage: ResultStage 0 (load at NativeMethodAccessorImpl.java:0)
23/03/10 11:15:16 INFO DAGScheduler: Parents of final stage: List()
23/03/10 11:15:16 INFO DAGScheduler: Missing parents: List()
23/03/10 11:15:16 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at load at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:15:16 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 11.9 KiB, free 365.9 MiB)
23/03/10 11:15:16 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 5.9 KiB, free 365.9 MiB)
23/03/10 11:15:16 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on 172.27.188.152:43967 (size: 5.9 KiB, free: 366.3 MiB)
23/03/10 11:15:16 INFO SparkContext: Created broadcast 1 from broadcast at DAGScheduler.scala:1513
23/03/10 11:15:16 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at load at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 11:15:17 INFO TaskSchedulerImpl: Adding task set 0.0 with 1 tasks resource profile 0
23/03/10 11:15:17 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 4985 bytes) taskResourceAssignments Map()
23/03/10 11:15:17 INFO BlockManagerInfo: Added broadcast_1_piece0 in memory on 172.27.188.152:43031 (size: 5.9 KiB, free: 366.3 MiB)
23/03/10 11:15:18 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 172.27.188.152:43031 (size: 34.8 KiB, free: 366.3 MiB)
23/03/10 11:15:18 INFO TaskSetManager: Finished task 0.0 in stage 0.0 (TID 0) in 1742 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 11:15:18 INFO TaskSchedulerImpl: Removed TaskSet 0.0, whose tasks have all completed, from pool 
23/03/10 11:15:18 INFO DAGScheduler: ResultStage 0 (load at NativeMethodAccessorImpl.java:0) finished in 1.899 s
23/03/10 11:15:18 INFO DAGScheduler: Job 0 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 11:15:18 INFO TaskSchedulerImpl: Killing all running tasks in stage 0: Stage finished
23/03/10 11:15:18 INFO DAGScheduler: Job 0 finished: load at NativeMethodAccessorImpl.java:0, took 1.989437 s
23/03/10 11:15:18 INFO CodeGenerator: Code generated in 16.759829 ms
23/03/10 11:15:18 INFO BlockManagerInfo: Removed broadcast_1_piece0 on 172.27.188.152:43967 in memory (size: 5.9 KiB, free: 366.3 MiB)
23/03/10 11:15:18 INFO BlockManagerInfo: Removed broadcast_1_piece0 on 172.27.188.152:43031 in memory (size: 5.9 KiB, free: 366.3 MiB)
23/03/10 11:15:18 INFO FileSourceStrategy: Pushed Filters: 
23/03/10 11:15:18 INFO FileSourceStrategy: Post-Scan Filters: 
23/03/10 11:15:18 INFO FileSourceStrategy: Output Data Schema: struct<value: string>
23/03/10 11:15:18 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 353.3 KiB, free 365.6 MiB)
23/03/10 11:15:19 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 34.8 KiB, free 365.5 MiB)
23/03/10 11:15:19 INFO BlockManagerInfo: Added broadcast_2_piece0 in memory on 172.27.188.152:43967 (size: 34.8 KiB, free: 366.2 MiB)
23/03/10 11:15:19 INFO SparkContext: Created broadcast 2 from load at NativeMethodAccessorImpl.java:0
23/03/10 11:15:19 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 11:15:19 INFO FileSourceStrategy: Pushed Filters: IsNotNull(y),EqualTo(y,yes)
23/03/10 11:15:19 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(y#33),(y#33 = yes)
23/03/10 11:15:19 INFO FileSourceStrategy: Output Data Schema: struct<age: string, y: string>
23/03/10 11:15:19 INFO ParquetFileFormat: Using default output committer for Parquet: org.apache.parquet.hadoop.ParquetOutputCommitter
23/03/10 11:15:19 INFO CodeGenerator: Code generated in 89.921327 ms
23/03/10 11:15:19 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 353.2 KiB, free 365.2 MiB)
23/03/10 11:15:19 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 34.8 KiB, free 365.2 MiB)
23/03/10 11:15:19 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on 172.27.188.152:43967 (size: 34.8 KiB, free: 366.2 MiB)
23/03/10 11:15:19 INFO SparkContext: Created broadcast 3 from parquet at NativeMethodAccessorImpl.java:0
23/03/10 11:15:19 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 11:15:20 INFO DAGScheduler: Registering RDD 13 (parquet at NativeMethodAccessorImpl.java:0) as input to shuffle 0
23/03/10 11:15:20 INFO DAGScheduler: Got map stage job 1 (parquet at NativeMethodAccessorImpl.java:0) with 2 output partitions
23/03/10 11:15:20 INFO DAGScheduler: Final stage: ShuffleMapStage 1 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 11:15:20 INFO DAGScheduler: Parents of final stage: List()
23/03/10 11:15:20 INFO DAGScheduler: Missing parents: List()
23/03/10 11:15:20 INFO DAGScheduler: Submitting ShuffleMapStage 1 (MapPartitionsRDD[13] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:15:20 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 38.5 KiB, free 365.1 MiB)
23/03/10 11:15:20 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 18.2 KiB, free 365.1 MiB)
23/03/10 11:15:20 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on 172.27.188.152:43967 (size: 18.2 KiB, free: 366.2 MiB)
23/03/10 11:15:20 INFO SparkContext: Created broadcast 4 from broadcast at DAGScheduler.scala:1513
23/03/10 11:15:20 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 1 (MapPartitionsRDD[13] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
23/03/10 11:15:20 INFO TaskSchedulerImpl: Adding task set 1.0 with 2 tasks resource profile 0
23/03/10 11:15:20 INFO TaskSetManager: Starting task 0.0 in stage 1.0 (TID 1) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 4974 bytes) taskResourceAssignments Map()
23/03/10 11:15:20 INFO TaskSetManager: Starting task 1.0 in stage 1.0 (TID 2) (172.27.188.152, executor 0, partition 1, PROCESS_LOCAL, 4974 bytes) taskResourceAssignments Map()
23/03/10 11:15:20 INFO BlockManagerInfo: Added broadcast_4_piece0 in memory on 172.27.188.152:43031 (size: 18.2 KiB, free: 366.2 MiB)
23/03/10 11:15:20 INFO BlockManagerInfo: Added broadcast_3_piece0 in memory on 172.27.188.152:43031 (size: 34.8 KiB, free: 366.2 MiB)
23/03/10 11:15:21 INFO TaskSetManager: Finished task 1.0 in stage 1.0 (TID 2) in 1018 ms on 172.27.188.152 (executor 0) (1/2)
23/03/10 11:15:21 INFO TaskSetManager: Finished task 0.0 in stage 1.0 (TID 1) in 1107 ms on 172.27.188.152 (executor 0) (2/2)
23/03/10 11:15:21 INFO TaskSchedulerImpl: Removed TaskSet 1.0, whose tasks have all completed, from pool 
23/03/10 11:15:21 INFO DAGScheduler: ShuffleMapStage 1 (parquet at NativeMethodAccessorImpl.java:0) finished in 1.139 s
23/03/10 11:15:21 INFO DAGScheduler: looking for newly runnable stages
23/03/10 11:15:21 INFO DAGScheduler: running: Set()
23/03/10 11:15:21 INFO DAGScheduler: waiting: Set()
23/03/10 11:15:21 INFO DAGScheduler: failed: Set()
23/03/10 11:15:21 INFO ShufflePartitionsUtil: For shuffle(0), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
23/03/10 11:15:21 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
23/03/10 11:15:21 INFO CodeGenerator: Code generated in 30.669926 ms
23/03/10 11:15:21 INFO CodeGenerator: Code generated in 18.39387 ms
23/03/10 11:15:21 INFO SparkContext: Starting job: parquet at NativeMethodAccessorImpl.java:0
23/03/10 11:15:21 INFO DAGScheduler: Got job 2 (parquet at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 11:15:21 INFO DAGScheduler: Final stage: ResultStage 3 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 11:15:21 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 2)
23/03/10 11:15:21 INFO DAGScheduler: Missing parents: List()
23/03/10 11:15:21 INFO DAGScheduler: Submitting ResultStage 3 (MapPartitionsRDD[18] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:15:21 INFO MemoryStore: Block broadcast_5 stored as values in memory (estimated size 40.0 KiB, free 365.1 MiB)
23/03/10 11:15:21 INFO MemoryStore: Block broadcast_5_piece0 stored as bytes in memory (estimated size 19.2 KiB, free 365.0 MiB)
23/03/10 11:15:21 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on 172.27.188.152:43967 (size: 19.2 KiB, free: 366.2 MiB)
23/03/10 11:15:21 INFO SparkContext: Created broadcast 5 from broadcast at DAGScheduler.scala:1513
23/03/10 11:15:21 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 3 (MapPartitionsRDD[18] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 11:15:21 INFO TaskSchedulerImpl: Adding task set 3.0 with 1 tasks resource profile 0
23/03/10 11:15:21 INFO TaskSetManager: Starting task 0.0 in stage 3.0 (TID 3) (172.27.188.152, executor 0, partition 0, NODE_LOCAL, 4457 bytes) taskResourceAssignments Map()
23/03/10 11:15:21 INFO BlockManagerInfo: Added broadcast_5_piece0 in memory on 172.27.188.152:43031 (size: 19.2 KiB, free: 366.2 MiB)
23/03/10 11:15:21 INFO MapOutputTrackerMasterEndpoint: Asked to send map output locations for shuffle 0 to 172.27.188.152:45916
23/03/10 11:15:21 INFO TaskSetManager: Finished task 0.0 in stage 3.0 (TID 3) in 378 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 11:15:21 INFO TaskSchedulerImpl: Removed TaskSet 3.0, whose tasks have all completed, from pool 
23/03/10 11:15:21 INFO DAGScheduler: ResultStage 3 (parquet at NativeMethodAccessorImpl.java:0) finished in 0.412 s
23/03/10 11:15:21 INFO DAGScheduler: Job 2 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 11:15:21 INFO TaskSchedulerImpl: Killing all running tasks in stage 3: Stage finished
23/03/10 11:15:21 INFO DAGScheduler: Job 2 finished: parquet at NativeMethodAccessorImpl.java:0, took 0.462142 s
23/03/10 11:15:21 INFO DAGScheduler: Registering RDD 19 (parquet at NativeMethodAccessorImpl.java:0) as input to shuffle 1
23/03/10 11:15:21 INFO DAGScheduler: Got map stage job 3 (parquet at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 11:15:21 INFO DAGScheduler: Final stage: ShuffleMapStage 5 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 11:15:21 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 4)
23/03/10 11:15:21 INFO DAGScheduler: Missing parents: List()
23/03/10 11:15:21 INFO DAGScheduler: Submitting ShuffleMapStage 5 (MapPartitionsRDD[19] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:15:21 INFO MemoryStore: Block broadcast_6 stored as values in memory (estimated size 42.0 KiB, free 365.0 MiB)
23/03/10 11:15:22 INFO MemoryStore: Block broadcast_6_piece0 stored as bytes in memory (estimated size 19.9 KiB, free 365.0 MiB)
23/03/10 11:15:22 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on 172.27.188.152:43967 (size: 19.9 KiB, free: 366.1 MiB)
23/03/10 11:15:22 INFO SparkContext: Created broadcast 6 from broadcast at DAGScheduler.scala:1513
23/03/10 11:15:22 INFO DAGScheduler: Submitting 1 missing tasks from ShuffleMapStage 5 (MapPartitionsRDD[19] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 11:15:22 INFO TaskSchedulerImpl: Adding task set 5.0 with 1 tasks resource profile 0
23/03/10 11:15:22 INFO TaskSetManager: Starting task 0.0 in stage 5.0 (TID 4) (172.27.188.152, executor 0, partition 0, NODE_LOCAL, 4446 bytes) taskResourceAssignments Map()
23/03/10 11:15:22 INFO BlockManagerInfo: Added broadcast_6_piece0 in memory on 172.27.188.152:43031 (size: 19.9 KiB, free: 366.2 MiB)
23/03/10 11:15:22 INFO TaskSetManager: Finished task 0.0 in stage 5.0 (TID 4) in 132 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 11:15:22 INFO TaskSchedulerImpl: Removed TaskSet 5.0, whose tasks have all completed, from pool 
23/03/10 11:15:22 INFO DAGScheduler: ShuffleMapStage 5 (parquet at NativeMethodAccessorImpl.java:0) finished in 0.162 s
23/03/10 11:15:22 INFO DAGScheduler: looking for newly runnable stages
23/03/10 11:15:22 INFO DAGScheduler: running: Set()
23/03/10 11:15:22 INFO DAGScheduler: waiting: Set()
23/03/10 11:15:22 INFO DAGScheduler: failed: Set()
23/03/10 11:15:22 INFO ShufflePartitionsUtil: For shuffle(1), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
23/03/10 11:15:22 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
23/03/10 11:15:22 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
23/03/10 11:15:22 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
23/03/10 11:15:22 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
23/03/10 11:15:22 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
23/03/10 11:15:22 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
23/03/10 11:15:22 INFO CodeGenerator: Code generated in 24.240247 ms
23/03/10 11:15:22 INFO SparkContext: Starting job: parquet at NativeMethodAccessorImpl.java:0
23/03/10 11:15:22 INFO DAGScheduler: Got job 4 (parquet at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 11:15:22 INFO DAGScheduler: Final stage: ResultStage 8 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 11:15:22 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 7)
23/03/10 11:15:22 INFO DAGScheduler: Missing parents: List()
23/03/10 11:15:22 INFO DAGScheduler: Submitting ResultStage 8 (MapPartitionsRDD[21] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:15:22 INFO MemoryStore: Block broadcast_7 stored as values in memory (estimated size 240.4 KiB, free 364.8 MiB)
23/03/10 11:15:22 INFO MemoryStore: Block broadcast_7_piece0 stored as bytes in memory (estimated size 89.4 KiB, free 364.7 MiB)
23/03/10 11:15:22 INFO BlockManagerInfo: Added broadcast_7_piece0 in memory on 172.27.188.152:43967 (size: 89.4 KiB, free: 366.1 MiB)
23/03/10 11:15:22 INFO SparkContext: Created broadcast 7 from broadcast at DAGScheduler.scala:1513
23/03/10 11:15:22 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 8 (MapPartitionsRDD[21] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 11:15:22 INFO TaskSchedulerImpl: Adding task set 8.0 with 1 tasks resource profile 0
23/03/10 11:15:22 INFO TaskSetManager: Starting task 0.0 in stage 8.0 (TID 5) (172.27.188.152, executor 0, partition 0, NODE_LOCAL, 4457 bytes) taskResourceAssignments Map()
23/03/10 11:15:22 INFO BlockManagerInfo: Added broadcast_7_piece0 in memory on 172.27.188.152:43031 (size: 89.4 KiB, free: 366.1 MiB)
23/03/10 11:15:22 INFO MapOutputTrackerMasterEndpoint: Asked to send map output locations for shuffle 1 to 172.27.188.152:45916
23/03/10 11:15:24 INFO TaskSetManager: Finished task 0.0 in stage 8.0 (TID 5) in 1936 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 11:15:24 INFO TaskSchedulerImpl: Removed TaskSet 8.0, whose tasks have all completed, from pool 
23/03/10 11:15:24 INFO DAGScheduler: ResultStage 8 (parquet at NativeMethodAccessorImpl.java:0) finished in 1.983 s
23/03/10 11:15:24 INFO DAGScheduler: Job 4 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 11:15:24 INFO TaskSchedulerImpl: Killing all running tasks in stage 8: Stage finished
23/03/10 11:15:24 INFO DAGScheduler: Job 4 finished: parquet at NativeMethodAccessorImpl.java:0, took 2.007814 s
23/03/10 11:15:24 INFO FileFormatWriter: Start to commit write Job dcf665e7-4e22-4f3a-b5d6-3f4c683f382a.
23/03/10 11:15:25 INFO FileFormatWriter: Write Job dcf665e7-4e22-4f3a-b5d6-3f4c683f382a committed. Elapsed time: 819 ms.
23/03/10 11:15:25 INFO FileFormatWriter: Finished processing stats for write job dcf665e7-4e22-4f3a-b5d6-3f4c683f382a.
#######  Created Parquet File  #########
23/03/10 11:15:25 INFO InMemoryFileIndex: It took 128 ms to list leaf files for 1 paths.
23/03/10 11:15:25 INFO SparkContext: Starting job: parquet at NativeMethodAccessorImpl.java:0
23/03/10 11:15:25 INFO DAGScheduler: Got job 5 (parquet at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 11:15:25 INFO DAGScheduler: Final stage: ResultStage 9 (parquet at NativeMethodAccessorImpl.java:0)
23/03/10 11:15:25 INFO DAGScheduler: Parents of final stage: List()
23/03/10 11:15:25 INFO DAGScheduler: Missing parents: List()
23/03/10 11:15:25 INFO DAGScheduler: Submitting ResultStage 9 (MapPartitionsRDD[23] at parquet at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:15:25 INFO MemoryStore: Block broadcast_8 stored as values in memory (estimated size 104.4 KiB, free 364.6 MiB)
23/03/10 11:15:25 INFO MemoryStore: Block broadcast_8_piece0 stored as bytes in memory (estimated size 37.6 KiB, free 364.5 MiB)
23/03/10 11:15:25 INFO BlockManagerInfo: Added broadcast_8_piece0 in memory on 172.27.188.152:43967 (size: 37.6 KiB, free: 366.0 MiB)
23/03/10 11:15:25 INFO SparkContext: Created broadcast 8 from broadcast at DAGScheduler.scala:1513
23/03/10 11:15:25 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 9 (MapPartitionsRDD[23] at parquet at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 11:15:25 INFO TaskSchedulerImpl: Adding task set 9.0 with 1 tasks resource profile 0
23/03/10 11:15:25 INFO TaskSetManager: Starting task 0.0 in stage 9.0 (TID 6) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 4731 bytes) taskResourceAssignments Map()
23/03/10 11:15:25 INFO BlockManagerInfo: Added broadcast_8_piece0 in memory on 172.27.188.152:43031 (size: 37.6 KiB, free: 366.1 MiB)
23/03/10 11:15:25 INFO TaskSetManager: Finished task 0.0 in stage 9.0 (TID 6) in 197 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 11:15:25 INFO TaskSchedulerImpl: Removed TaskSet 9.0, whose tasks have all completed, from pool 
23/03/10 11:15:25 INFO DAGScheduler: ResultStage 9 (parquet at NativeMethodAccessorImpl.java:0) finished in 0.221 s
23/03/10 11:15:25 INFO DAGScheduler: Job 5 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 11:15:25 INFO TaskSchedulerImpl: Killing all running tasks in stage 9: Stage finished
23/03/10 11:15:25 INFO DAGScheduler: Job 5 finished: parquet at NativeMethodAccessorImpl.java:0, took 0.237297 s
##########   Parquet File Output    ########################
23/03/10 11:15:25 INFO FileSourceStrategy: Pushed Filters: 
23/03/10 11:15:25 INFO FileSourceStrategy: Post-Scan Filters: 
23/03/10 11:15:25 INFO FileSourceStrategy: Output Data Schema: struct<age: string, count: bigint>
23/03/10 11:15:25 INFO CodeGenerator: Code generated in 22.448209 ms
23/03/10 11:15:25 INFO MemoryStore: Block broadcast_9 stored as values in memory (estimated size 357.5 KiB, free 364.2 MiB)
23/03/10 11:15:25 INFO MemoryStore: Block broadcast_9_piece0 stored as bytes in memory (estimated size 35.4 KiB, free 364.1 MiB)
23/03/10 11:15:25 INFO BlockManagerInfo: Added broadcast_9_piece0 in memory on 172.27.188.152:43967 (size: 35.4 KiB, free: 366.0 MiB)
23/03/10 11:15:25 INFO SparkContext: Created broadcast 9 from showString at NativeMethodAccessorImpl.java:0
23/03/10 11:15:25 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 11:15:25 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
23/03/10 11:15:25 INFO DAGScheduler: Got job 6 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 11:15:25 INFO DAGScheduler: Final stage: ResultStage 10 (showString at NativeMethodAccessorImpl.java:0)
23/03/10 11:15:25 INFO DAGScheduler: Parents of final stage: List()
23/03/10 11:15:25 INFO DAGScheduler: Missing parents: List()
23/03/10 11:15:25 INFO DAGScheduler: Submitting ResultStage 10 (MapPartitionsRDD[27] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:15:25 INFO MemoryStore: Block broadcast_10 stored as values in memory (estimated size 13.6 KiB, free 364.1 MiB)
23/03/10 11:15:25 INFO MemoryStore: Block broadcast_10_piece0 stored as bytes in memory (estimated size 6.1 KiB, free 364.1 MiB)
23/03/10 11:15:25 INFO BlockManagerInfo: Added broadcast_10_piece0 in memory on 172.27.188.152:43967 (size: 6.1 KiB, free: 366.0 MiB)
23/03/10 11:15:25 INFO SparkContext: Created broadcast 10 from broadcast at DAGScheduler.scala:1513
23/03/10 11:15:25 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 10 (MapPartitionsRDD[27] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 11:15:25 INFO TaskSchedulerImpl: Adding task set 10.0 with 1 tasks resource profile 0
23/03/10 11:15:25 INFO TaskSetManager: Starting task 0.0 in stage 10.0 (TID 7) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 5056 bytes) taskResourceAssignments Map()
23/03/10 11:15:25 INFO BlockManagerInfo: Added broadcast_10_piece0 in memory on 172.27.188.152:43031 (size: 6.1 KiB, free: 366.0 MiB)
23/03/10 11:15:26 INFO BlockManagerInfo: Added broadcast_9_piece0 in memory on 172.27.188.152:43031 (size: 35.4 KiB, free: 366.0 MiB)
23/03/10 11:15:26 INFO TaskSetManager: Finished task 0.0 in stage 10.0 (TID 7) in 405 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 11:15:26 INFO TaskSchedulerImpl: Removed TaskSet 10.0, whose tasks have all completed, from pool 
23/03/10 11:15:26 INFO DAGScheduler: ResultStage 10 (showString at NativeMethodAccessorImpl.java:0) finished in 0.436 s
23/03/10 11:15:26 INFO DAGScheduler: Job 6 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 11:15:26 INFO TaskSchedulerImpl: Killing all running tasks in stage 10: Stage finished
23/03/10 11:15:26 INFO DAGScheduler: Job 6 finished: showString at NativeMethodAccessorImpl.java:0, took 0.455854 s
23/03/10 11:15:26 INFO CodeGenerator: Code generated in 9.119863 ms
+---+-----+
|age|count|
+---+-----+
| 32|  221|
| 30|  217|
| 33|  210|
| 35|  209|
| 31|  206|
| 34|  198|
| 36|  195|
| 29|  171|
| 37|  170|
| 28|  162|
| 38|  144|
| 39|  143|
| 27|  141|
| 26|  134|
| 41|  120|
| 46|  118|
| 40|  116|
| 47|  113|
| 25|  113|
| 42|  111|
+---+-----+
only showing top 20 rows

None
23/03/10 11:15:26 INFO BlockManagerInfo: Removed broadcast_4_piece0 on 172.27.188.152:43967 in memory (size: 18.2 KiB, free: 366.0 MiB)
23/03/10 11:15:26 INFO BlockManagerInfo: Removed broadcast_4_piece0 on 172.27.188.152:43031 in memory (size: 18.2 KiB, free: 366.0 MiB)
23/03/10 11:15:26 INFO BlockManagerInfo: Removed broadcast_5_piece0 on 172.27.188.152:43967 in memory (size: 19.2 KiB, free: 366.0 MiB)
23/03/10 11:15:26 INFO BlockManagerInfo: Removed broadcast_5_piece0 on 172.27.188.152:43031 in memory (size: 19.2 KiB, free: 366.0 MiB)
23/03/10 11:15:26 INFO BlockManagerInfo: Removed broadcast_3_piece0 on 172.27.188.152:43967 in memory (size: 34.8 KiB, free: 366.0 MiB)
23/03/10 11:15:26 INFO BlockManagerInfo: Removed broadcast_3_piece0 on 172.27.188.152:43031 in memory (size: 34.8 KiB, free: 366.1 MiB)
23/03/10 11:15:26 INFO BlockManagerInfo: Removed broadcast_8_piece0 on 172.27.188.152:43031 in memory (size: 37.6 KiB, free: 366.1 MiB)
23/03/10 11:15:26 INFO BlockManagerInfo: Removed broadcast_8_piece0 on 172.27.188.152:43967 in memory (size: 37.6 KiB, free: 366.1 MiB)
23/03/10 11:15:26 INFO BlockManagerInfo: Removed broadcast_7_piece0 on 172.27.188.152:43967 in memory (size: 89.4 KiB, free: 366.2 MiB)
23/03/10 11:15:26 INFO BlockManagerInfo: Removed broadcast_7_piece0 on 172.27.188.152:43031 in memory (size: 89.4 KiB, free: 366.2 MiB)
23/03/10 11:15:26 INFO BlockManagerInfo: Removed broadcast_10_piece0 on 172.27.188.152:43967 in memory (size: 6.1 KiB, free: 366.2 MiB)
23/03/10 11:15:26 INFO BlockManagerInfo: Removed broadcast_10_piece0 on 172.27.188.152:43031 in memory (size: 6.1 KiB, free: 366.2 MiB)
23/03/10 11:15:26 INFO BlockManagerInfo: Removed broadcast_6_piece0 on 172.27.188.152:43967 in memory (size: 19.9 KiB, free: 366.2 MiB)
23/03/10 11:15:26 INFO BlockManagerInfo: Removed broadcast_6_piece0 on 172.27.188.152:43031 in memory (size: 19.9 KiB, free: 366.2 MiB)
23/03/10 11:15:26 INFO BlockManagerInfo: Removed broadcast_0_piece0 on 172.27.188.152:43967 in memory (size: 34.8 KiB, free: 366.2 MiB)
23/03/10 11:15:26 INFO BlockManagerInfo: Removed broadcast_0_piece0 on 172.27.188.152:43031 in memory (size: 34.8 KiB, free: 366.3 MiB)
23/03/10 11:15:26 INFO FileSourceStrategy: Pushed Filters: IsNotNull(y),EqualTo(y,yes)
23/03/10 11:15:26 INFO FileSourceStrategy: Post-Scan Filters: isnotnull(y#33),(y#33 = yes)
23/03/10 11:15:26 INFO FileSourceStrategy: Output Data Schema: struct<age: string, y: string>
23/03/10 11:15:26 INFO deprecation: mapred.output.compress is deprecated. Instead, use mapreduce.output.fileoutputformat.compress
23/03/10 11:15:26 INFO AvroUtils: Compressing Avro output using the snappy codec
23/03/10 11:15:26 INFO CodeGenerator: Code generated in 50.620405 ms
23/03/10 11:15:26 INFO CodeGenerator: Code generated in 14.69751 ms
23/03/10 11:15:26 INFO MemoryStore: Block broadcast_11 stored as values in memory (estimated size 353.2 KiB, free 365.2 MiB)
23/03/10 11:15:26 INFO MemoryStore: Block broadcast_11_piece0 stored as bytes in memory (estimated size 34.8 KiB, free 365.2 MiB)
23/03/10 11:15:26 INFO BlockManagerInfo: Added broadcast_11_piece0 in memory on 172.27.188.152:43967 (size: 34.8 KiB, free: 366.2 MiB)
23/03/10 11:15:26 INFO SparkContext: Created broadcast 11 from save at NativeMethodAccessorImpl.java:0
23/03/10 11:15:26 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 11:15:26 INFO DAGScheduler: Registering RDD 34 (save at NativeMethodAccessorImpl.java:0) as input to shuffle 2
23/03/10 11:15:26 INFO DAGScheduler: Got map stage job 7 (save at NativeMethodAccessorImpl.java:0) with 2 output partitions
23/03/10 11:15:26 INFO DAGScheduler: Final stage: ShuffleMapStage 11 (save at NativeMethodAccessorImpl.java:0)
23/03/10 11:15:26 INFO DAGScheduler: Parents of final stage: List()
23/03/10 11:15:26 INFO DAGScheduler: Missing parents: List()
23/03/10 11:15:26 INFO DAGScheduler: Submitting ShuffleMapStage 11 (MapPartitionsRDD[34] at save at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:15:26 INFO MemoryStore: Block broadcast_12 stored as values in memory (estimated size 46.0 KiB, free 365.1 MiB)
23/03/10 11:15:26 INFO MemoryStore: Block broadcast_12_piece0 stored as bytes in memory (estimated size 21.8 KiB, free 365.1 MiB)
23/03/10 11:15:26 INFO BlockManagerInfo: Added broadcast_12_piece0 in memory on 172.27.188.152:43967 (size: 21.8 KiB, free: 366.2 MiB)
23/03/10 11:15:27 INFO SparkContext: Created broadcast 12 from broadcast at DAGScheduler.scala:1513
23/03/10 11:15:27 INFO DAGScheduler: Submitting 2 missing tasks from ShuffleMapStage 11 (MapPartitionsRDD[34] at save at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0, 1))
23/03/10 11:15:27 INFO TaskSchedulerImpl: Adding task set 11.0 with 2 tasks resource profile 0
23/03/10 11:15:27 INFO TaskSetManager: Starting task 0.0 in stage 11.0 (TID 8) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 4974 bytes) taskResourceAssignments Map()
23/03/10 11:15:27 INFO TaskSetManager: Starting task 1.0 in stage 11.0 (TID 9) (172.27.188.152, executor 0, partition 1, PROCESS_LOCAL, 4974 bytes) taskResourceAssignments Map()
23/03/10 11:15:27 INFO BlockManagerInfo: Added broadcast_12_piece0 in memory on 172.27.188.152:43031 (size: 21.8 KiB, free: 366.2 MiB)
23/03/10 11:15:27 INFO BlockManagerInfo: Added broadcast_11_piece0 in memory on 172.27.188.152:43031 (size: 34.8 KiB, free: 366.2 MiB)
23/03/10 11:15:27 INFO TaskSetManager: Finished task 1.0 in stage 11.0 (TID 9) in 927 ms on 172.27.188.152 (executor 0) (1/2)
23/03/10 11:15:27 INFO PythonAccumulatorV2: Connected to AccumulatorServer at host: 127.0.0.1 port: 46167
23/03/10 11:15:28 INFO TaskSetManager: Finished task 0.0 in stage 11.0 (TID 8) in 1012 ms on 172.27.188.152 (executor 0) (2/2)
23/03/10 11:15:28 INFO TaskSchedulerImpl: Removed TaskSet 11.0, whose tasks have all completed, from pool 
23/03/10 11:15:28 INFO DAGScheduler: ShuffleMapStage 11 (save at NativeMethodAccessorImpl.java:0) finished in 1.034 s
23/03/10 11:15:28 INFO DAGScheduler: looking for newly runnable stages
23/03/10 11:15:28 INFO DAGScheduler: running: Set()
23/03/10 11:15:28 INFO DAGScheduler: waiting: Set()
23/03/10 11:15:28 INFO DAGScheduler: failed: Set()
23/03/10 11:15:28 INFO ShufflePartitionsUtil: For shuffle(2), advisory target size: 67108864, actual target size 1048576, minimum partition size: 1048576
23/03/10 11:15:28 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
23/03/10 11:15:28 INFO FileOutputCommitter: FileOutputCommitter skip cleanup _temporary folders under output directory:false, ignore cleanup failures: false
23/03/10 11:15:28 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter
23/03/10 11:15:28 INFO HashAggregateExec: spark.sql.codegen.aggregate.map.twolevel.enabled is set to true, but current version of codegened fast hashmap does not support this aggregate.
23/03/10 11:15:28 INFO CodeGenerator: Code generated in 26.383334 ms
23/03/10 11:15:28 INFO SparkContext: Starting job: save at NativeMethodAccessorImpl.java:0
23/03/10 11:15:28 INFO DAGScheduler: Got job 8 (save at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 11:15:28 INFO DAGScheduler: Final stage: ResultStage 13 (save at NativeMethodAccessorImpl.java:0)
23/03/10 11:15:28 INFO DAGScheduler: Parents of final stage: List(ShuffleMapStage 12)
23/03/10 11:15:28 INFO DAGScheduler: Missing parents: List()
23/03/10 11:15:28 INFO DAGScheduler: Submitting ResultStage 13 (MapPartitionsRDD[36] at save at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:15:28 INFO MemoryStore: Block broadcast_13 stored as values in memory (estimated size 245.5 KiB, free 364.9 MiB)
23/03/10 11:15:28 INFO MemoryStore: Block broadcast_13_piece0 stored as bytes in memory (estimated size 91.9 KiB, free 364.8 MiB)
23/03/10 11:15:28 INFO BlockManagerInfo: Added broadcast_13_piece0 in memory on 172.27.188.152:43967 (size: 91.9 KiB, free: 366.1 MiB)
23/03/10 11:15:28 INFO SparkContext: Created broadcast 13 from broadcast at DAGScheduler.scala:1513
23/03/10 11:15:28 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 13 (MapPartitionsRDD[36] at save at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 11:15:28 INFO TaskSchedulerImpl: Adding task set 13.0 with 1 tasks resource profile 0
23/03/10 11:15:28 INFO TaskSetManager: Starting task 0.0 in stage 13.0 (TID 10) (172.27.188.152, executor 0, partition 0, NODE_LOCAL, 4457 bytes) taskResourceAssignments Map()
23/03/10 11:15:28 INFO BlockManagerInfo: Added broadcast_13_piece0 in memory on 172.27.188.152:43031 (size: 91.9 KiB, free: 366.1 MiB)
23/03/10 11:15:28 INFO MapOutputTrackerMasterEndpoint: Asked to send map output locations for shuffle 2 to 172.27.188.152:45916
23/03/10 11:15:29 INFO TaskSetManager: Finished task 0.0 in stage 13.0 (TID 10) in 871 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 11:15:29 INFO TaskSchedulerImpl: Removed TaskSet 13.0, whose tasks have all completed, from pool 
23/03/10 11:15:29 INFO DAGScheduler: ResultStage 13 (save at NativeMethodAccessorImpl.java:0) finished in 0.906 s
23/03/10 11:15:29 INFO DAGScheduler: Job 8 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 11:15:29 INFO TaskSchedulerImpl: Killing all running tasks in stage 13: Stage finished
23/03/10 11:15:29 INFO DAGScheduler: Job 8 finished: save at NativeMethodAccessorImpl.java:0, took 0.922660 s
23/03/10 11:15:29 INFO FileFormatWriter: Start to commit write Job 4a85a3b3-7ee3-433b-b606-34e9ad711ad6.
23/03/10 11:15:30 INFO FileFormatWriter: Write Job 4a85a3b3-7ee3-433b-b606-34e9ad711ad6 committed. Elapsed time: 818 ms.
23/03/10 11:15:30 INFO FileFormatWriter: Finished processing stats for write job 4a85a3b3-7ee3-433b-b606-34e9ad711ad6.
#######  Created Avro File  #########
23/03/10 11:15:30 INFO InMemoryFileIndex: It took 148 ms to list leaf files for 1 paths.
##########   Avro File Output    ########################
23/03/10 11:15:30 INFO FileSourceStrategy: Pushed Filters: 
23/03/10 11:15:30 INFO FileSourceStrategy: Post-Scan Filters: 
23/03/10 11:15:30 INFO FileSourceStrategy: Output Data Schema: struct<age_cat: string, count: bigint>
23/03/10 11:15:30 INFO CodeGenerator: Code generated in 12.904969 ms
23/03/10 11:15:30 INFO MemoryStore: Block broadcast_14 stored as values in memory (estimated size 352.9 KiB, free 364.4 MiB)
23/03/10 11:15:30 INFO MemoryStore: Block broadcast_14_piece0 stored as bytes in memory (estimated size 34.8 KiB, free 364.4 MiB)
23/03/10 11:15:30 INFO BlockManagerInfo: Added broadcast_14_piece0 in memory on 172.27.188.152:43967 (size: 34.8 KiB, free: 366.1 MiB)
23/03/10 11:15:30 INFO SparkContext: Created broadcast 14 from showString at NativeMethodAccessorImpl.java:0
23/03/10 11:15:30 INFO FileSourceScanExec: Planning scan with bin packing, max size: 4194304 bytes, open cost is considered as scanning 4194304 bytes.
23/03/10 11:15:30 INFO SparkContext: Starting job: showString at NativeMethodAccessorImpl.java:0
23/03/10 11:15:30 INFO DAGScheduler: Got job 9 (showString at NativeMethodAccessorImpl.java:0) with 1 output partitions
23/03/10 11:15:30 INFO DAGScheduler: Final stage: ResultStage 14 (showString at NativeMethodAccessorImpl.java:0)
23/03/10 11:15:30 INFO DAGScheduler: Parents of final stage: List()
23/03/10 11:15:30 INFO DAGScheduler: Missing parents: List()
23/03/10 11:15:30 INFO DAGScheduler: Submitting ResultStage 14 (MapPartitionsRDD[40] at showString at NativeMethodAccessorImpl.java:0), which has no missing parents
23/03/10 11:15:30 INFO MemoryStore: Block broadcast_15 stored as values in memory (estimated size 12.0 KiB, free 364.4 MiB)
23/03/10 11:15:30 INFO MemoryStore: Block broadcast_15_piece0 stored as bytes in memory (estimated size 6.0 KiB, free 364.4 MiB)
23/03/10 11:15:30 INFO BlockManagerInfo: Added broadcast_15_piece0 in memory on 172.27.188.152:43967 (size: 6.0 KiB, free: 366.0 MiB)
23/03/10 11:15:30 INFO SparkContext: Created broadcast 15 from broadcast at DAGScheduler.scala:1513
23/03/10 11:15:30 INFO DAGScheduler: Submitting 1 missing tasks from ResultStage 14 (MapPartitionsRDD[40] at showString at NativeMethodAccessorImpl.java:0) (first 15 tasks are for partitions Vector(0))
23/03/10 11:15:30 INFO TaskSchedulerImpl: Adding task set 14.0 with 1 tasks resource profile 0
23/03/10 11:15:30 INFO TaskSetManager: Starting task 0.0 in stage 14.0 (TID 11) (172.27.188.152, executor 0, partition 0, PROCESS_LOCAL, 5043 bytes) taskResourceAssignments Map()
23/03/10 11:15:30 INFO BlockManagerInfo: Added broadcast_15_piece0 in memory on 172.27.188.152:43031 (size: 6.0 KiB, free: 366.1 MiB)
23/03/10 11:15:30 INFO BlockManagerInfo: Added broadcast_14_piece0 in memory on 172.27.188.152:43031 (size: 34.8 KiB, free: 366.1 MiB)
23/03/10 11:15:30 INFO TaskSetManager: Finished task 0.0 in stage 14.0 (TID 11) in 295 ms on 172.27.188.152 (executor 0) (1/1)
23/03/10 11:15:30 INFO TaskSchedulerImpl: Removed TaskSet 14.0, whose tasks have all completed, from pool 
23/03/10 11:15:30 INFO DAGScheduler: ResultStage 14 (showString at NativeMethodAccessorImpl.java:0) finished in 0.317 s
23/03/10 11:15:30 INFO DAGScheduler: Job 9 is finished. Cancelling potential speculative or zombie tasks for this job
23/03/10 11:15:30 INFO TaskSchedulerImpl: Killing all running tasks in stage 14: Stage finished
23/03/10 11:15:30 INFO DAGScheduler: Job 9 finished: showString at NativeMethodAccessorImpl.java:0, took 0.329545 s
+-------+-----+
|age_cat|count|
+-------+-----+
|  Young| 2924|
+-------+-----+

None
23/03/10 11:15:30 INFO SparkContext: Invoking stop() from shutdown hook
23/03/10 11:15:30 INFO SparkUI: Stopped Spark web UI at http://172.27.188.152:4040
23/03/10 11:15:30 INFO StandaloneSchedulerBackend: Shutting down all executors
23/03/10 11:15:30 INFO CoarseGrainedSchedulerBackend$DriverEndpoint: Asking each executor to shut down
23/03/10 11:15:30 INFO MapOutputTrackerMasterEndpoint: MapOutputTrackerMasterEndpoint stopped!
23/03/10 11:15:30 INFO MemoryStore: MemoryStore cleared
23/03/10 11:15:30 INFO BlockManager: BlockManager stopped
23/03/10 11:15:30 INFO BlockManagerMaster: BlockManagerMaster stopped
23/03/10 11:15:31 INFO OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: OutputCommitCoordinator stopped!
23/03/10 11:15:31 INFO SparkContext: Successfully stopped SparkContext
23/03/10 11:15:31 INFO ShutdownHookManager: Shutdown hook called
23/03/10 11:15:31 INFO ShutdownHookManager: Deleting directory /tmp/spark-caeceac7-005c-452c-b4e2-ba3cd390cb43
23/03/10 11:15:31 INFO ShutdownHookManager: Deleting directory /tmp/spark-4a966d8c-45bf-44d1-b358-fc3c7c8b4658
23/03/10 11:15:31 INFO ShutdownHookManager: Deleting directory /tmp/spark-caeceac7-005c-452c-b4e2-ba3cd390cb43/pyspark-2a46412e-632b-4b80-8825-d0bf495a0be5
##### Finished Executor #####
============================================
============================================
